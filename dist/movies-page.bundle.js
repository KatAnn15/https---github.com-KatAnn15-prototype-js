/*! For license information please see movies-page.bundle.js.LICENSE.txt */
(()=>{var e={7238:(e,t,n)=>{"use strict";n.d(t,{Z:()=>d});var r=n(4444),i=n(909),s=n(4258),o=n(6934);class a{constructor(e,t){this._delegate=e,this.firebase=t,(0,s._addComponent)(e,new i.wA("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),(0,s.deleteApp)(this._delegate))))}_getService(e,t=s._DEFAULT_ENTRY_NAME){var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=s._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){(0,s._addComponent)(this._delegate,e)}_addOrOverwriteComponent(e){(0,s._addOrOverwriteComponent)(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const c={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."},u=new r.LL("app-compat","Firebase",c);const l=function e(){const t=function(e){const t={},n={__esModule:!0,initializeApp:function(i,o={}){const a=s.initializeApp(i,o);if((0,r.r3)(t,a.name))return t[a.name];const c=new e(a,n);return t[a.name]=c,c},app:i,registerVersion:s.registerVersion,setLogLevel:s.setLogLevel,onLog:s.onLog,apps:null,SDK_VERSION:s.SDK_VERSION,INTERNAL:{registerComponent:function(t){const o=t.name,a=o.replace("-compat","");if(s._registerComponent(t)&&"PUBLIC"===t.type){const s=(e=i())=>{if("function"!=typeof e[a])throw u.create("invalid-app-argument",{appName:o});return e[a]()};void 0!==t.serviceProps&&(0,r.ZB)(s,t.serviceProps),n[a]=s,e.prototype[a]=function(...e){return this._getService.bind(this,o).apply(this,t.multipleInstances?e:[])}}return"PUBLIC"===t.type?n[a]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:s}};function i(e){if(e=e||s._DEFAULT_ENTRY_NAME,!(0,r.r3)(t,e))throw u.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((e=>t[e]))}}),i.App=e,n}(a);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){(0,r.ZB)(t,e)},createSubscribe:r.ne,ErrorFactory:r.LL,deepExtend:r.ZB}),t}(),h=new o.Yd("@firebase/app-compat");if((0,r.jU)()&&void 0!==self.firebase){h.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");const e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&h.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}const d=l;var f;(0,s.registerVersion)("@firebase/app-compat","0.1.3",f)},4258:(e,t,n)=>{"use strict";n.r(t),n.d(t,{FirebaseError:()=>s.ZR,SDK_VERSION:()=>I,_DEFAULT_ENTRY_NAME:()=>u,_addComponent:()=>f,_addOrOverwriteComponent:()=>p,_apps:()=>h,_clearComponents:()=>v,_components:()=>d,_getProvider:()=>g,_registerComponent:()=>m,_removeServiceInstance:()=>y,deleteApp:()=>A,getApp:()=>T,getApps:()=>S,initializeApp:()=>E,onLog:()=>N,registerVersion:()=>k,setLogLevel:()=>R});var r=n(909),i=n(6934),s=n(4444);class o{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null==t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const a="@firebase/app",c=new i.Yd("@firebase/app"),u="[DEFAULT]",l={[a]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},h=new Map,d=new Map;function f(e,t){try{e.container.addComponent(t)}catch(n){c.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function p(e,t){e.container.addOrOverwriteComponent(t)}function m(e){const t=e.name;if(d.has(t))return c.debug(`There were multiple attempts to register component ${t}.`),!1;d.set(t,e);for(const t of h.values())f(t,e);return!0}function g(e,t){return e.container.getProvider(t)}function y(e,t,n=u){g(e,t).clearInstance(n)}function v(){d.clear()}const w={"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function."},_=new s.LL("app","Firebase",w);class b{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _.create("app-deleted",{appName:this._name})}}const I="9.1.1";function E(e,t={}){if("object"!=typeof t){t={name:t}}const n=Object.assign({name:u,automaticDataCollectionEnabled:!1},t),i=n.name;if("string"!=typeof i||!i)throw _.create("bad-app-name",{appName:String(i)});const o=h.get(i);if(o){if((0,s.vZ)(e,o.options)&&(0,s.vZ)(n,o.config))return o;throw _.create("duplicate-app",{appName:i})}const a=new r.H0(i);for(const e of d.values())a.addComponent(e);const c=new b(e,n,a);return h.set(i,c),c}function T(e=u){const t=h.get(e);if(!t)throw _.create("no-app",{appName:e});return t}function S(){return Array.from(h.values())}async function A(e){const t=e.name;h.has(t)&&(h.delete(t),await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function k(e,t,n){var i;let s=null!==(i=l[e])&&void 0!==i?i:e;n&&(s+=`-${n}`);const o=s.match(/\s|\//),a=t.match(/\s|\//);if(o||a){const e=[`Unable to register library "${s}" with version "${t}":`];return o&&e.push(`library name "${s}" contains illegal characters (whitespace or "/")`),o&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void c.warn(e.join(" "))}m(new r.wA(`${s}-version`,(()=>({library:s,version:t})),"VERSION"))}function N(e,t){if(null!==e&&"function"!=typeof e)throw _.create("invalid-log-argument");(0,i.Am)(e,t)}function R(e){(0,i.Ub)(e)}var C;m(new r.wA("platform-logger",(e=>new o(e)),"PRIVATE")),k(a,"0.7.2",C),k("fire-js","")},4128:(e,t,n)=>{"use strict";n.d(t,{$:()=>ft,A:()=>d,B:()=>m,C:()=>y,D:()=>C,E:()=>Te,F:()=>c,G:()=>ke,H:()=>Oe,I:()=>Pe,J:()=>Le,K:()=>oe,L:()=>Fe,M:()=>qe,N:()=>ze,O:()=>h,P:()=>Mn,Q:()=>Ge,R:()=>Rn,S:()=>l,T:()=>je,U:()=>$e,V:()=>Ke,W:()=>Je,X:()=>ot,Y:()=>at,Z:()=>ct,_:()=>ut,a:()=>tn,a0:()=>pt,a1:()=>mt,a2:()=>gt,a3:()=>yt,a4:()=>vt,a5:()=>wt,a6:()=>_t,a7:()=>bt,a8:()=>It,a9:()=>Et,aA:()=>ir,aB:()=>Jn,aC:()=>Ie,aG:()=>rn,aJ:()=>He,aa:()=>Tt,ab:()=>St,ac:()=>Me,ad:()=>Ue,ae:()=>At,af:()=>kt,ag:()=>Nt,ah:()=>K,ai:()=>W,aj:()=>tt,ak:()=>Mt,al:()=>te,am:()=>$t,an:()=>Yt,ao:()=>ve,ap:()=>k,aq:()=>ye,ar:()=>pe,as:()=>_,at:()=>Ar,au:()=>ur,av:()=>b,aw:()=>S,ax:()=>R,ay:()=>ae,az:()=>or,b:()=>Zt,c:()=>Gn,d:()=>$n,e:()=>Hn,f:()=>er,g:()=>nr,h:()=>tr,i:()=>yn,j:()=>rr,k:()=>Nr,l:()=>Dn,m:()=>Cr,n:()=>Pr,o:()=>u,p:()=>Ut,q:()=>Ft,r:()=>Pn,s:()=>On,t:()=>Vt,u:()=>Ln,v:()=>Bt,w:()=>jt,x:()=>qt,y:()=>zt,z:()=>p});var r=n(4444),i=n(4258),s=n(655),o=n(6934),a=n(909);const c={PHONE:"phone"},u={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},l={EMAIL_LINK:"emailLink",EMAIL_PASSWORD:"password",FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PHONE:"phone",TWITTER:"twitter.com"},h={LINK:"link",REAUTHENTICATE:"reauthenticate",SIGN_IN:"signIn"},d={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function f(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const p=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance."}},m=f,g=new r.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),y={ADMIN_ONLY_OPERATION:"auth/admin-restricted-operation",ARGUMENT_ERROR:"auth/argument-error",APP_NOT_AUTHORIZED:"auth/app-not-authorized",APP_NOT_INSTALLED:"auth/app-not-installed",CAPTCHA_CHECK_FAILED:"auth/captcha-check-failed",CODE_EXPIRED:"auth/code-expired",CORDOVA_NOT_READY:"auth/cordova-not-ready",CORS_UNSUPPORTED:"auth/cors-unsupported",CREDENTIAL_ALREADY_IN_USE:"auth/credential-already-in-use",CREDENTIAL_MISMATCH:"auth/custom-token-mismatch",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"auth/requires-recent-login",DEPENDENT_SDK_INIT_BEFORE_AUTH:"auth/dependent-sdk-initialized-before-auth",DYNAMIC_LINK_NOT_ACTIVATED:"auth/dynamic-link-not-activated",EMAIL_CHANGE_NEEDS_VERIFICATION:"auth/email-change-needs-verification",EMAIL_EXISTS:"auth/email-already-in-use",EMULATOR_CONFIG_FAILED:"auth/emulator-config-failed",EXPIRED_OOB_CODE:"auth/expired-action-code",EXPIRED_POPUP_REQUEST:"auth/cancelled-popup-request",INTERNAL_ERROR:"auth/internal-error",INVALID_API_KEY:"auth/invalid-api-key",INVALID_APP_CREDENTIAL:"auth/invalid-app-credential",INVALID_APP_ID:"auth/invalid-app-id",INVALID_AUTH:"auth/invalid-user-token",INVALID_AUTH_EVENT:"auth/invalid-auth-event",INVALID_CERT_HASH:"auth/invalid-cert-hash",INVALID_CODE:"auth/invalid-verification-code",INVALID_CONTINUE_URI:"auth/invalid-continue-uri",INVALID_CORDOVA_CONFIGURATION:"auth/invalid-cordova-configuration",INVALID_CUSTOM_TOKEN:"auth/invalid-custom-token",INVALID_DYNAMIC_LINK_DOMAIN:"auth/invalid-dynamic-link-domain",INVALID_EMAIL:"auth/invalid-email",INVALID_EMULATOR_SCHEME:"auth/invalid-emulator-scheme",INVALID_IDP_RESPONSE:"auth/invalid-credential",INVALID_MESSAGE_PAYLOAD:"auth/invalid-message-payload",INVALID_MFA_SESSION:"auth/invalid-multi-factor-session",INVALID_OAUTH_CLIENT_ID:"auth/invalid-oauth-client-id",INVALID_OAUTH_PROVIDER:"auth/invalid-oauth-provider",INVALID_OOB_CODE:"auth/invalid-action-code",INVALID_ORIGIN:"auth/unauthorized-domain",INVALID_PASSWORD:"auth/wrong-password",INVALID_PERSISTENCE:"auth/invalid-persistence-type",INVALID_PHONE_NUMBER:"auth/invalid-phone-number",INVALID_PROVIDER_ID:"auth/invalid-provider-id",INVALID_RECIPIENT_EMAIL:"auth/invalid-recipient-email",INVALID_SENDER:"auth/invalid-sender",INVALID_SESSION_INFO:"auth/invalid-verification-id",INVALID_TENANT_ID:"auth/invalid-tenant-id",MFA_INFO_NOT_FOUND:"auth/multi-factor-info-not-found",MFA_REQUIRED:"auth/multi-factor-auth-required",MISSING_ANDROID_PACKAGE_NAME:"auth/missing-android-pkg-name",MISSING_APP_CREDENTIAL:"auth/missing-app-credential",MISSING_AUTH_DOMAIN:"auth/auth-domain-config-required",MISSING_CODE:"auth/missing-verification-code",MISSING_CONTINUE_URI:"auth/missing-continue-uri",MISSING_IFRAME_START:"auth/missing-iframe-start",MISSING_IOS_BUNDLE_ID:"auth/missing-ios-bundle-id",MISSING_OR_INVALID_NONCE:"auth/missing-or-invalid-nonce",MISSING_MFA_INFO:"auth/missing-multi-factor-info",MISSING_MFA_SESSION:"auth/missing-multi-factor-session",MISSING_PHONE_NUMBER:"auth/missing-phone-number",MISSING_SESSION_INFO:"auth/missing-verification-id",MODULE_DESTROYED:"auth/app-deleted",NEED_CONFIRMATION:"auth/account-exists-with-different-credential",NETWORK_REQUEST_FAILED:"auth/network-request-failed",NULL_USER:"auth/null-user",NO_AUTH_EVENT:"auth/no-auth-event",NO_SUCH_PROVIDER:"auth/no-such-provider",OPERATION_NOT_ALLOWED:"auth/operation-not-allowed",OPERATION_NOT_SUPPORTED:"auth/operation-not-supported-in-this-environment",POPUP_BLOCKED:"auth/popup-blocked",POPUP_CLOSED_BY_USER:"auth/popup-closed-by-user",PROVIDER_ALREADY_LINKED:"auth/provider-already-linked",QUOTA_EXCEEDED:"auth/quota-exceeded",REDIRECT_CANCELLED_BY_USER:"auth/redirect-cancelled-by-user",REDIRECT_OPERATION_PENDING:"auth/redirect-operation-pending",REJECTED_CREDENTIAL:"auth/rejected-credential",SECOND_FACTOR_ALREADY_ENROLLED:"auth/second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"auth/maximum-second-factor-count-exceeded",TENANT_ID_MISMATCH:"auth/tenant-id-mismatch",TIMEOUT:"auth/timeout",TOKEN_EXPIRED:"auth/user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"auth/too-many-requests",UNAUTHORIZED_DOMAIN:"auth/unauthorized-continue-uri",UNSUPPORTED_FIRST_FACTOR:"auth/unsupported-first-factor",UNSUPPORTED_PERSISTENCE:"auth/unsupported-persistence-type",UNSUPPORTED_TENANT_OPERATION:"auth/unsupported-tenant-operation",UNVERIFIED_EMAIL:"auth/unverified-email",USER_CANCELLED:"auth/user-cancelled",USER_DELETED:"auth/user-not-found",USER_DISABLED:"auth/user-disabled",USER_MISMATCH:"auth/user-mismatch",USER_SIGNED_OUT:"auth/user-signed-out",WEAK_PASSWORD:"auth/weak-password",WEB_STORAGE_UNSUPPORTED:"auth/web-storage-unsupported",ALREADY_INITIALIZED:"auth/already-initialized"},v=new o.Yd("@firebase/auth");function w(e,...t){v.logLevel<=o.in.ERROR&&v.error(`Auth (${i.SDK_VERSION}): ${e}`,...t)}function _(e,...t){throw T(e,...t)}function b(e,...t){return T(e,...t)}function I(e,t,n){const i=Object.assign(Object.assign({},m()),{[t]:n});return new r.LL("auth","Firebase",i).create(t,{appName:e.name})}function E(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&_(e,"argument-error"),I(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function T(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return g.create(e,...t)}function S(e,t,...n){if(!e)throw T(t,...n)}function A(e){const t="INTERNAL ASSERTION FAILED: "+e;throw w(t),new Error(t)}function k(e,t){e||A(t)}const N=new Map;function R(e){k(e instanceof Function,"Expected a class definition");let t=N.get(e);return t?(k(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,N.set(e,t),t)}function C(e,t){const n=(0,i._getProvider)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),i=n.getOptions();if((0,r.vZ)(i,null!=t?t:{}))return e;_(e,"already-initialized")}return n.initialize({options:t})}function O(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function D(){return"http:"===P()||"https:"===P()}function P(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class x{constructor(e,t){this.shortDelay=e,this.longDelay=t,k(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,r.uI)()||(0,r.b$)()}get(){return"undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(D()||(0,r.ru)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function L(e,t){k(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class M{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void A("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void A("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void A("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const U={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error"},F=new x(3e4,6e4);function V(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function B(e,t,n,i,s={}){return j(e,s,(()=>{let s={},o={};i&&("GET"===t?o=i:s={body:JSON.stringify(i)});const a=(0,r.xO)(Object.assign({key:e.config.apiKey},o)).slice(1),c=new(M.headers());return c.set("Content-Type","application/json"),c.set("X-Client-Version",e._getSdkClientVersion()),e.languageCode&&c.set("X-Firebase-Locale",e.languageCode),M.fetch()(z(e,e.config.apiHost,n,a),Object.assign({method:t,headers:c,referrerPolicy:"no-referrer"},s))}))}async function j(e,t,n){e._canInitEmulator=!1;const i=Object.assign(Object.assign({},U),t);try{const t=new G(e),r=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await r.json();if("needConfirmation"in s)throw H(e,"account-exists-with-different-credential",s);if(r.ok&&!("errorMessage"in s))return s;{const t=r.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw H(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw H(e,"email-already-in-use",s);const a=i[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw I(e,a,o);_(e,a)}}catch(t){if(t instanceof r.ZR)throw t;_(e,"network-request-failed")}}async function q(e,t,n,r,i={}){const s=await B(e,t,n,r,i);return"mfaPendingCredential"in s&&_(e,"multi-factor-auth-required",{serverResponse:s}),s}function z(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?L(e.config,i):`${e.config.apiScheme}://${i}`}class G{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(b(this.auth,"timeout"))),F.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function H(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=b(e,t,r);return i.customData._tokenResponse=n,i}function $(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}function K(e,t=!1){return(0,r.m9)(e).getIdToken(t)}async function W(e,t=!1){const n=(0,r.m9)(e),i=await n.getIdToken(t),s=Q(i);S(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:i,authTime:$(Y(s.auth_time)),issuedAtTime:$(Y(s.iat)),expirationTime:$(Y(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}function Y(e){return 1e3*Number(e)}function Q(e){const[t,n,i]=e.split(".");if(void 0===t||void 0===n||void 0===i)return w("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,r.tV)(n);return e?JSON.parse(e):(w("Failed to decode base64 JWT payload"),null)}catch(e){return w("Caught error parsing JWT payload as JSON",e),null}}async function J(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof r.ZR&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}class X{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e.code&&this.schedule(!0))}this.schedule()}}class Z{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=$(this.lastLoginAt),this.creationTime=$(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ee(e){var t;const n=e.auth,r=await e.getIdToken(),i=await J(e,async function(e,t){return B(e,"POST","/v1/accounts:lookup",t)}(n,{idToken:r}));S(null==i?void 0:i.users.length,n,"internal-error");const o=i.users[0];e._notifyReloadListener(o);const a=(null===(t=o.providerUserInfo)||void 0===t?void 0:t.length)?o.providerUserInfo.map((e=>{var{providerId:t}=e,n=(0,s._T)(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})):[];const c=(u=e.providerData,l=a,[...u.filter((e=>!l.some((t=>t.providerId===e.providerId)))),...l]);var u,l;const h=e.isAnonymous,d=!(e.email&&o.passwordHash||(null==c?void 0:c.length)),f=!!h&&d,p={uid:o.localId,displayName:o.displayName||null,photoURL:o.photoUrl||null,email:o.email||null,emailVerified:o.emailVerified||!1,phoneNumber:o.phoneNumber||null,tenantId:o.tenantId||null,providerData:c,metadata:new Z(o.createdAt,o.lastLoginAt),isAnonymous:f};Object.assign(e,p)}async function te(e){const t=(0,r.m9)(e);await ee(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}class ne{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){S(e.idToken,"internal-error"),S(void 0!==e.idToken,"internal-error"),S(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){const t=Q(e);return S(t,"internal-error"),S(void 0!==t.exp,"internal-error"),S(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return S(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await async function(e,t){const n=await j(e,{},(()=>{const n=(0,r.xO)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:i,apiKey:s}=e.config,o=z(e,i,"/v1/token",`key=${s}`);return M.fetch()(o,{method:"POST",headers:{"X-Client-Version":e._getSdkClientVersion(),"Content-Type":"application/x-www-form-urlencoded"},body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new ne;return n&&(S("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(S("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(S("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ne,this.toJSON())}_performRefresh(){return A("not implemented")}}function re(e,t){S("string"==typeof e||void 0===e,"internal-error",{appName:t})}class ie{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=(0,s._T)(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new X(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.metadata=new Z(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await J(this,this.stsTokenManager.getToken(this.auth,e));return S(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return W(this,e)}reload(){return te(this)}_assign(e){this!==e&&(S(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){return new ie(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(e){S(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await ee(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){const e=await this.getIdToken();return await J(this,async function(e,t){return B(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,c,u;const l=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(c=t.createdAt)&&void 0!==c?c:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:w,isAnonymous:_,providerData:b,stsTokenManager:I}=t;S(v&&I,e,"internal-error");const E=ne.fromJSON(this.name,I);S("string"==typeof v,e,"internal-error"),re(l,e.name),re(h,e.name),S("boolean"==typeof w,e,"internal-error"),S("boolean"==typeof _,e,"internal-error"),re(d,e.name),re(f,e.name),re(p,e.name),re(m,e.name),re(g,e.name),re(y,e.name);const T=new ie({uid:v,auth:e,email:h,emailVerified:w,displayName:l,isAnonymous:_,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:g,lastLoginAt:y});return b&&Array.isArray(b)&&(T.providerData=b.map((e=>Object.assign({},e)))),m&&(T._redirectEventId=m),T}static async _fromIdTokenResponse(e,t,n=!1){const r=new ne;r.updateFromServerResponse(t);const i=new ie({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await ee(i),i}}class se{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}se.type="NONE";const oe=se;function ae(e,t,n){return`firebase:${e}:${t}:${n}`}class ce{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=ae(this.userKey,r.apiKey,i),this.fullPersistenceKey=ae("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?ie._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new ce(R(oe),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||R(oe);const s=ae(n,e.config.apiKey,e.name);let o=null;for(const n of t)try{const t=await n._get(s);if(t){const r=ie._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new ce(i,e,n)):new ce(i,e,n)}}function ue(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(fe(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(le(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(me(t))return"Blackberry";if(ge(t))return"Webos";if(he(t))return"Safari";if((t.includes("chrome/")||de(t))&&!t.includes("edge/"))return"Chrome";if(pe(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null==n?void 0:n.length))return n[1]}return"Other"}function le(e=(0,r.z$)()){return/firefox\//i.test(e)}function he(e=(0,r.z$)()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function de(e=(0,r.z$)()){return/crios\//i.test(e)}function fe(e=(0,r.z$)()){return/iemobile/i.test(e)}function pe(e=(0,r.z$)()){return/android/i.test(e)}function me(e=(0,r.z$)()){return/blackberry/i.test(e)}function ge(e=(0,r.z$)()){return/webos/i.test(e)}function ye(e=(0,r.z$)()){return/iphone|ipad|ipod/i.test(e)}function ve(e=(0,r.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}function we(e=(0,r.z$)()){return ye(e)||pe(e)||ge(e)||me(e)||/windows phone/i.test(e)||fe(e)}function _e(e,t=[]){let n;switch(e){case"Browser":n=ue((0,r.z$)());break;case"Worker":n=`${ue((0,r.z$)())}-${e}`;break;default:n=e}const s=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${i.SDK_VERSION}/${s}`}class be{constructor(e,t){this.app=e,this.config=t,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ee(this),this.idTokenSubscription=new Ee(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=g,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=t.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=R(t)),this._initializationPromise=this.queue((async()=>{var n;this._deleted||(this.persistenceManager=await ce.create(this,e),this._deleted||((null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)&&await this._popupRedirectResolver._initialize(this),await this.initializeCurrentUser(t),this._deleted||(this._isInitialized=!0)))})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e):void 0}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser();if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const r=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,i=null==n?void 0:n._redirectEventId,s=await this.tryRedirectSignIn(e);r&&r!==i||!(null==s?void 0:s.user)||(n=s.user)}return n?n._redirectEventId?(S(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)):this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await ee(e)}catch(e){if("auth/network-request-failed"!==e.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){const t=e?(0,r.m9)(e):null;return t&&S(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){if(!this._deleted)return e&&S(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(e){return this.queue((async()=>{await this.assertedPersistence.setPersistence(R(e))}))}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new r.LL("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&R(e)||this._popupRedirectResolver;S(t,this,"argument-error"),this.redirectPersistenceManager=await ce.create(this,[R(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return S(s,this,"internal-error"),s.then((()=>i(this.currentUser))),"function"==typeof t?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&(this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh()),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return S(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_e(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getSdkClientVersion(){return this.clientVersion}}function Ie(e){return(0,r.m9)(e)}class Ee{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,r.ne)((e=>this.observer=e))}get next(){return S(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function Te(e,t,n){const r=Ie(e);S(r._canInitEmulator,r,"emulator-config-failed"),S(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null==n?void 0:n.disableWarnings),s=Se(t),{host:o,port:a}=function(e){const t=Se(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Ae(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Ae(t)}}}(t),c=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${c}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),function(e){function t(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"==typeof window||"undefined"==typeof document||e||("loading"===document.readyState?window.addEventListener("DOMContentLoaded",t):t())}(i)}function Se(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Ae(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class ke{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return A("not implemented")}_getIdTokenResponse(e){return A("not implemented")}_linkToIdToken(e,t){return A("not implemented")}_getReauthenticationResolver(e){return A("not implemented")}}async function Ne(e,t){return B(e,"POST","/v1/accounts:resetPassword",V(e,t))}async function Re(e,t){return B(e,"POST","/v1/accounts:update",t)}async function Ce(e,t){return B(e,"POST","/v1/accounts:sendOobCode",V(e,t))}class Oe extends ke{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Oe(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Oe(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return async function(e,t){return q(e,"POST","/v1/accounts:signInWithPassword",V(e,t))}(e,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return q(e,"POST","/v1/accounts:signInWithEmailLink",V(e,t))}(e,{email:this._email,oobCode:this._password});default:_(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Re(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return async function(e,t){return q(e,"POST","/v1/accounts:signInWithEmailLink",V(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:_(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function De(e,t){return q(e,"POST","/v1/accounts:signInWithIdp",V(e,t))}class Pe extends ke{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Pe(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):_("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=(0,s._T)(t,["providerId","signInMethod"]);if(!n||!r)return null;const o=new Pe(n,r);return Object.assign(o,i),o}_getIdTokenResponse(e){return De(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,De(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,De(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,r.xO)(t)}return e}}const xe={USER_NOT_FOUND:"user-not-found"};class Le extends ke{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Le({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Le({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return q(e,"POST","/v1/accounts:signInWithPhoneNumber",V(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await q(e,"POST","/v1/accounts:signInWithPhoneNumber",V(e,t));if(n.temporaryProof)throw H(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return q(e,"POST","/v1/accounts:signInWithPhoneNumber",V(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),xe)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Le({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Me{constructor(e){var t,n,i,s,o,a;const c=(0,r.zd)((0,r.pd)(e)),u=null!==(t=c.apiKey)&&void 0!==t?t:null,l=null!==(n=c.oobCode)&&void 0!==n?n:null,h=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(i=c.mode)&&void 0!==i?i:null);S(u&&l&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=l,this.continueUrl=null!==(s=c.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=c.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=c.tenantId)&&void 0!==a?a:null}static parseLink(e){const t=function(e){const t=(0,r.zd)((0,r.pd)(e)).link,n=t?(0,r.zd)((0,r.pd)(t)).deep_link_id:null,i=(0,r.zd)((0,r.pd)(e)).deep_link_id;return(i?(0,r.zd)((0,r.pd)(i)).link:null)||i||n||t||e}(e);try{return new Me(t)}catch(e){return null}}}function Ue(e){return Me.parseLink(e)}class Fe{constructor(){this.providerId=Fe.PROVIDER_ID}static credential(e,t){return Oe._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Me.parseLink(t);return S(n,"argument-error"),Oe._fromEmailAndCode(e,n.code,n.tenantId)}}Fe.PROVIDER_ID="password",Fe.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Fe.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ve{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Be extends Ve{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class je extends Be{static credentialFromJSON(e){const t="string"==typeof e?JSON.parse(e):e;return S("providerId"in t&&"signInMethod"in t,"argument-error"),Pe._fromParams(t)}credential(e){return this._credential(e)}_credential(e){return S(e.idToken||e.accessToken,"argument-error"),Pe._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return je.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return je.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:o}=e;if(!(n||r||t||i))return null;if(!o)return null;try{return new je(o)._credential({idToken:t,accessToken:n,rawNonce:s,pendingToken:i})}catch(e){return null}}}class qe extends Be{constructor(){super("facebook.com")}static credential(e){return Pe._fromParams({providerId:qe.PROVIDER_ID,signInMethod:qe.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return qe.credentialFromTaggedObject(e)}static credentialFromError(e){return qe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return qe.credential(e.oauthAccessToken)}catch(e){return null}}}qe.FACEBOOK_SIGN_IN_METHOD="facebook.com",qe.PROVIDER_ID="facebook.com";class ze extends Be{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Pe._fromParams({providerId:ze.PROVIDER_ID,signInMethod:ze.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ze.credentialFromTaggedObject(e)}static credentialFromError(e){return ze.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return ze.credential(t,n)}catch(e){return null}}}ze.GOOGLE_SIGN_IN_METHOD="google.com",ze.PROVIDER_ID="google.com";class Ge extends Be{constructor(){super("github.com")}static credential(e){return Pe._fromParams({providerId:Ge.PROVIDER_ID,signInMethod:Ge.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ge.credentialFromTaggedObject(e)}static credentialFromError(e){return Ge.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Ge.credential(e.oauthAccessToken)}catch(e){return null}}}Ge.GITHUB_SIGN_IN_METHOD="github.com",Ge.PROVIDER_ID="github.com";class He extends ke{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return De(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,De(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,De(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new He(n,i):null}static _create(e,t){return new He(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class $e extends Ve{constructor(e){S(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return $e.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return $e.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=He.fromJSON(e);return S(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return He._create(n,t)}catch(e){return null}}}class Ke extends Be{constructor(){super("twitter.com")}static credential(e,t){return Pe._fromParams({providerId:Ke.PROVIDER_ID,signInMethod:Ke.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ke.credentialFromTaggedObject(e)}static credentialFromError(e){return Ke.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ke.credential(t,n)}catch(e){return null}}}async function We(e,t){return q(e,"POST","/v1/accounts:signUp",V(e,t))}Ke.TWITTER_SIGN_IN_METHOD="twitter.com",Ke.PROVIDER_ID="twitter.com";class Ye{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await ie._fromIdTokenResponse(e,n,r),s=Qe(n);return new Ye({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=Qe(n);return new Ye({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function Qe(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}async function Je(e){var t;const n=Ie(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new Ye({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await We(n,{returnSecureToken:!0}),i=await Ye._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}class Xe extends r.ZR{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,this.name="FirebaseError",Object.setPrototypeOf(this,Xe.prototype),this.appName=e.name,this.code=t.code,this.tenantId=null!==(i=e.tenantId)&&void 0!==i?i:void 0,this.serverResponse=t.customData.serverResponse}static _fromErrorAndOperation(e,t,n,r){return new Xe(e,t,n,r)}}function Ze(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw Xe._fromErrorAndOperation(e,n,t,r);throw n}))}function et(e){return new Set(e.map((({providerId:e})=>e)).filter((e=>!!e)))}async function tt(e,t){const n=(0,r.m9)(e);await rt(!0,n,t);const{providerUserInfo:i}=await async function(e,t){return B(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),s=et(i||[]);return n.providerData=n.providerData.filter((e=>s.has(e.providerId))),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function nt(e,t,n=!1){const r=await J(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ye._forOperation(e,"link",r)}async function rt(e,t,n){await ee(t);const r=!1===e?"provider-already-linked":"no-such-provider";S(et(t.providerData).has(n)===e,t.auth,r)}async function it(e,t,n=!1){const{auth:r}=e,i="reauthenticate";try{const s=await J(e,Ze(r,i,t,e),n);S(s.idToken,r,"internal-error");const o=Q(s.idToken);S(o,r,"internal-error");const{sub:a}=o;return S(e.uid===a,r,"user-mismatch"),Ye._forOperation(e,i,s)}catch(e){throw"auth/user-not-found"===(null==e?void 0:e.code)&&_(r,"user-mismatch"),e}}async function st(e,t,n=!1){const r="signIn",i=await Ze(e,r,t),s=await Ye._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function ot(e,t){return st(Ie(e),t)}async function at(e,t){const n=(0,r.m9)(e);return await rt(!1,n,t.providerId),nt(n,t)}async function ct(e,t){return it((0,r.m9)(e),t)}async function ut(e,t){const n=Ie(e),r=await async function(e,t){return q(e,"POST","/v1/accounts:signInWithCustomToken",V(e,t))}(n,{token:t,returnSecureToken:!0}),i=await Ye._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}class lt{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?ht._fromServerResponse(e,t):_(e,"internal-error")}}class ht extends lt{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new ht(t)}}function dt(e,t,n){var r;S((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),S(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(S(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(S(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function ft(e,t,n){const i=(0,r.m9)(e),s={requestType:"PASSWORD_RESET",email:t};n&&dt(i,s,n),await async function(e,t){return Ce(e,t)}(i,s)}async function pt(e,t,n){await Ne((0,r.m9)(e),{oobCode:t,newPassword:n})}async function mt(e,t){await async function(e,t){return B(e,"POST","/v1/accounts:update",V(e,t))}((0,r.m9)(e),{oobCode:t})}async function gt(e,t){const n=(0,r.m9)(e),i=await Ne(n,{oobCode:t}),s=i.requestType;switch(S(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":S(i.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":S(i.mfaInfo,n,"internal-error");default:S(i.email,n,"internal-error")}let o=null;return i.mfaInfo&&(o=lt._fromServerResponse(Ie(n),i.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.newEmail:i.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===i.requestType?i.email:i.newEmail)||null,multiFactorInfo:o},operation:s}}async function yt(e,t){const{data:n}=await gt((0,r.m9)(e),t);return n.email}async function vt(e,t,n){const r=Ie(e),i=await We(r,{returnSecureToken:!0,email:t,password:n}),s=await Ye._fromIdTokenResponse(r,"signIn",i);return await r._updateCurrentUser(s.user),s}function wt(e,t,n){return ot((0,r.m9)(e),Fe.credential(t,n))}async function _t(e,t,n){const i=(0,r.m9)(e),s={requestType:"EMAIL_SIGNIN",email:t};S(n.handleCodeInApp,i,"argument-error"),n&&dt(i,s,n),await async function(e,t){return Ce(e,t)}(i,s)}function bt(e,t){const n=Me.parseLink(t);return"EMAIL_SIGNIN"===(null==n?void 0:n.operation)}async function It(e,t,n){const i=(0,r.m9)(e),s=Fe.credentialWithLink(t,n||O());return S(s._tenantId===(i.tenantId||null),i,"tenant-id-mismatch"),ot(i,s)}async function Et(e,t){const n={identifier:t,continueUri:D()?O():"http://localhost"},{signinMethods:i}=await async function(e,t){return B(e,"POST","/v1/accounts:createAuthUri",V(e,t))}((0,r.m9)(e),n);return i||[]}async function Tt(e,t){const n=(0,r.m9)(e),i={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&dt(n.auth,i,t);const{email:s}=await async function(e,t){return Ce(e,t)}(n.auth,i);s!==e.email&&await e.reload()}async function St(e,t,n){const i=(0,r.m9)(e),s={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&dt(i.auth,s,n);const{email:o}=await async function(e,t){return Ce(e,t)}(i.auth,s);o!==e.email&&await e.reload()}async function At(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;const i=(0,r.m9)(e),s={idToken:await i.getIdToken(),displayName:t,photoUrl:n,returnSecureToken:!0},o=await J(i,async function(e,t){return B(e,"POST","/v1/accounts:update",t)}(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find((({providerId:e})=>"password"===e));a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}function kt(e,t){return Rt((0,r.m9)(e),t,null)}function Nt(e,t){return Rt((0,r.m9)(e),null,t)}async function Rt(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await J(e,Re(r,i));await e._updateTokensIfNecessary(s,!0)}class Ct{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class Ot extends Ct{constructor(e,t,n,r){super(e,t,n),this.username=r}}class Dt extends Ct{constructor(e,t){super(e,"facebook.com",t)}}class Pt extends Ot{constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class xt extends Ct{constructor(e,t){super(e,"google.com",t)}}class Lt extends Ot{constructor(e,t,n){super(e,"twitter.com",t,n)}}function Mt(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){const r=null===(n=null===(t=Q(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new Ct(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new Dt(s,i);case"github.com":return new Pt(s,i);case"google.com":return new xt(s,i);case"twitter.com":return new Lt(s,i,e.screenName||null);case"custom":case"anonymous":return new Ct(s,null);default:return new Ct(s,r,i)}}(n)}function Ut(e,t){return(0,r.m9)(e).setPersistence(t)}function Ft(e,t,n,i){return(0,r.m9)(e).onIdTokenChanged(t,n,i)}function Vt(e,t,n,i){return(0,r.m9)(e).onAuthStateChanged(t,n,i)}function Bt(e){(0,r.m9)(e).useDeviceLanguage()}function jt(e,t){return(0,r.m9)(e).updateCurrentUser(t)}function qt(e){return(0,r.m9)(e).signOut()}async function zt(e){return(0,r.m9)(e).delete()}class Gt{constructor(e,t){this.type=e,this.credential=t}static _fromIdtoken(e){return new Gt("enroll",e)}static _fromMfaPendingCredential(e){return new Gt("signin",e)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return Gt._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return Gt._fromIdtoken(e.multiFactorSession.idToken)}return null}}class Ht{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=Ie(e),r=(t.serverResponse.mfaInfo||[]).map((e=>lt._fromServerResponse(n,e)));S(t.serverResponse.mfaPendingCredential,n,"internal-error");const i=Gt._fromMfaPendingCredential(t.serverResponse.mfaPendingCredential);return new Ht(i,r,(async e=>{const r=await e._process(n,i);delete t.serverResponse.mfaInfo,delete t.serverResponse.mfaPendingCredential;const s=Object.assign(Object.assign({},t.serverResponse),{idToken:r.idToken,refreshToken:r.refreshToken});switch(t.operationType){case"signIn":const e=await Ye._fromIdTokenResponse(n,t.operationType,s);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return S(t.user,n,"internal-error"),Ye._forOperation(t.user,t.operationType,s);default:_(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}function $t(e,t){var n;const i=(0,r.m9)(e),s=t;return S(t.operationType,i,"argument-error"),S(null===(n=s.serverResponse)||void 0===n?void 0:n.mfaPendingCredential,i,"argument-error"),Ht._fromError(i,s)}class Kt{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>lt._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new Kt(e)}async getSession(){return Gt._fromIdtoken(await this.user.getIdToken())}async enroll(e,t){const n=e,r=await this.getSession(),i=await J(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"==typeof e?e:e.uid,n=await this.user.getIdToken(),r=await J(this.user,(i=this.user.auth,s={idToken:n,mfaEnrollmentId:t},B(i,"POST","/v2/accounts/mfaEnrollment:withdraw",V(i,s))));var i,s;this.enrolledFactors=this.enrolledFactors.filter((({uid:e})=>e!==t)),await this.user._updateTokensIfNecessary(r);try{await this.user.reload()}catch(e){if("auth/user-token-expired"!==e.code)throw e}}}const Wt=new WeakMap;function Yt(e){const t=(0,r.m9)(e);return Wt.has(t)||Wt.set(t,Kt._fromUser(t)),Wt.get(t)}const Qt="__sak";class Jt{constructor(e,t){this.storage=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Qt,"1"),this.storage.removeItem(Qt),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}}class Xt extends Jt{constructor(){super(window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=function(){const e=(0,r.z$)();return he(e)||ye(e)}()&&function(){try{return!(!window||window===window.top)}catch(e){return!1}}(),this.fallbackToPolling=we(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}const i=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);(0,r.w1)()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,10):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Xt.type="LOCAL";const Zt=Xt;class en extends Jt{constructor(){super(window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}en.type="SESSION";const tn=en;class nn{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new nn(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null==s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(e){return{fulfilled:!1,reason:e}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function rn(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}nn.receivers=[];class sn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=rn("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function on(){return window}function an(){return void 0!==on().WorkerGlobalScope&&"function"==typeof on().importScripts}const cn="firebaseLocalStorageDb",un="firebaseLocalStorage",ln="fbase_key";class hn{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function dn(e,t){return e.transaction([un],t?"readwrite":"readonly").objectStore(un)}function fn(){const e=indexedDB.open(cn,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(un,{keyPath:ln})}catch(e){n(e)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(un)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(cn);return new hn(e).toPromise()}(),t(await fn()))}))}))}async function pn(e,t,n){const r=dn(e,!0).put({[ln]:t,value:n});return new hn(r).toPromise()}function mn(e,t){const n=dn(e,!0).delete(t);return new hn(n).toPromise()}class gn{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await fn()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return an()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nn._getInstance(an()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new sn(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fn();return await pn(e,Qt,"1"),await mn(e,Qt),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>pn(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=dn(e,!1).get(t),r=await new hn(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>mn(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=dn(e,!1).getAll();return new hn(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}gn.type="LOCAL";const yn=gn;function vn(e){return new Promise(((t,n)=>{const r=document.createElement("script");var i,s;r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=b("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(null!==(s=null===(i=document.getElementsByTagName("head"))||void 0===i?void 0:i[0])&&void 0!==s?s:document).appendChild(r)}))}function wn(e){return`__${e}${Math.floor(1e6*Math.random())}`}const _n=1e12;class bn{constructor(e){this.auth=e,this.counter=_n,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new In(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||_n;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||_n;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||_n;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class In{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"==typeof e?document.getElementById(e):e;S(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const En=wn("rcb"),Tn=new x(3e4,6e4);class Sn{constructor(){this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!on().grecaptcha}load(e,t=""){return S(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)?Promise.resolve(on().grecaptcha):new Promise(((n,i)=>{const s=on().setTimeout((()=>{i(b(e,"network-request-failed"))}),Tn.get());on()[En]=()=>{on().clearTimeout(s),delete on()[En];const r=on().grecaptcha;if(!r)return void i(b(e,"internal-error"));const o=r.render;r.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(r)};vn(`https://www.google.com/recaptcha/api.js??${(0,r.xO)({onload:En,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(s),i(b(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){return!!on().grecaptcha&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class An{async load(e){return new bn(e)}clearedOneInstance(){}}const kn="recaptcha",Nn={theme:"light",type:"image"};class Rn{constructor(e,t=Object.assign({},Nn),n){this.parameters=t,this.type=kn,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ie(n),this.isInvisible="invisible"===this.parameters.size,S("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"==typeof e?document.getElementById(e):e;S(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new An:new Sn,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){S(!this.parameters.sitekey,this.auth,"argument-error"),S(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),S("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"==typeof e)e(t);else if("string"==typeof e){const n=on()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){S(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){S(D()&&!an(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await B(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);S(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return S(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class Cn{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Le._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function On(e,t,n){const i=Ie(e),s=await xn(i,t,(0,r.m9)(n));return new Cn(s,(e=>ot(i,e)))}async function Dn(e,t,n){const i=(0,r.m9)(e);await rt(!1,i,"phone");const s=await xn(i.auth,t,(0,r.m9)(n));return new Cn(s,(e=>at(i,e)))}async function Pn(e,t,n){const i=(0,r.m9)(e),s=await xn(i.auth,t,(0,r.m9)(n));return new Cn(s,(e=>ct(i,e)))}async function xn(e,t,n){var r;const i=await n.verify();try{let s;if(S("string"==typeof i,e,"argument-error"),S(n.type===kn,e,"argument-error"),s="string"==typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){S("enroll"===t.type,e,"internal-error");const n=await function(e,t){return B(e,"POST","/v2/accounts/mfaEnrollment:start",V(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{S("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;S(n,e,"missing-multi-factor-info");const o=await function(e,t){return B(e,"POST","/v2/accounts/mfaSignIn:start",V(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return B(e,"POST","/v1/accounts:sendVerificationCode",V(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}async function Ln(e,t){await nt((0,r.m9)(e),t)}class Mn{constructor(e){this.providerId=Mn.PROVIDER_ID,this.auth=Ie(e)}verifyPhoneNumber(e,t){return xn(this.auth,e,(0,r.m9)(t))}static credential(e,t){return Le._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Mn.credentialFromTaggedObject(t)}static credentialFromError(e){return Mn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?Le._fromTokenResponse(t,n):null}}function Un(e,t){return t?R(t):(S(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Mn.PROVIDER_ID="phone",Mn.PHONE_SIGN_IN_METHOD="phone";class Fn extends ke{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return De(e,this._buildIdpRequest())}_linkToIdToken(e,t){return De(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return De(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Vn(e){return st(e.auth,new Fn(e),e.bypassAuthState)}function Bn(e){const{auth:t,user:n}=e;return S(n,t,"internal-error"),it(n,new Fn(e),e.bypassAuthState)}async function jn(e){const{auth:t,user:n}=e;return S(n,t,"internal-error"),nt(n,new Fn(e),e.bypassAuthState)}class qn{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Vn;case"linkViaPopup":case"linkViaRedirect":return jn;case"reauthViaPopup":case"reauthViaRedirect":return Bn;default:_(this.auth,"internal-error")}}resolve(e){k(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){k(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const zn=new x(2e3,1e4);async function Gn(e,t,n){const r=Ie(e);E(e,t,Ve);const i=Un(r,n);return new Kn(r,"signInViaPopup",t,i).executeNotNull()}async function Hn(e,t,n){const i=(0,r.m9)(e);E(i.auth,t,Ve);const s=Un(i.auth,n);return new Kn(i.auth,"reauthViaPopup",t,s,i).executeNotNull()}async function $n(e,t,n){const i=(0,r.m9)(e);E(i.auth,t,Ve);const s=Un(i.auth,n);return new Kn(i.auth,"linkViaPopup",t,s,i).executeNotNull()}class Kn extends qn{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Kn.currentPopupAction&&Kn.currentPopupAction.cancel(),Kn.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return S(e,this.auth,"internal-error"),e}async onExecution(){k(1===this.filter.length,"Popup operations only handle one event");const e=rn();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(b(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(b(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Kn.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(b(this.auth,"popup-closed-by-user"))}),2e3):this.pollId=window.setTimeout(e,zn.get())};e()}}Kn.currentPopupAction=null;const Wn=new Map;class Yn extends qn{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Wn.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Zn(t),r="true"===await Xn(e)._get(n);return await Xn(e)._remove(n),r}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Wn.set(this.auth._key(),e)}return e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function Qn(e,t){return Xn(e)._set(Zn(t),"true")}function Jn(){Wn.clear()}function Xn(e){return R(e._redirectPersistence)}function Zn(e){return ae("pendingRedirect",e.config.apiKey,e.name)}function er(e,t,n){return async function(e,t,n){const r=Ie(e);E(e,t,Ve);const i=Un(r,n);return await Qn(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function tr(e,t,n){return async function(e,t,n){const i=(0,r.m9)(e);E(i.auth,t,Ve);const s=Un(i.auth,n);await Qn(s,i.auth);const o=await sr(i);return s._openRedirect(i.auth,t,"reauthViaRedirect",o)}(e,t,n)}function nr(e,t,n){return async function(e,t,n){const i=(0,r.m9)(e);E(i.auth,t,Ve);const s=Un(i.auth,n);await rt(!1,i,t.providerId),await Qn(s,i.auth);const o=await sr(i);return s._openRedirect(i.auth,t,"linkViaRedirect",o)}(e,t,n)}async function rr(e,t){return await Ie(e)._initializationPromise,ir(e,t,!1)}async function ir(e,t,n=!1){const r=Ie(e),i=Un(r,t),s=new Yn(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function sr(e){const t=rn(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class or{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return cr(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!cr(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(b(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ar(e))}saveEventToCache(e){this.cachedEventUids.add(ar(e)),this.lastProcessedEventTime=Date.now()}}function ar(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function cr({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===(null==t?void 0:t.code)}async function ur(e,t={}){return B(e,"GET","/v1/projects",t)}const lr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hr=/^https?/;function dr(e){const t=O(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!hr.test(n))return!1;if(lr.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const fr=new x(3e4,6e4);function pr(){const e=on().___jsl;if(null==e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}let mr=null;function gr(e){return mr=mr||function(e){return new Promise(((t,n)=>{var r,i,s;function o(){pr(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{pr(),n(b(e,"network-request-failed"))},timeout:fr.get()})}if(null===(i=null===(r=on().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=on().gapi)||void 0===s?void 0:s.load)){const t=wn("iframefcb");return on()[t]=()=>{gapi.load?o():n(b(e,"network-request-failed"))},vn(`https://apis.google.com/js/api.js?onload=${t}`)}o()}})).catch((e=>{throw mr=null,e}))}(e),mr}const yr=new x(5e3,15e3),vr={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},wr=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _r(e){const t=e.config;S(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?L(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,s={apiKey:t.apiKey,appName:e.name,v:i.SDK_VERSION},o=wr.get(e.config.apiHost);o&&(s.eid=o);const a=e._getFrameworks();return a.length&&(s.fw=a.join(",")),`${n}?${(0,r.xO)(s).slice(1)}`}const br={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Ir{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Er(e,t,n,i=500,s=600){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-i)/2,0).toString();let c="";const u=Object.assign(Object.assign({},br),{width:i.toString(),height:s.toString(),top:o,left:a}),l=(0,r.z$)().toLowerCase();n&&(c=de(l)?"_blank":n),le(l)&&(t=t||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=(0,r.z$)()){var t;return ye(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(l)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new Ir(null);const d=window.open(t||"",c,h);S(d,e,"popup-blocked");try{d.focus()}catch(e){}return new Ir(d)}const Tr="__/auth/handler",Sr="emulator/auth/handler";function Ar(e,t,n,s,o,a){S(e.config.authDomain,e,"auth-domain-config-required"),S(e.config.apiKey,e,"invalid-api-key");const c={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:s,v:i.SDK_VERSION,eventId:o};if(t instanceof Ve){t.setDefaultLanguage(e.languageCode),c.providerId=t.providerId||"",(0,r.xb)(t.getCustomParameters())||(c.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(t instanceof Be){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(c.scopes=e.join(","))}e.tenantId&&(c.tid=e.tenantId);const u=c;for(const e of Object.keys(u))void 0===u[e]&&delete u[e];return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${Tr}`;return L(e,Sr)}(e)}?${(0,r.xO)(u).slice(1)}`}const kr="webStorageSupport";const Nr=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=tn,this._completeRedirectFn=ir}async _openPopup(e,t,n,r){var i;k(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return Er(e,Ar(e,t,n,O(),r),rn())}async _openRedirect(e,t,n,r){var i;return await this._originValidation(e),i=Ar(e,t,n,O(),r),on().location.href=i,new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(k(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n}async initAndGetManager(e){const t=await async function(e){const t=await gr(e),n=on().gapi;return S(n,e,"internal-error"),t.open({where:document.body,url:_r(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:vr,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=b(e,"network-request-failed"),s=on().setTimeout((()=>{r(i)}),yr.get());function o(){on().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}(e),n=new or(e);return t.register("authEvent",(t=>{S(null==t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(kr,{type:kr},(n=>{var r;const i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r.webStorageSupport;void 0!==i&&t(!!i),_(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await ur(e);for(const e of t)try{if(dr(e))return}catch(e){}_(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return we()||he()||ye()}};class Rr extends class{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return A("unexpected MultiFactorSessionType")}}}{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new Rr(e)}_finalizeEnroll(e,t,n){return function(e,t){return B(e,"POST","/v2/accounts/mfaEnrollment:finalize",V(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return B(e,"POST","/v2/accounts/mfaSignIn:finalize",V(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class Cr{constructor(){}static assertion(e){return Rr._fromCredential(e)}}Cr.FACTOR_ID="phone";var Or;class Dr{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{var n;e((null===(n=t)||void 0===n?void 0:n.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){S(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function Pr(e=(0,i.getApp)()){const t=(0,i._getProvider)(e,"auth");return t.isInitialized()?t.getImmediate():C(e,{popupRedirectResolver:Nr,persistence:[yn,Zt,tn]})}Or="Browser",(0,i._registerComponent)(new a.wA("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),{apiKey:r,authDomain:i}=n.options;return(e=>{S(r&&!r.includes(":"),"invalid-api-key",{appName:e.name}),S(!(null==i?void 0:i.includes(":")),"argument-error",{appName:e.name});const n={apiKey:r,authDomain:i,clientPlatform:Or,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_e(Or)},s=new be(e,n);return function(e,t){const n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(R);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(s,t),s})(n)}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),(0,i._registerComponent)(new a.wA("auth-internal",(e=>(e=>new Dr(e))(Ie(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,i.registerVersion)("@firebase/auth","0.18.1",function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(Or))},909:(e,t,n)=>{"use strict";n.d(t,{wA:()=>s,H0:()=>c});var r=n(655),i=n(4444),s=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),o="[DEFAULT]",a=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return e.prototype.get=function(e){var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new i.BH;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t,n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:o})}catch(e){}try{for(var i=(0,r.XA)(this.instancesDeferred.entries()),s=i.next();!s.done;s=i.next()){var a=(0,r.CR)(s.value,2),c=a[0],u=a[1],l=this.normalizeInstanceIdentifier(c);try{var h=this.getOrInitializeService({instanceIdentifier:l});u.resolve(h)}catch(e){}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=o),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return(0,r.mG)(this,void 0,void 0,(function(){var e;return(0,r.Jh)(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all((0,r.ev)((0,r.ev)([],(0,r.CR)(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),(0,r.CR)(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=o),this.instances.has(e)},e.prototype.getOptions=function(e){return void 0===e&&(e=o),this.instancesOptions.get(e)||{}},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var i=e.options,s=void 0===i?{}:i,o=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(o))throw Error(this.name+"("+o+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var a=this.getOrInitializeService({instanceIdentifier:o,options:s});try{for(var c=(0,r.XA)(this.instancesDeferred.entries()),u=c.next();!u.done;u=c.next()){var l=(0,r.CR)(u.value,2),h=l[0],d=l[1];o===this.normalizeInstanceIdentifier(h)&&d.resolve(a)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return a},e.prototype.onInit=function(e,t){var n,r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);var s=this.instances.get(r);return s&&e(s,r),function(){i.delete(e)}},e.prototype.invokeOnInitCallbacks=function(e,t){var n,i,s=this.onInitCallbacks.get(t);if(s)try{for(var o=(0,r.XA)(s),a=o.next();!a.done;a=o.next()){var c=a.value;try{c(e,t)}catch(e){}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===o?void 0:t),options:i}),this.instances.set(n,s),this.instancesOptions.set(n,i),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch(e){}return s||null},e.prototype.normalizeInstanceIdentifier=function(e){return void 0===e&&(e=o),this.component?this.component.multipleInstances?e:o:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}();var c=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new a(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}()},6934:(e,t,n)=>{"use strict";n.d(t,{in:()=>i,Yd:()=>u,Ub:()=>l,Am:()=>h});const r=[];var i;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));const s={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},o=i.INFO,a={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},c=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=a[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class u{constructor(e){this.name=e,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...e),this._logHandler(this,i.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...e),this._logHandler(this,i.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,i.INFO,...e),this._logHandler(this,i.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,i.WARN,...e),this._logHandler(this,i.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,i.ERROR,...e),this._logHandler(this,i.ERROR,...e)}}function l(e){r.forEach((t=>{t.setLogLevel(e)}))}function h(e,t){for(const n of r){let r=null;t&&t.level&&(r=s[t.level]),n.userLogHandler=null===e?null:(t,n,...s)=>{const o=s.map((e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}})).filter((e=>e)).join(" ");n>=(null!=r?r:t.logLevel)&&e({level:i[n].toLowerCase(),message:o,args:s,type:t.name})}}}},774:(e,t,n)=>{"use strict";n.d(t,{bm:()=>D,UJ:()=>F,gE:()=>_,FN:()=>ue,$Y:()=>le,IX:()=>pe,qm:()=>x,g6:()=>Ve,gH:()=>f,y4:()=>m,a1:()=>je,oq:()=>Ue,Jt:()=>Me,sd:()=>De,cF:()=>Be,pb:()=>xe,aF:()=>Le,iH:()=>Fe,Ym:()=>Pe,KV:()=>Re,B0:()=>Oe,sf:()=>Ce});var r,i=n(4258),s=n(4444),o=n(909);!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(r||(r={}));const a="firebasestorage.googleapis.com";class c extends s.ZR{constructor(e,t){super(u(e),`Firebase Storage: ${t} (${u(e)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,c.prototype)}_codeEquals(e){return u(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function u(e){return"storage/"+e}function l(){return new c("unknown","An unknown error occurred, please check the error payload for server response.")}function h(){return new c("canceled","User canceled the upload/download.")}function d(){return new c("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function f(e){return new c("invalid-argument",e)}function p(){return new c("app-deleted","The Firebase app was deleted.")}function m(e){return new c("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function g(e,t){return new c("invalid-format","String does not match format '"+e+"': "+t)}function y(e){throw new c("internal-error","Internal error: "+e)}class v{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=r.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=r.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=r.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r){if(this.sent_)throw y("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const e in r)r.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,r[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw y("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw y("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponseText(){if(!this.sent_)throw y("cannot .getResponseText() before sending");return this.xhr_.responseText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class w{createConnection(){return new v}}class _{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=_.makeFromUrl(e,t)}catch(t){return new _(e,"")}if(""===n.path)return n;throw new c("invalid-default-bucket","Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),u=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===a?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let t=0;t<u.length;t++){const r=u[t],i=r.regex.exec(e);if(i){const e=i[r.indices.bucket];let t=i[r.indices.path];t||(t=""),n=new _(e,t),r.postModify(n);break}}if(null==n)throw function(e){return new c("invalid-url","Invalid URL '"+e+"'.")}(e);return n}}class b{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function I(e){return"string"==typeof e||e instanceof String}function E(e){return T()&&e instanceof Blob}function T(){return"undefined"!=typeof Blob}function S(e,t,n,r){if(r<t)throw f(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw f(`Invalid value for '${e}'. Expected ${n} or less.`)}function A(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function k(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}class N{constructor(e,t,n,r,i,s,o,a,c,u,l){this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=s.slice(),this.callback_=o,this.errorCallback_=a,this.progressCallback_=u,this.timeout_=c,this.pool_=l,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=this;function t(t,n){const r=e.resolve_,i=e.reject_,s=n.connection;if(n.wasSuccessCode)try{const t=e.callback_(s,s.getResponseText());!function(e){return void 0!==e}(t)?r():r(t)}catch(e){i(e)}else if(null!==s){const t=l();t.serverResponse=s.getResponseText(),e.errorCallback_?i(e.errorCallback_(s,t)):i(t)}else if(n.canceled){i(e.appDelete_?p():h())}else{i(new c("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}}this.canceled_?t(0,new R(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=!1,o=0;function a(){return 2===o}let c=!1;function u(...e){c||(c=!0,t.apply(null,e))}function l(t){i=setTimeout((()=>{i=null,e(h,a())}),t)}function h(e,...t){if(c)return;if(e)return void u.call(null,e,...t);if(a()||s)return void u.call(null,e,...t);let n;r<64&&(r*=2),1===o?(o=2,n=0):n=1e3*(r+Math.random()),l(n)}let d=!1;function f(e){d||(d=!0,c||(null!==i?(e||(o=2),clearTimeout(i),l(0)):e||(o=1)))}return l(0),setTimeout((()=>{s=!0,f(!0)}),n),f}((function(t,n){if(n)return void t(!1,new R(!1,null,!0));const i=e.pool_.createConnection();function s(t){const n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)}e.pendingConnection_=i,null!==e.progressCallback_&&i.addUploadProgressListener(s),i.send(e.url_,e.method_,e.body_,e.headers_).then((()=>{null!==e.progressCallback_&&i.removeUploadProgressListener(s),e.pendingConnection_=null;const n=i.getErrorCode()===r.NO_ERROR,o=i.getStatus();if(!n||e.isRetryStatusCode_(o)){const e=i.getErrorCode()===r.ABORT;return void t(!1,new R(!1,null,e))}const a=-1!==e.successCodes_.indexOf(o);t(!0,new R(a,i))}))}),t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(e){const t=e>=500&&e<600,n=-1!==[408,429].indexOf(e),r=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||r}}class R{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function C(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function O(...e){const t=C();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(T())return new Blob(e);throw new c("unsupported-environment","This browser doesn't seem to support creating Blobs")}const D={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class P{constructor(e,t){this.data=e,this.contentType=t||null}}function x(e,t){switch(e){case D.RAW:return new P(L(t));case D.BASE64:case D.BASE64URL:return new P(M(e,t));case D.DATA_URL:return new P(function(e){const t=new U(e);return t.base64?M(D.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw g(D.DATA_URL,"Malformed data URL.")}return L(t)}(t.rest)}(t),new U(t).contentType)}throw l()}function L(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296==(64512&r)){if(n<e.length-1&&56320==(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320==(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function M(e,t){switch(e){case D.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw g(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case D.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw g(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=atob(t)}catch(t){throw g(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}class U{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw g(D.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1)}}class F{constructor(e,t){let n=0,r="";E(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(E(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new F(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new F(n,!0)}}static getBlob(...e){if(T()){const t=e.map((e=>e instanceof F?e.data_:e));return new F(O.apply(null,t))}{const t=e.map((e=>I(e)?x(D.RAW,e).data:e.data_));let n=0;t.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let i=0;return t.forEach((e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]})),new F(r,!0)}}uploadData(){return this.data_}}function V(e){let t;try{t=JSON.parse(e)}catch(e){return null}return function(e){return"object"==typeof e&&!Array.isArray(e)}(t)?t:null}function B(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function j(e,t){return t}class q{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||j}}let z=null;function G(){if(z)return z;const e=[];e.push(new q("bucket")),e.push(new q("generation")),e.push(new q("metageneration")),e.push(new q("name","fullPath",!0));const t=new q("name");t.xform=function(e,t){return function(e){return!I(e)||e.length<2?e:B(e)}(t)},e.push(t);const n=new q("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new q("timeCreated")),e.push(new q("updated")),e.push(new q("md5Hash",null,!0)),e.push(new q("cacheControl",null,!0)),e.push(new q("contentDisposition",null,!0)),e.push(new q("contentEncoding",null,!0)),e.push(new q("contentLanguage",null,!0)),e.push(new q("contentType",null,!0)),e.push(new q("metadata","customMetadata",!0)),z=e,z}function H(e,t,n){const r={type:"file"},i=n.length;for(let e=0;e<i;e++){const i=n[e];r[i.local]=i.xform(r,t[i.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new _(n,r);return t._makeStorageReference(i)}})}(r,e),r}function $(e,t,n){const r=V(t);if(null===r)return null;return H(e,r,n)}function K(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}function W(e,t,n){const r=V(n);if(null===r)return null;return function(e,t,n){const r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(const i of n.prefixes){const n=i.replace(/\/$/,""),s=e._makeStorageReference(new _(t,n));r.prefixes.push(s)}if(n.items)for(const i of n.items){const n=e._makeStorageReference(new _(t,i.name));r.items.push(n)}return r}(e,t,r)}class Y{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Q(e){if(!e)throw l()}function J(e,t){return function(n,r){const i=$(e,r,t);return Q(null!==i),i}}function X(e,t){return function(n,r){const i=$(e,r,t);return Q(null!==i),function(e,t,n,r){const i=V(t);if(null===i)return null;if(!I(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map((t=>{const i=e.bucket,s=e.fullPath;return A("/b/"+o(i)+"/o/"+o(s),n,r)+k({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function Z(e){return function(t,n){let r;var i,s;return 401===t.getStatus()?r=t.getResponseText().includes("Firebase App Check token is invalid")?new c("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new c("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,r=new c("quota-exceeded","Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new c("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function ee(e){const t=Z(e);return function(n,r){let i=t(n,r);var s;return 404===n.getStatus()&&(s=e.path,i=new c("object-not-found","Object '"+s+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function te(e,t,n){const r=A(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new Y(r,"GET",J(e,n),i);return s.errorHandler=ee(t),s}function ne(e,t,n,r,i){const s={};t.isRoot?s.prefix="":s.prefix=t.path+"/",n&&n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),i&&(s.maxResults=i);const o=A(t.bucketOnlyServerUrl(),e.host,e._protocol),a=e.maxOperationRetryTime,c=new Y(o,"GET",function(e,t){return function(n,r){const i=W(e,t,r);return Q(null!==i),i}}(e,t.bucket),a);return c.urlParams=s,c.errorHandler=Z(t),c}function re(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function ie(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};const a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const c=re(t,r,i),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+K(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=F.getBlob(u,r,l);if(null===h)throw d();const f={name:c.fullPath},p=A(s,e.host,e._protocol),m=e.maxUploadRetryTime,g=new Y(p,"POST",J(e,n),m);return g.urlParams=f,g.headers=o,g.body=h.uploadData(),g.errorHandler=Z(t),g}class se{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function oe(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){Q(!1)}return Q(!!n&&-1!==(t||["active"]).indexOf(n)),n}const ae=262144;function ce(e,t,n,r,i,s,o,a){const u=new se(0,0);if(o?(u.current=o.current,u.total=o.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new c("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");const l=u.total-u.current;let h=l;i>0&&(h=Math.min(h,i));const f=u.current,p=f+h,m={"X-Goog-Upload-Command":h===l?"upload, finalize":"upload","X-Goog-Upload-Offset":`${u.current}`},g=r.slice(f,p);if(null===g)throw d();const y=t.maxUploadRetryTime,v=new Y(n,"POST",(function(e,n){const i=oe(e,["active","final"]),o=u.current+h,a=r.size();let c;return c="final"===i?J(t,s)(e,n):null,new se(o,a,"final"===i,c)}),y);return v.headers=m,v.body=g.uploadData(),v.progressCallback=a||null,v.errorHandler=Z(e),v}const ue={STATE_CHANGED:"state_changed"},le={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function he(e){switch(e){case"running":case"pausing":case"canceling":return le.RUNNING;case"paused":return le.PAUSED;case"success":return le.SUCCESS;case"canceled":return le.CANCELED;default:return le.ERROR}}class de{constructor(e,t,n){if(function(e){return"function"==typeof e}(e)||null!=t||null!=n)this.next=e,this.error=null!=t?t:void 0,this.complete=null!=n?n:void 0;else{const t=e;this.next=t.next,this.error=t.error,this.complete=t.complete}}}function fe(e){return(...t)=>{Promise.resolve().then((()=>e(...t)))}}class pe{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=G(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{this._request=void 0,this._chunkMultiplier=1,e._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=e,this._transition("error"))},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals("canceled")?this.completeTransitions_():(this._error=e,this._transition("error"))},this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t,this._start()})),this._promise.then(null,(()=>{}))}_makeProgressCallback(){const e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then((([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}}))}_createResumable(){this._resolveToken(((e,t)=>{const n=function(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o=re(t,r,i),a={name:o.fullPath},c=A(s,e.host,e._protocol),u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},l=K(o,n),h=e.maxUploadRetryTime,d=new Y(c,"POST",(function(e){let t;oe(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){Q(!1)}return Q(I(t)),t}),h);return d.urlParams=a,d.headers=u,d.body=l,d.errorHandler=Z(t),d}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()}),this._errorHandler)}))}_fetchStatus(){const e=this._uploadUrl;this._resolveToken(((t,n)=>{const r=function(e,t,n,r){const i=e.maxUploadRetryTime,s=new Y(n,"POST",(function(e){const t=oe(e,["active","final"]);let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){Q(!1)}n||Q(!1);const i=Number(n);return Q(!isNaN(i)),new se(i,r.size(),"final"===t)}),i);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=Z(t),s}(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,t,n);this._request=i,i.getPromise().then((e=>{e=e,this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()}),this._errorHandler)}))}_continueUpload(){const e=ae*this._chunkMultiplier,t=new se(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken(((r,i)=>{let s;try{s=ce(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(e){return this._error=e,void this._transition("error")}const o=this._ref.storage._makeRequest(s,r,i);this._request=o,o.getPromise().then((e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()}),this._errorHandler)}))}_increaseMultiplier(){ae*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken(((e,t)=>{const n=te(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._transition("success")}),this._metadataErrorHandler)}))}_oneShotUpload(){this._resolveToken(((e,t)=>{const n=ie(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,e,t);this._request=r,r.getPromise().then((e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")}),this._errorHandler)}))}_updateProgress(e){const t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":const t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=h(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){const e=he(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){const i=new de(t||void 0,n||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();this._observers.slice().forEach((e=>{this._notifyObserver(e)}))}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(he(this._state)){case le.SUCCESS:fe(this._resolve.bind(null,this.snapshot))();break;case le.CANCELED:case le.ERROR:fe(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(he(this._state)){case le.RUNNING:case le.PAUSED:e.next&&fe(e.next.bind(e,this.snapshot))();break;case le.SUCCESS:e.complete&&fe(e.complete.bind(e))();break;case le.CANCELED:case le.ERROR:default:e.error&&fe(e.error.bind(e,this._error))()}}resume(){const e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){const e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){const e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}class me{constructor(e,t){this._service=e,this._location=t instanceof _?t:_.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new me(e,t)}get root(){const e=new _(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return B(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new _(this._location.bucket,e);return new me(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw m(e)}}function ge(e,t,n){e._throwIfRoot("uploadBytes");const r=ie(e.storage,e._location,G(),new F(t,!0),n);return e.storage.makeRequestWithTokens(r).then((e=>e.getPromise())).then((t=>({metadata:t,ref:e})))}function ye(e){const t={prefixes:[],items:[]};return ve(e,t).then((()=>t))}async function ve(e,t,n){const r={pageToken:n},i=await we(e,r);t.prefixes.push(...i.prefixes),t.items.push(...i.items),null!=i.nextPageToken&&await ve(e,t,i.nextPageToken)}async function we(e,t){null!=t&&"number"==typeof t.maxResults&&S("options.maxResults",1,1e3,t.maxResults);const n=t||{},r=ne(e.storage,e._location,"/",n.pageToken,n.maxResults);return(await e.storage.makeRequestWithTokens(r)).getPromise()}async function _e(e,t){e._throwIfRoot("updateMetadata");const n=function(e,t,n,r){const i=A(t.fullServerUrl(),e.host,e._protocol),s=K(n,r),o=e.maxOperationRetryTime,a=new Y(i,"PATCH",J(e,r),o);return a.headers={"Content-Type":"application/json; charset=utf-8"},a.body=s,a.errorHandler=ee(t),a}(e.storage,e._location,t,G());return(await e.storage.makeRequestWithTokens(n)).getPromise()}async function be(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=A(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new Y(r,"GET",X(e,n),i);return s.errorHandler=ee(t),s}(e.storage,e._location,G());return(await e.storage.makeRequestWithTokens(t)).getPromise().then((e=>{if(null===e)throw new c("no-download-url","The given file does not have any download URLs.");return e}))}async function Ie(e){e._throwIfRoot("deleteObject");const t=function(e,t){const n=A(t.fullServerUrl(),e.host,e._protocol),r=e.maxOperationRetryTime,i=new Y(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=ee(t),i}(e.storage,e._location);return(await e.storage.makeRequestWithTokens(t)).getPromise()}function Ee(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new _(e._location.bucket,n);return new me(e.storage,r)}function Te(e,t){if(e instanceof ke){const n=e;if(null==n._bucket)throw new c("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");const r=new me(n,n._bucket);return null!=t?Te(r,t):r}return void 0!==t?Ee(e,t):e}function Se(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof ke)return new me(e,t);throw f("To use ref(service, url), the first argument must be a Storage instance.")}return Te(e,t)}function Ae(e,t){const n=null==t?void 0:t.storageBucket;return null==n?null:_.makeFromBucketSpec(n,e)}class ke{constructor(e,t,n,r,i,s){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._pool=r,this._url=i,this._firebaseVersion=s,this._bucket=null,this._host=a,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=i?_.makeFromBucketSpec(i,this._host):Ae(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=_.makeFromBucketSpec(this._url,e):this._bucket=Ae(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){S("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){S("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new me(this,e)}_makeRequest(e,t,n){if(this._deleted)return new b(p());{const r=function(e,t,n,r,i,s){const o=k(e.urlParams),a=e.url+o,c=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(c,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(c,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!=t?t:"AppManager")}(c,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(c,r),new N(a,e.method,c,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i)}(e,this._appId,t,n,this._pool,this._firebaseVersion);return this._requests.add(r),r.getPromise().then((()=>this._requests.delete(r)),(()=>this._requests.delete(r))),r}}async makeRequestWithTokens(e){const[t,n]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n)}}const Ne="storage";function Re(e,t,n){return ge(e=(0,s.m9)(e),t,n)}function Ce(e,t,n,r){return function(e,t,n=D.RAW,r){e._throwIfRoot("uploadString");const i=x(n,t),s=Object.assign({},r);return null==s.contentType&&null!=i.contentType&&(s.contentType=i.contentType),ge(e,i.data,s)}(e=(0,s.m9)(e),t,n,r)}function Oe(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new pe(e,new F(t),n)}(e=(0,s.m9)(e),t,n)}function De(e){return async function(e){e._throwIfRoot("getMetadata");const t=te(e.storage,e._location,G());return(await e.storage.makeRequestWithTokens(t)).getPromise()}(e=(0,s.m9)(e))}function Pe(e,t){return _e(e=(0,s.m9)(e),t)}function xe(e,t){return we(e=(0,s.m9)(e),t)}function Le(e){return ye(e=(0,s.m9)(e))}function Me(e){return be(e=(0,s.m9)(e))}function Ue(e){return Ie(e=(0,s.m9)(e))}function Fe(e,t){return Se(e=(0,s.m9)(e),t)}function Ve(e,t){return Ee(e,t)}function Be(e=(0,i.getApp)(),t){e=(0,s.m9)(e);return(0,i._getProvider)(e,Ne).getImmediate({identifier:t})}function je(e,t,n,r={}){!function(e,t,n,r={}){e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"==typeof i?i:(0,s.Sg)(i,e.app.options.projectId))}(e,t,n,r)}function qe(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new ke(n,r,s,new w,t,i.SDK_VERSION)}(0,i._registerComponent)(new o.wA(Ne,qe,"PUBLIC").setMultipleInstances(!0)),(0,i.registerVersion)("@firebase/storage","0.8.3")},4444:(e,t,n)=>{"use strict";n.d(t,{BH:()=>c,LL:()=>T,ZR:()=>E,zI:()=>I,tV:()=>o,$s:()=>M,r3:()=>A,Sg:()=>u,ne:()=>P,vZ:()=>N,ZB:()=>a,pd:()=>D,m9:()=>U,z$:()=>l,jU:()=>f,ru:()=>p,d:()=>g,xb:()=>k,w1:()=>y,hl:()=>_,uI:()=>h,UG:()=>d,b$:()=>m,G6:()=>w,Mn:()=>v,xO:()=>C,zd:()=>O,eu:()=>b});const r=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},i={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){const i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,c=a?e[t+2]:0,u=i>>2,l=(3&i)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(r(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){const i=n[e.charAt(t++)],s=t<e.length?n[e.charAt(t)]:0;++t;const o=t<e.length?n[e.charAt(t)]:64;++t;const a=t<e.length?n[e.charAt(t)]:64;if(++t,null==i||null==s||null==o||null==a)throw Error();const c=i<<2|s>>4;if(r.push(c),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},s=function(e){return function(e){const t=r(e);return i.encodeByteArray(t,!0)}(e).replace(/\./g,"")},o=function(e){try{return i.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function a(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=a(e[n],t[n]));return e}class c{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function u(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[s(JSON.stringify({alg:"none",type:"JWT"})),s(JSON.stringify(o)),""].join(".")}function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function h(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())}function d(){try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}function f(){return"object"==typeof self&&self.self===self}function p(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function m(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function g(){return l().indexOf("Electron/")>=0}function y(){const e=l();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function v(){return l().indexOf("MSAppHost/")>=0}function w(){return!d()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _(){return"object"==typeof indexedDB}function b(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}}))}function I(){return!("undefined"==typeof navigator||!navigator.cookieEnabled)}class E extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,E.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,T.prototype.create)}}class T{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(S,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new E(r,o,n)}}const S=/\{\$([^}]+)}/g;function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function k(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function N(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(R(n)&&R(s)){if(!N(n,s))return!1}else if(n!==s)return!1}for(const e of r)if(!n.includes(e))return!1;return!0}function R(e){return null!==e&&"object"==typeof e}function C(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function O(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function D(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function P(e,t){const n=new x(e,t);return n.subscribe.bind(n)}class x{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=L),void 0===r.error&&(r.error=L),void 0===r.complete&&(r.complete=L);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function L(){}function M(e,t=1e3,n=2){const r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function U(e){return e&&e._delegate?e._delegate:e}},9669:(e,t,n)=>{e.exports=n(1609)},5448:(e,t,n)=>{"use strict";var r=n(4867),i=n(6026),s=n(4372),o=n(5327),a=n(4097),c=n(4109),u=n(7985),l=n(5061),h=n(5655),d=n(5263);e.exports=function(e){return new Promise((function(t,n){var f,p=e.data,m=e.headers,g=e.responseType;function y(){e.cancelToken&&e.cancelToken.unsubscribe(f),e.signal&&e.signal.removeEventListener("abort",f)}r.isFormData(p)&&delete m["Content-Type"];var v=new XMLHttpRequest;if(e.auth){var w=e.auth.username||"",_=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";m.Authorization="Basic "+btoa(w+":"+_)}var b=a(e.baseURL,e.url);function I(){if(v){var r="getAllResponseHeaders"in v?c(v.getAllResponseHeaders()):null,s={data:g&&"text"!==g&&"json"!==g?v.response:v.responseText,status:v.status,statusText:v.statusText,headers:r,config:e,request:v};i((function(e){t(e),y()}),(function(e){n(e),y()}),s),v=null}}if(v.open(e.method.toUpperCase(),o(b,e.params,e.paramsSerializer),!0),v.timeout=e.timeout,"onloadend"in v?v.onloadend=I:v.onreadystatechange=function(){v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))&&setTimeout(I)},v.onabort=function(){v&&(n(l("Request aborted",e,"ECONNABORTED",v)),v=null)},v.onerror=function(){n(l("Network Error",e,null,v)),v=null},v.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded",r=e.transitional||h.transitional;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(l(t,e,r.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",v)),v=null},r.isStandardBrowserEnv()){var E=(e.withCredentials||u(b))&&e.xsrfCookieName?s.read(e.xsrfCookieName):void 0;E&&(m[e.xsrfHeaderName]=E)}"setRequestHeader"in v&&r.forEach(m,(function(e,t){void 0===p&&"content-type"===t.toLowerCase()?delete m[t]:v.setRequestHeader(t,e)})),r.isUndefined(e.withCredentials)||(v.withCredentials=!!e.withCredentials),g&&"json"!==g&&(v.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&v.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(f=function(e){v&&(n(!e||e&&e.type?new d("canceled"):e),v.abort(),v=null)},e.cancelToken&&e.cancelToken.subscribe(f),e.signal&&(e.signal.aborted?f():e.signal.addEventListener("abort",f))),p||(p=null),v.send(p)}))}},1609:(e,t,n)=>{"use strict";var r=n(4867),i=n(1849),s=n(321),o=n(7185);var a=function e(t){var n=new s(t),a=i(s.prototype.request,n);return r.extend(a,s.prototype,n),r.extend(a,n),a.create=function(n){return e(o(t,n))},a}(n(5655));a.Axios=s,a.Cancel=n(5263),a.CancelToken=n(4972),a.isCancel=n(6502),a.VERSION=n(7288).version,a.all=function(e){return Promise.all(e)},a.spread=n(8713),a.isAxiosError=n(6268),e.exports=a,e.exports.default=a},5263:e=>{"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},4972:(e,t,n)=>{"use strict";var r=n(5263);function i(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,r=n._listeners.length;for(t=0;t<r;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,r=new Promise((function(e){n.subscribe(e),t=e})).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e((function(e){n.reason||(n.reason=new r(e),t(n.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},i.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},6502:e=>{"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},321:(e,t,n)=>{"use strict";var r=n(4867),i=n(5327),s=n(782),o=n(3572),a=n(7185),c=n(4875),u=c.validators;function l(e){this.defaults=e,this.interceptors={request:new s,response:new s}}l.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=e.transitional;void 0!==t&&c.assertOptions(t,{silentJSONParsing:u.transitional(u.boolean),forcedJSONParsing:u.transitional(u.boolean),clarifyTimeoutError:u.transitional(u.boolean)},!1);var n=[],r=!0;this.interceptors.request.forEach((function(t){"function"==typeof t.runWhen&&!1===t.runWhen(e)||(r=r&&t.synchronous,n.unshift(t.fulfilled,t.rejected))}));var i,s=[];if(this.interceptors.response.forEach((function(e){s.push(e.fulfilled,e.rejected)})),!r){var l=[o,void 0];for(Array.prototype.unshift.apply(l,n),l=l.concat(s),i=Promise.resolve(e);l.length;)i=i.then(l.shift(),l.shift());return i}for(var h=e;n.length;){var d=n.shift(),f=n.shift();try{h=d(h)}catch(e){f(e);break}}try{i=o(h)}catch(e){return Promise.reject(e)}for(;s.length;)i=i.then(s.shift(),s.shift());return i},l.prototype.getUri=function(e){return e=a(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},r.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),r.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,n,r){return this.request(a(r||{},{method:e,url:t,data:n}))}})),e.exports=l},782:(e,t,n)=>{"use strict";var r=n(4867);function i(){this.handlers=[]}i.prototype.use=function(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){r.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},4097:(e,t,n)=>{"use strict";var r=n(1793),i=n(7303);e.exports=function(e,t){return e&&!r(t)?i(e,t):t}},5061:(e,t,n)=>{"use strict";var r=n(481);e.exports=function(e,t,n,i,s){var o=new Error(e);return r(o,t,n,i,s)}},3572:(e,t,n)=>{"use strict";var r=n(4867),i=n(8527),s=n(6502),o=n(5655),a=n(5263);function c(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new a("canceled")}e.exports=function(e){return c(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),r.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return c(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return s(t)||(c(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:e=>{"use strict";e.exports=function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},7185:(e,t,n)=>{"use strict";var r=n(4867);e.exports=function(e,t){t=t||{};var n={};function i(e,t){return r.isPlainObject(e)&&r.isPlainObject(t)?r.merge(e,t):r.isPlainObject(t)?r.merge({},t):r.isArray(t)?t.slice():t}function s(n){return r.isUndefined(t[n])?r.isUndefined(e[n])?void 0:i(void 0,e[n]):i(e[n],t[n])}function o(e){if(!r.isUndefined(t[e]))return i(void 0,t[e])}function a(n){return r.isUndefined(t[n])?r.isUndefined(e[n])?void 0:i(void 0,e[n]):i(void 0,t[n])}function c(n){return n in t?i(e[n],t[n]):n in e?i(void 0,e[n]):void 0}var u={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:c};return r.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=u[e]||s,i=t(e);r.isUndefined(i)&&t!==c||(n[e]=i)})),n}},6026:(e,t,n)=>{"use strict";var r=n(5061);e.exports=function(e,t,n){var i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},8527:(e,t,n)=>{"use strict";var r=n(4867),i=n(5655);e.exports=function(e,t,n){var s=this||i;return r.forEach(n,(function(n){e=n.call(s,e,t)})),e}},5655:(e,t,n)=>{"use strict";var r=n(4867),i=n(6016),s=n(481),o={"Content-Type":"application/x-www-form-urlencoded"};function a(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c,u={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:(("undefined"!=typeof XMLHttpRequest||"undefined"!=typeof process&&"[object process]"===Object.prototype.toString.call(process))&&(c=n(5448)),c),transformRequest:[function(e,t){return i(t,"Accept"),i(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(a(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)||t&&"application/json"===t["Content-Type"]?(a(t,"application/json"),function(e,t,n){if(r.isString(e))try{return(t||JSON.parse)(e),r.trim(e)}catch(e){if("SyntaxError"!==e.name)throw e}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||u.transitional,n=t&&t.silentJSONParsing,i=t&&t.forcedJSONParsing,o=!n&&"json"===this.responseType;if(o||i&&r.isString(e)&&e.length)try{return JSON.parse(e)}catch(e){if(o){if("SyntaxError"===e.name)throw s(e,this,"E_JSON_PARSE");throw e}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],(function(e){u.headers[e]={}})),r.forEach(["post","put","patch"],(function(e){u.headers[e]=r.merge(o)})),e.exports=u},7288:e=>{e.exports={version:"0.22.0"}},1849:e=>{"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},5327:(e,t,n)=>{"use strict";var r=n(4867);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(r.isURLSearchParams(t))s=t.toString();else{var o=[];r.forEach(t,(function(e,t){null!=e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,(function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),o.push(i(t)+"="+i(e))})))})),s=o.join("&")}if(s){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}},7303:e=>{"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:(e,t,n)=>{"use strict";var r=n(4867);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,i,s,o){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(i)&&a.push("path="+i),r.isString(s)&&a.push("domain="+s),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},1793:e=>{"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},6268:e=>{"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},7985:(e,t,n)=>{"use strict";var r=n(4867);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function i(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=i(window.location.href),function(t){var n=r.isString(t)?i(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},6016:(e,t,n)=>{"use strict";var r=n(4867);e.exports=function(e,t){r.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))}},4109:(e,t,n)=>{"use strict";var r=n(4867),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,o={};return e?(r.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=r.trim(e.substr(0,s)).toLowerCase(),n=r.trim(e.substr(s+1)),t){if(o[t]&&i.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([n]):o[t]?o[t]+", "+n:n}})),o):o}},8713:e=>{"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},4875:(e,t,n)=>{"use strict";var r=n(7288).version,i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var s={};i.transitional=function(e,t,n){function i(e,t){return"[Axios v"+r+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,r,o){if(!1===e)throw new Error(i(r," has been removed"+(t?" in "+t:"")));return t&&!s[r]&&(s[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,o)}},e.exports={assertOptions:function(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var r=Object.keys(e),i=r.length;i-- >0;){var s=r[i],o=t[s];if(o){var a=e[s],c=void 0===a||o(a,s,e);if(!0!==c)throw new TypeError("option "+s+" must be "+c)}else if(!0!==n)throw Error("Unknown option "+s)}},validators:i}},4867:(e,t,n)=>{"use strict";var r=n(1849),i=Object.prototype.toString;function s(e){return"[object Array]"===i.call(e)}function o(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function u(e){return"[object Function]"===i.call(e)}function l(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:o,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:u,isStream:function(e){return a(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:l,merge:function e(){var t={};function n(n,r){c(t[r])&&c(n)?t[r]=e(t[r],n):c(n)?t[r]=e({},n):s(n)?t[r]=n.slice():t[r]=n}for(var r=0,i=arguments.length;r<i;r++)l(arguments[r],n);return t},extend:function(e,t,n){return l(t,(function(t,i){e[i]=n&&"function"==typeof t?r(t,n):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},3887:(e,t,n)=>{"use strict";n.r(t),n.d(t,{getAnalytics:()=>be,initializeAnalytics:()=>Ie,isSupported:()=>Ee,logEvent:()=>Ne,setAnalyticsCollectionEnabled:()=>ke,setCurrentScreen:()=>Te,setUserId:()=>Se,setUserProperties:()=>Ae,settings:()=>we});var r=n(4258),i=n(6934),s=n(4444),o=n(909),a=n(8676);const c="0.5.1",u=1e4,l="w:0.5.1",h="FIS_v2",d=36e5,f={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},p=new s.LL("installations","Installations",f);function m(e){return e instanceof s.ZR&&e.code.includes("request-failed")}function g({projectId:e}){return`https://firebaseinstallations.googleapis.com/v1/projects/${e}/installations`}function y(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}async function v(e,t){const n=(await t.json()).error;return p.create("request-failed",{requestName:e,serverCode:n.code,serverMessage:n.message,serverStatus:n.status})}function w({apiKey:e}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function _(e,{refreshToken:t}){const n=w(e);return n.append("Authorization",function(e){return`FIS_v2 ${e}`}(t)),n}async function b(e){const t=await e();return t.status>=500&&t.status<600?e():t}function I(e){return new Promise((t=>{setTimeout(t,e)}))}const E=/^[cdef][\w-]{21}$/;function T(){try{const e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;const t=function(e){return(t=e,btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}(e);return E.test(t)?t:""}catch(e){return""}}function S(e){return`${e.appName}!${e.appId}`}const A=new Map;function k(e,t){const n=S(e);N(n,t),function(e,t){const n=C();n&&n.postMessage({key:e,fid:t});O()}(n,t)}function N(e,t){const n=A.get(e);if(n)for(const e of n)e(t)}let R=null;function C(){return!R&&"BroadcastChannel"in self&&(R=new BroadcastChannel("[Firebase] FID Change"),R.onmessage=e=>{N(e.data.key,e.data.fid)}),R}function O(){0===A.size&&R&&(R.close(),R=null)}const D="firebase-installations-store";let P=null;function x(){return P||(P=(0,a.openDb)("firebase-installations-database",1,(e=>{if(0===e.oldVersion)e.createObjectStore(D)}))),P}async function L(e,t){const n=S(e),r=(await x()).transaction(D,"readwrite"),i=r.objectStore(D),s=await i.get(n);return await i.put(t,n),await r.complete,s&&s.fid===t.fid||k(e,t.fid),t}async function M(e){const t=S(e),n=(await x()).transaction(D,"readwrite");await n.objectStore(D).delete(t),await n.complete}async function U(e,t){const n=S(e),r=(await x()).transaction(D,"readwrite"),i=r.objectStore(D),s=await i.get(n),o=t(s);return void 0===o?await i.delete(n):await i.put(o,n),await r.complete,!o||s&&s.fid===o.fid||k(e,o.fid),o}async function F(e){let t;const n=await U(e,(n=>{const r=function(e){return j(e||{fid:T(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine){return{installationEntry:t,registrationPromise:Promise.reject(p.create("app-offline"))}}const n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()},r=async function(e,t){try{const n=await async function(e,{fid:t}){const n=g(e),r=w(e),i={fid:t,authVersion:h,appId:e.appId,sdkVersion:l},s={method:"POST",headers:r,body:JSON.stringify(i)},o=await b((()=>fetch(n,s)));if(o.ok){const e=await o.json();return{fid:e.fid||t,registrationStatus:2,refreshToken:e.refreshToken,authToken:y(e.authToken)}}throw await v("Create Installation",o)}(e,t);return L(e,n)}catch(n){throw m(n)&&409===n.customData.serverCode?await M(e):await L(e,{fid:t.fid,registrationStatus:0}),n}}(e,n);return{installationEntry:n,registrationPromise:r}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:V(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}));return""===n.fid?{installationEntry:await t}:{installationEntry:n,registrationPromise:t}}async function V(e){let t=await B(e);for(;1===t.registrationStatus;)await I(100),t=await B(e);if(0===t.registrationStatus){const{installationEntry:t,registrationPromise:n}=await F(e);return n||t}return t}function B(e){return U(e,(e=>{if(!e)throw p.create("installation-not-found");return j(e)}))}function j(e){return 1===(t=e).registrationStatus&&t.registrationTime+u<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}async function q({appConfig:e,platformLoggerProvider:t},n){const r=function(e,{fid:t}){return`${g(e)}/${t}/authTokens:generate`}(e,n),i=_(e,n),s=t.getImmediate({optional:!0});s&&i.append("x-firebase-client",s.getPlatformInfoString());const o={installation:{sdkVersion:l}},a={method:"POST",headers:i,body:JSON.stringify(o)},c=await b((()=>fetch(r,a)));if(c.ok){return y(await c.json())}throw await v("Generate Auth Token",c)}async function z(e,t=!1){let n;const r=await U(e.appConfig,(r=>{if(!H(r))throw p.create("not-registered");const i=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){const t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+d}(e)}(i))return r;if(1===i.requestStatus)return n=async function(e,t){let n=await G(e.appConfig);for(;1===n.authToken.requestStatus;)await I(100),n=await G(e.appConfig);const r=n.authToken;return 0===r.requestStatus?z(e,t):r}(e,t),r;{if(!navigator.onLine)throw p.create("app-offline");const t=function(e){const t={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},e),{authToken:t})}(r);return n=async function(e,t){try{const n=await q(e,t),r=Object.assign(Object.assign({},t),{authToken:n});return await L(e.appConfig,r),n}catch(n){if(!m(n)||401!==n.customData.serverCode&&404!==n.customData.serverCode){const n=Object.assign(Object.assign({},t),{authToken:{requestStatus:0}});await L(e.appConfig,n)}else await M(e.appConfig);throw n}}(e,t),t}}));return n?await n:r.authToken}function G(e){return U(e,(e=>{if(!H(e))throw p.create("not-registered");const t=e.authToken;return 1===(n=t).requestStatus&&n.requestTime+u<Date.now()?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e;var n}))}function H(e){return void 0!==e&&2===e.registrationStatus}async function $(e,t=!1){const n=e;await async function(e){const{registrationPromise:t}=await F(e);t&&await t}(n.appConfig);return(await z(n,t)).token}function K(e){return p.create("missing-app-config-values",{valueName:e})}const W="installations",Y=e=>{const t=e.getProvider("app").getImmediate(),n=function(e){if(!e||!e.options)throw K("App Configuration");if(!e.name)throw K("App Name");const t=["projectId","apiKey","appId"];for(const n of t)if(!e.options[n])throw K(n);return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t);return{app:t,appConfig:n,platformLoggerProvider:(0,r._getProvider)(t,"platform-logger"),_delete:()=>Promise.resolve()}},Q=e=>{const t=e.getProvider("app").getImmediate(),n=(0,r._getProvider)(t,W).getImmediate();return{getId:()=>async function(e){const t=e,{installationEntry:n,registrationPromise:r}=await F(t.appConfig);return r?r.catch(console.error):z(t).catch(console.error),n.fid}(n),getToken:e=>$(n,e)}};(0,r._registerComponent)(new o.wA(W,Y,"PUBLIC")),(0,r._registerComponent)(new o.wA("installations-internal",Q,"PRIVATE")),(0,r.registerVersion)("@firebase/installations",c);const J="analytics",X="https://www.googletagmanager.com/gtag/js",Z=new i.Yd("@firebase/analytics");function ee(e){return Promise.all(e.map((e=>e.catch((e=>e)))))}function te(e,t,n,r){return async function(i,s,o){try{"event"===i?await async function(e,t,n,r,i){try{let s=[];if(i&&i.send_to){let e=i.send_to;Array.isArray(e)||(e=[e]);const r=await ee(n);for(const n of e){const e=r.find((e=>e.measurementId===n)),i=e&&t[e.appId];if(!i){s=[];break}s.push(i)}}0===s.length&&(s=Object.values(t)),await Promise.all(s),e("event",r,i||{})}catch(e){Z.error(e)}}(e,t,n,s,o):"config"===i?await async function(e,t,n,r,i,s){const o=r[i];try{if(o)await t[o];else{const e=(await ee(n)).find((e=>e.measurementId===i));e&&await t[e.appId]}}catch(e){Z.error(e)}e("config",i,s)}(e,t,n,r,s,o):e("set",s)}catch(e){Z.error(e)}}}const ne={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-intialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.'},re=new s.LL("analytics","Analytics",ne);const ie=new class{constructor(e={},t=1e3){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}};function se(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}async function oe(e,t=ie,n){const{appId:r,apiKey:i,measurementId:s}=e.options;if(!r)throw re.create("no-app-id");if(!i){if(s)return{measurementId:s,appId:r};throw re.create("no-api-key")}const o=t.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},a=new ce;return setTimeout((async()=>{a.abort()}),void 0!==n?n:6e4),ae({appId:r,apiKey:i,measurementId:s},o,a,t)}async function ae(e,{throttleEndTimeMillis:t,backoffCount:n},r,i=ie){const{appId:o,measurementId:a}=e;try{await function(e,t){return new Promise(((n,r)=>{const i=Math.max(t-Date.now(),0),s=setTimeout(n,i);e.addEventListener((()=>{clearTimeout(s),r(re.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}(r,t)}catch(e){if(a)return Z.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${e.message}]`),{appId:o,measurementId:a};throw e}try{const t=await async function(e){var t;const{appId:n,apiKey:r}=e,i={method:"GET",headers:se(r)},s="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),o=await fetch(s,i);if(200!==o.status&&304!==o.status){let e="";try{const n=await o.json();(null===(t=n.error)||void 0===t?void 0:t.message)&&(e=n.error.message)}catch(e){}throw re.create("config-fetch-failed",{httpStatus:o.status,responseMessage:e})}return o.json()}(e);return i.deleteThrottleMetadata(o),t}catch(t){if(!function(e){if(!(e instanceof s.ZR&&e.customData))return!1;const t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(t)){if(i.deleteThrottleMetadata(o),a)return Z.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${a} provided in the "measurementId" field in the local Firebase config. [${t.message}]`),{appId:o,measurementId:a};throw t}const c=503===Number(t.customData.httpStatus)?(0,s.$s)(n,i.intervalMillis,30):(0,s.$s)(n,i.intervalMillis),u={throttleEndTimeMillis:Date.now()+c,backoffCount:n+1};return i.setThrottleMetadata(o,u),Z.debug(`Calling attemptFetch again in ${c} millis`),ae(e,u,r,i)}}class ce{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach((e=>e()))}}async function ue(e,t,n,r,i,o,a){var c;const u=oe(e);u.then((t=>{n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&Z.warn(`The measurement ID in the local Firebase config (${e.options.measurementId}) does not match the measurement ID fetched from the server (${t.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)})).catch((e=>Z.error(e))),t.push(u);const l=async function(){if(!(0,s.hl)())return Z.warn(re.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;try{await(0,s.eu)()}catch(e){return Z.warn(re.create("indexeddb-unavailable",{errorInfo:e}).message),!1}return!0}().then((e=>e?r.getId():void 0)),[h,d]=await Promise.all([u,l]);(function(){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(X))return t;return null})()||function(e,t){const n=document.createElement("script");n.src=`${X}?l=${e}&id=${t}`,n.async=!0,document.head.appendChild(n)}(o,h.measurementId),i("js",new Date);const f=null!==(c=null==a?void 0:a.config)&&void 0!==c?c:{};return f.origin="firebase",f.update=!0,null!=d&&(f.firebase_id=d),i("config",h.measurementId,f),h.measurementId}class le{constructor(e){this.app=e}_delete(){return delete he[this.app.options.appId],Promise.resolve()}}let he={},de=[];const fe={};let pe,me,ge="dataLayer",ye="gtag",ve=!1;function we(e){if(ve)throw re.create("already-initialized");e.dataLayerName&&(ge=e.dataLayerName),e.gtagName&&(ye=e.gtagName)}function _e(e,t,n){!function(){const e=[];if((0,s.ru)()&&e.push("This is a browser extension environment."),(0,s.zI)()||e.push("Cookies are not available."),e.length>0){const t=e.map(((e,t)=>`(${t+1}) ${e}`)).join(" "),n=re.create("invalid-analytics-context",{errorInfo:t});Z.warn(n.message)}}();const r=e.options.appId;if(!r)throw re.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw re.create("no-api-key");Z.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${e.options.measurementId} provided in the "measurementId" field in the local Firebase config.`)}if(null!=he[r])throw re.create("already-exists",{id:r});if(!ve){!function(e){let t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(ge);const{wrappedGtag:e,gtagCore:t}=function(e,t,n,r,i){let s=function(...e){window[r].push(arguments)};return window[i]&&"function"==typeof window[i]&&(s=window[i]),window[i]=te(s,e,t,n),{gtagCore:s,wrappedGtag:window[i]}}(he,de,fe,ge,ye);me=e,pe=t,ve=!0}he[r]=ue(e,de,fe,t,pe,ge,n);return new le(e)}function be(e=(0,r.getApp)()){e=(0,s.m9)(e);const t=(0,r._getProvider)(e,J);return t.isInitialized()?t.getImmediate():Ie(e)}function Ie(e,t={}){const n=(0,r._getProvider)(e,J);if(n.isInitialized()){const e=n.getImmediate();if((0,s.vZ)(t,n.getOptions()))return e;throw re.create("already-initialized")}return n.initialize({options:t})}async function Ee(){if((0,s.ru)())return!1;if(!(0,s.zI)())return!1;if(!(0,s.hl)())return!1;try{return await(0,s.eu)()}catch(e){return!1}}function Te(e,t,n){e=(0,s.m9)(e),async function(e,t,n,r){if(r&&r.global)return e("set",{screen_name:n}),Promise.resolve();e("config",await t,{update:!0,screen_name:n})}(me,he[e.app.options.appId],t,n).catch((e=>Z.error(e)))}function Se(e,t,n){e=(0,s.m9)(e),async function(e,t,n,r){if(r&&r.global)return e("set",{user_id:n}),Promise.resolve();e("config",await t,{update:!0,user_id:n})}(me,he[e.app.options.appId],t,n).catch((e=>Z.error(e)))}function Ae(e,t,n){e=(0,s.m9)(e),async function(e,t,n,r){if(r&&r.global){const t={};for(const e of Object.keys(n))t[`user_properties.${e}`]=n[e];return e("set",t),Promise.resolve()}e("config",await t,{update:!0,user_properties:n})}(me,he[e.app.options.appId],t,n).catch((e=>Z.error(e)))}function ke(e,t){e=(0,s.m9)(e),async function(e,t){const n=await e;window[`ga-disable-${n}`]=!t}(he[e.app.options.appId],t).catch((e=>Z.error(e)))}function Ne(e,t,n,r){e=(0,s.m9)(e),async function(e,t,n,r,i){if(i&&i.global)e("event",n,r);else{const i=await t;e("event",n,Object.assign(Object.assign({},r),{send_to:i}))}}(me,he[e.app.options.appId],t,n,r).catch((e=>Z.error(e)))}(0,r._registerComponent)(new o.wA(J,((e,{options:t})=>_e(e.getProvider("app").getImmediate(),e.getProvider("installations-internal").getImmediate(),t)),"PUBLIC")),(0,r._registerComponent)(new o.wA("analytics-internal",(function(e){try{const t=e.getProvider(J).getImmediate();return{logEvent:(e,n,r)=>Ne(t,e,n,r)}}catch(e){throw re.create("interop-component-reg-failed",{reason:e})}}),"PRIVATE")),(0,r.registerVersion)("@firebase/analytics","0.7.1")},1369:(e,t,n)=>{"use strict";n.r(t),n.d(t,{ActionCodeOperation:()=>r.A,ActionCodeURL:()=>r.ac,AuthCredential:()=>r.G,AuthErrorCodes:()=>r.C,EmailAuthCredential:()=>r.H,EmailAuthProvider:()=>r.L,FacebookAuthProvider:()=>r.M,FactorId:()=>r.F,GithubAuthProvider:()=>r.Q,GoogleAuthProvider:()=>r.N,OAuthCredential:()=>r.I,OAuthProvider:()=>r.T,OperationType:()=>r.O,PhoneAuthCredential:()=>r.J,PhoneAuthProvider:()=>r.P,PhoneMultiFactorGenerator:()=>r.m,ProviderId:()=>r.o,RecaptchaVerifier:()=>r.R,SAMLAuthProvider:()=>r.U,SignInMethod:()=>r.S,TwitterAuthProvider:()=>r.V,applyActionCode:()=>r.a1,browserLocalPersistence:()=>r.b,browserPopupRedirectResolver:()=>r.k,browserSessionPersistence:()=>r.a,checkActionCode:()=>r.a2,confirmPasswordReset:()=>r.a0,connectAuthEmulator:()=>r.E,createUserWithEmailAndPassword:()=>r.a4,debugErrorMap:()=>r.z,deleteUser:()=>r.y,fetchSignInMethodsForEmail:()=>r.a9,getAdditionalUserInfo:()=>r.ak,getAuth:()=>r.n,getIdToken:()=>r.ah,getIdTokenResult:()=>r.ai,getMultiFactorResolver:()=>r.am,getRedirectResult:()=>r.j,inMemoryPersistence:()=>r.K,indexedDBLocalPersistence:()=>r.i,initializeAuth:()=>r.D,isSignInWithEmailLink:()=>r.a7,linkWithCredential:()=>r.Y,linkWithPhoneNumber:()=>r.l,linkWithPopup:()=>r.d,linkWithRedirect:()=>r.g,multiFactor:()=>r.an,onAuthStateChanged:()=>r.t,onIdTokenChanged:()=>r.q,parseActionCodeURL:()=>r.ad,prodErrorMap:()=>r.B,reauthenticateWithCredential:()=>r.Z,reauthenticateWithPhoneNumber:()=>r.r,reauthenticateWithPopup:()=>r.e,reauthenticateWithRedirect:()=>r.h,reload:()=>r.al,sendEmailVerification:()=>r.aa,sendPasswordResetEmail:()=>r.$,sendSignInLinkToEmail:()=>r.a6,setPersistence:()=>r.p,signInAnonymously:()=>r.W,signInWithCredential:()=>r.X,signInWithCustomToken:()=>r._,signInWithEmailAndPassword:()=>r.a5,signInWithEmailLink:()=>r.a8,signInWithPhoneNumber:()=>r.s,signInWithPopup:()=>r.c,signInWithRedirect:()=>r.f,signOut:()=>r.x,unlink:()=>r.aj,updateCurrentUser:()=>r.w,updateEmail:()=>r.af,updatePassword:()=>r.ag,updatePhoneNumber:()=>r.u,updateProfile:()=>r.ae,useDeviceLanguage:()=>r.v,verifyBeforeUpdateEmail:()=>r.ab,verifyPasswordResetCode:()=>r.a3});var r=n(4128);n(4444),n(4258),n(6934),n(909)},1902:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r.Z});var r=n(7238);r.Z.registerVersion("firebase","9.1.1","app-compat")},9477:(e,t,n)=>{"use strict";n.r(t);var r=n(7238),i=n(4128),s=n(4444),o=(n(4258),n(6934),n(909));function a(){return window}async function c(e,t,n){var r;const{BuildInfo:s}=a();(0,i.ap)(t.sessionId,"AuthEvent did not contain a session ID");const o=await async function(e){const t=function(e){if((0,i.ap)(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),c={};return(0,i.aq)()?c.ibi=s.packageName:(0,i.ar)()?c.apn=s.packageName:(0,i.as)(e,"operation-not-supported-in-this-environment"),s.displayName&&(c.appDisplayName=s.displayName),c.sessionId=o,(0,i.at)(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,c)}class u extends i.az{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}async function l(e){const t=await f()._get(p(e));return t&&await f()._remove(p(e)),t}function h(e,t){var n,r;const s=function(e){const t=m(e),n=t.link?decodeURIComponent(t.link):void 0,r=m(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return m(i).link||i||r||n||e}(t);if(s.includes("/__/auth/callback")){const t=m(s),o=t.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(t.firebaseError)):null,a=null===(r=null===(n=null==o?void 0:o.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],c=a?(0,i.av)(a):null;return c?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:c,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:s,postBody:null}}return null}function d(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){const n=Math.floor(Math.random()*t.length);e.push(t.charAt(n))}return e.join("")}function f(){return(0,i.ax)(i.b)}function p(e){return(0,i.ay)("authEvent",e.config.apiKey,e.name)}function m(e){if(!(null==e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return(0,s.zd)(n.join("?"))}const g=class{constructor(){this._redirectPersistence=i.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=i.aA}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new u(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){(0,i.as)(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,s,o,c,u,l,h,d;const f=a();(0,i.aw)("function"==typeof(null===(t=null==f?void 0:f.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,i.aw)(void 0!==(null===(n=null==f?void 0:f.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,i.aw)("function"==typeof(null===(o=null===(s=null===(r=null==f?void 0:f.cordova)||void 0===r?void 0:r.plugins)||void 0===s?void 0:s.browsertab)||void 0===o?void 0:o.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,i.aw)("function"==typeof(null===(l=null===(u=null===(c=null==f?void 0:f.cordova)||void 0===c?void 0:c.plugins)||void 0===u?void 0:u.browsertab)||void 0===l?void 0:l.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,i.aw)("function"==typeof(null===(d=null===(h=null==f?void 0:f.cordova)||void 0===h?void 0:h.InAppBrowser)||void 0===d?void 0:d.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const s=await this._initialize(e);await s.initialized(),s.resetRedirect(),(0,i.aB)(),await this._originValidation(e);const o=function(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:d(),postBody:null,tenantId:e.tenantId,error:(0,i.av)(e,"no-auth-event")}}(e,n,r);await function(e,t){return f()._set(p(e),t)}(e,o);const u=await c(e,o,t);return async function(e,t,n){const{cordova:r}=a();let s=()=>{};try{await new Promise(((o,a)=>{let c=null;function u(){var e;o();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"==typeof t&&t(),"function"==typeof(null==n?void 0:n.close)&&n.close()}function l(){c||(c=window.setTimeout((()=>{a((0,i.av)(e,"redirect-cancelled-by-user"))}),2e3))}function h(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&l()}t.addPassiveListener(u),document.addEventListener("resume",l,!1),(0,i.ar)()&&document.addEventListener("visibilitychange",h,!1),s=()=>{t.removePassiveListener(u),document.removeEventListener("resume",l,!1),document.removeEventListener("visibilitychange",h,!1),c&&window.clearTimeout(c)}}))}finally{s()}}(e,s,await function(e){const{cordova:t}=a();return new Promise((n=>{t.plugins.browsertab.isAvailable((r=>{let s=null;r?t.plugins.browsertab.openUrl(e):s=t.InAppBrowser.open(e,(0,i.ao)()?"_blank":"_system","location=yes"),n(s)}))}))}(u))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=a(),n={};(0,i.aq)()?n.iosBundleId=t.packageName:(0,i.ar)()?n.androidPackageName=t.packageName:(0,i.as)(e,"operation-not-supported-in-this-environment"),await(0,i.au)(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=a(),s=setTimeout((async()=>{await l(e),t.onEvent(y())}),500),o=async n=>{clearTimeout(s);const r=await l(e);let i=null;r&&(null==n?void 0:n.url)&&(i=h(r,n.url)),t.onEvent(i||y())};void 0!==n&&"function"==typeof n.subscribe&&n.subscribe(null,o);const c=r,u=`${i.packageName.toLowerCase()}://`;a().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(u)&&o({url:e}),"function"==typeof c)try{c(e)}catch(e){console.error(e)}}}};function y(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,i.av)("no-auth-event")}}function v(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function w(e=(0,s.z$)()){return!("file:"!==v()&&"ionic:"!==v()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function _(e=(0,s.z$)()){return(0,s.w1)()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(e=(0,s.z$)()){return/Edge\/\d+/.test(e)}(e)}function b(){try{const e=self.localStorage,t=i.aG();if(e)return e.setItem(t,"1"),e.removeItem(t),!_()||(0,s.hl)()}catch(e){return I()&&(0,s.hl)()}return!1}function I(){return void 0!==n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function E(){return("http:"===v()||"https:"===v()||(0,s.ru)()||w())&&!((0,s.b$)()||(0,s.UG)())&&b()&&!I()}function T(){return w()&&"undefined"!=typeof document}const S={LOCAL:"local",NONE:"none",SESSION:"session"},A=i.aw,k="persistence";async function N(e){await e._initializationPromise;const t=R(),n=i.ay(k,e.config.apiKey,e.name);(null==t?void 0:t.sessionStorage)&&t.sessionStorage.setItem(n,e._getPersistence())}function R(){return"undefined"!=typeof window?window:null}const C=i.aw;class O{constructor(){this.browserResolver=i.ax(i.k),this.cordovaResolver=i.ax(g),this.underlyingResolver=null,this._redirectPersistence=i.a,this._completeRedirectFn=i.aA}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return T()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return C(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!T()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),1e3);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function D(e){return e.unwrap()}function P(e){const{_tokenResponse:t}=e instanceof s.ZR?e.customData:e;if(!t)return null;if(!(e instanceof s.ZR)&&"temporaryProof"in t&&"phoneNumber"in t)return i.P.credentialFromResult(e);const n=t.providerId;if(!n||n===i.o.PASSWORD)return null;let r;switch(n){case i.o.GOOGLE:r=i.N;break;case i.o.FACEBOOK:r=i.M;break;case i.o.GITHUB:r=i.Q;break;case i.o.TWITTER:r=i.V;break;default:const{oauthIdToken:e,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:c}=t;return s||o||e||a?a?n.startsWith("saml.")?i.aJ._create(n,a):i.I._fromParams({providerId:n,signInMethod:n,pendingToken:a,idToken:e,accessToken:s}):new i.T(n).credential({idToken:e,accessToken:s,rawNonce:c}):null}return e instanceof s.ZR?r.credentialFromError(e):r.credentialFromResult(e)}async function x(e,t){let n;try{n=await t}catch(t){throw t instanceof s.ZR&&function(e,t){var n;const r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===t.code)t.resolver=new M(e,i.am(e,t));else if(r){const e=P(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}(e,t),t}const{operationType:r,user:o}=n;return{operationType:r,credential:(a=n,P(a)),additionalUserInfo:i.ak(n),user:U.getOrCreate(o)};var a}async function L(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>x(e,n.confirm(t))}}class M{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return x(D(this.auth),this.resolver.resolveSignIn(e))}}class U{constructor(e){this._delegate=e,this.multiFactor=i.an(e)}static getOrCreate(e){return U.USER_MAP.has(e)||U.USER_MAP.set(e,new U(e)),U.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return x(this.auth,i.Y(this._delegate,e))}async linkWithPhoneNumber(e,t){return L(this.auth,i.l(this._delegate,e,t))}async linkWithPopup(e){return x(this.auth,i.d(this._delegate,e,O))}async linkWithRedirect(e){return await N(i.aC(this.auth)),i.g(this._delegate,e,O)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return x(this.auth,i.Z(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return L(this.auth,i.r(this._delegate,e,t))}reauthenticateWithPopup(e){return x(this.auth,i.e(this._delegate,e,O))}async reauthenticateWithRedirect(e){return await N(i.aC(this.auth)),i.h(this._delegate,e,O)}sendEmailVerification(e){return i.aa(this._delegate,e)}async unlink(e){return await i.aj(this._delegate,e),this}updateEmail(e){return i.af(this._delegate,e)}updatePassword(e){return i.ag(this._delegate,e)}updatePhoneNumber(e){return i.u(this._delegate,e)}updateProfile(e){return i.ae(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return i.ab(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}U.USER_MAP=new WeakMap;const F=i.aw;class V{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;F(n,"invalid-api-key",{appName:e.name});let r=[i.K];if("undefined"!=typeof window){r=function(e,t){const n=R();if(!(null==n?void 0:n.sessionStorage))return[];const r=i.ay(k,e,t);switch(n.sessionStorage.getItem(r)){case S.NONE:return[i.K];case S.LOCAL:return[i.i,i.a];case S.SESSION:return[i.a];default:return[]}}(n,e.name);for(const e of[i.i,i.b,i.a])r.includes(e)||r.push(e)}F(n,"invalid-api-key",{appName:e.name});const s="undefined"!=typeof window?O:void 0;this._delegate=t.initialize({options:{persistence:r,popupRedirectResolver:s}}),this._delegate._updateErrorMap(i.z),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?U.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){i.E(this._delegate,e,t)}applyActionCode(e){return i.a1(this._delegate,e)}checkActionCode(e){return i.a2(this._delegate,e)}confirmPasswordReset(e,t){return i.a0(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return x(this._delegate,i.a4(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return i.a9(this._delegate,e)}isSignInWithEmailLink(e){return i.a7(this._delegate,e)}async getRedirectResult(){F(E(),this._delegate,"operation-not-supported-in-this-environment");const e=await i.j(this._delegate,O);return e?x(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){(0,i.aC)(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=B(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=B(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return i.a6(this._delegate,e,t)}sendPasswordResetEmail(e,t){return i.$(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){A(Object.values(S).includes(t),e,"invalid-persistence-type"),(0,s.b$)()?A(t!==S.SESSION,e,"unsupported-persistence-type"):(0,s.UG)()?A(t===S.NONE,e,"unsupported-persistence-type"):I()?A(t===S.NONE||t===S.LOCAL&&(0,s.hl)(),e,"unsupported-persistence-type"):A(t===S.NONE||b(),e,"unsupported-persistence-type")}(this._delegate,e),e){case S.SESSION:t=i.a;break;case S.LOCAL:t=await i.ax(i.i)._isAvailable()?i.i:i.b;break;case S.NONE:t=i.K;break;default:return i.as("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return x(this._delegate,i.W(this._delegate))}signInWithCredential(e){return x(this._delegate,i.X(this._delegate,e))}signInWithCustomToken(e){return x(this._delegate,i._(this._delegate,e))}signInWithEmailAndPassword(e,t){return x(this._delegate,i.a5(this._delegate,e,t))}signInWithEmailLink(e,t){return x(this._delegate,i.a8(this._delegate,e,t))}signInWithPhoneNumber(e,t){return L(this._delegate,i.s(this._delegate,e,t))}async signInWithPopup(e){return F(E(),this._delegate,"operation-not-supported-in-this-environment"),x(this._delegate,i.c(this._delegate,e,O))}async signInWithRedirect(e){return F(E(),this._delegate,"operation-not-supported-in-this-environment"),await N(this._delegate),i.f(this._delegate,e,O)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return i.a3(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function B(e,t,n){let r=e;"function"!=typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&U.getOrCreate(e)),error:t,complete:n}}V.Persistence=S;class j{constructor(){this.providerId="phone",this._delegate=new i.P(D(r.Z.auth()))}static credential(e,t){return i.P.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}j.PHONE_SIGN_IN_METHOD=i.P.PHONE_SIGN_IN_METHOD,j.PROVIDER_ID=i.P.PROVIDER_ID;const q=i.aw;class z{constructor(e,t,n=r.Z.app()){var s;q(null===(s=n.options)||void 0===s?void 0:s.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new i.R(e,t,n.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}var G;(G=r.Z).INTERNAL.registerComponent(new o.wA("auth-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new V(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:i.A.EMAIL_SIGNIN,PASSWORD_RESET:i.A.PASSWORD_RESET,RECOVER_EMAIL:i.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:i.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:i.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:i.A.VERIFY_EMAIL}},EmailAuthProvider:i.L,FacebookAuthProvider:i.M,GithubAuthProvider:i.Q,GoogleAuthProvider:i.N,OAuthProvider:i.T,PhoneAuthProvider:j,PhoneMultiFactorGenerator:i.m,RecaptchaVerifier:z,TwitterAuthProvider:i.V,Auth:V,AuthCredential:i.G,Error:s.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),G.registerVersion("@firebase/auth-compat","0.1.4")},4507:(e,t,n)=>{"use strict";n.r(t);var r,i=n(7238),s=n(4258),o=n(909),a=n(6934),c=n(4444),u="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},l={},h=h||{},d=u||self;function f(){}function p(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function m(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var g="closure_uid_"+(1e9*Math.random()>>>0),y=0;function v(e,t,n){return e.call.apply(e.bind,arguments)}function w(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function _(e,t,n){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?v:w).apply(null,arguments)}function b(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function I(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Vb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function E(){this.s=this.s,this.o=this.o}var T={};E.prototype.s=!1,E.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var e=function(e){return Object.prototype.hasOwnProperty.call(e,g)&&e[g]||(e[g]=++y)}(this);delete T[e]}},E.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const S=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},A=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){const r=e.length,i="string"==typeof e?e.split(""):e;for(let s=0;s<r;s++)s in i&&t.call(n,i[s],s,e)};function k(e){return Array.prototype.concat.apply([],arguments)}function N(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function R(e){return/^[\s\xa0]*$/.test(e)}var C,O=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function D(e,t){return-1!=e.indexOf(t)}function P(e,t){return e<t?-1:e>t?1:0}e:{var x=d.navigator;if(x){var L=x.userAgent;if(L){C=L;break e}}C=""}function M(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function U(e){const t={};for(const n in e)t[n]=e[n];return t}var F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function V(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t],r)e[n]=r[n];for(let t=0;t<F.length;t++)n=F[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function B(e){return B[" "](e),e}B[" "]=f;var j,q,z=D(C,"Opera"),G=D(C,"Trident")||D(C,"MSIE"),H=D(C,"Edge"),$=H||G,K=D(C,"Gecko")&&!(D(C.toLowerCase(),"webkit")&&!D(C,"Edge"))&&!(D(C,"Trident")||D(C,"MSIE"))&&!D(C,"Edge"),W=D(C.toLowerCase(),"webkit")&&!D(C,"Edge");function Y(){var e=d.document;return e?e.documentMode:void 0}e:{var Q="",J=(q=C,K?/rv:([^\);]+)(\)|;)/.exec(q):H?/Edge\/([\d\.]+)/.exec(q):G?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(q):W?/WebKit\/(\S+)/.exec(q):z?/(?:Version)[ \/]?(\S+)/.exec(q):void 0);if(J&&(Q=J?J[1]:""),G){var X=Y();if(null!=X&&X>parseFloat(Q)){j=String(X);break e}}j=Q}var Z,ee={};function te(){return function(e){var t=ee;return Object.prototype.hasOwnProperty.call(t,9)?t[9]:t[9]=e(9)}((function(){let e=0;const t=O(String(j)).split("."),n=O("9").split("."),r=Math.max(t.length,n.length);for(let o=0;0==e&&o<r;o++){var i=t[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;e=P(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||P(0==i[2].length,0==s[2].length)||P(i[2],s[2]),i=i[3],s=s[3]}while(0==e)}return 0<=e}))}if(d.document&&G){var ne=Y();Z=ne||(parseInt(j,10)||void 0)}else Z=void 0;var re=Z,ie=function(){if(!d.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{d.addEventListener("test",f,t),d.removeEventListener("test",f,t)}catch(e){}return e}();function se(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}function oe(e,t){if(se.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(K){e:{try{B(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:ae[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&oe.Z.h.call(this)}}se.prototype.h=function(){this.defaultPrevented=!0},I(oe,se);var ae={2:"touch",3:"pen",4:"mouse"};oe.prototype.h=function(){oe.Z.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),ue=0;function le(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ia=i,this.key=++ue,this.ca=this.fa=!1}function he(e){e.ca=!0,e.listener=null,e.proxy=null,e.src=null,e.ia=null}function de(e){this.src=e,this.g={},this.h=0}function fe(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=S(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(he(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function pe(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.ca&&s.listener==t&&s.capture==!!n&&s.ia==r)return i}return-1}de.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=pe(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new le(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var me="closure_lm_"+(1e6*Math.random()|0),ge={};function ye(e,t,n,r,i){if(r&&r.once)return we(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)ye(e,t[s],n,r,i);return null}return n=Ae(n),e&&e[ce]?e.N(t,n,m(r)?!!r.capture:!!r,i):ve(e,t,n,!1,r,i)}function ve(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=m(i)?!!i.capture:!!i,a=Te(e);if(a||(e[me]=a=new de(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}var t=Ee;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)ie||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Ie(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function we(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)we(e,t[s],n,r,i);return null}return n=Ae(n),e&&e[ce]?e.O(t,n,m(r)?!!r.capture:!!r,i):ve(e,t,n,!0,r,i)}function _e(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)_e(e,t[s],n,r,i);else r=m(r)?!!r.capture:!!r,n=Ae(n),e&&e[ce]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=pe(s=e.g[t],n,r,i))&&(he(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Te(e))&&(t=e.g[t.toString()],e=-1,t&&(e=pe(t,n,r,i)),(n=-1<e?t[e]:null)&&be(n))}function be(e){if("number"!=typeof e&&e&&!e.ca){var t=e.src;if(t&&t[ce])fe(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Ie(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Te(t))?(fe(n,e),0==n.h&&(n.src=null,t[me]=null)):he(e)}}}function Ie(e){return e in ge?ge[e]:ge[e]="on"+e}function Ee(e,t){if(e.ca)e=!0;else{t=new oe(t,this);var n=e.listener,r=e.ia||e.src;e.fa&&be(e),e=n.call(r,t)}return e}function Te(e){return(e=e[me])instanceof de?e:null}var Se="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ae(e){return"function"==typeof e?e:(e[Se]||(e[Se]=function(t){return e.handleEvent(t)}),e[Se])}function ke(){E.call(this),this.i=new de(this),this.P=this,this.I=null}function Ne(e,t){var n,r=e.I;if(r)for(n=[];r;r=r.I)n.push(r);if(e=e.P,r=t.type||t,"string"==typeof t)t=new se(t,e);else if(t instanceof se)t.target=t.target||e;else{var i=t;V(t=new se(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=Re(o,r,!0,t)&&i}if(i=Re(o=t.g=e,r,!0,t)&&i,i=Re(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=Re(o=t.g=n[s],r,!1,t)&&i}function Re(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.ca&&o.capture==n){var a=o.listener,c=o.ia||o.src;o.fa&&fe(e.i,o),i=!1!==a.call(c,r)&&i}}return i&&!r.defaultPrevented}I(ke,E),ke.prototype[ce]=!0,ke.prototype.removeEventListener=function(e,t,n,r){_e(this,e,t,n,r)},ke.prototype.M=function(){if(ke.Z.M.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)he(n[r]);delete t.g[e],t.h--}}this.I=null},ke.prototype.N=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ke.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var Ce=d.JSON.stringify;function Oe(){var e=Fe;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var De,Pe=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new xe),(e=>e.reset()));class xe{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function Le(e){d.setTimeout((()=>{throw e}),0)}function Me(e,t){De||function(){var e=d.Promise.resolve(void 0);De=function(){e.then(Ve)}}(),Ue||(De(),Ue=!0),Fe.add(e,t)}var Ue=!1,Fe=new class{constructor(){this.h=this.g=null}add(e,t){const n=Pe.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function Ve(){for(var e;e=Oe();){try{e.h.call(e.g)}catch(e){Le(e)}var t=Pe;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}Ue=!1}function Be(e,t){ke.call(this),this.h=e||1,this.g=t||d,this.j=_(this.kb,this),this.l=Date.now()}function je(e){e.da=!1,e.S&&(e.g.clearTimeout(e.S),e.S=null)}function qe(e,t,n){if("function"==typeof e)n&&(e=_(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=_(e.handleEvent,e)}return 2147483647<Number(t)?-1:d.setTimeout(e,t||0)}function ze(e){e.g=qe((()=>{e.g=null,e.i&&(e.i=!1,ze(e))}),e.j);const t=e.h;e.h=null,e.m.apply(null,t)}I(Be,ke),(r=Be.prototype).da=!1,r.S=null,r.kb=function(){if(this.da){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-e):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Ne(this,"tick"),this.da&&(je(this),this.start()))}},r.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},r.M=function(){Be.Z.M.call(this),je(this),delete this.g};class Ge extends E{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:ze(this)}M(){super.M(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function He(e){E.call(this),this.h=e,this.g={}}I(He,E);var $e=[];function Ke(e,t,n,r){Array.isArray(n)||(n&&($e[0]=n.toString()),n=$e);for(var i=0;i<n.length;i++){var s=ye(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function We(e){M(e.g,(function(e,t){this.g.hasOwnProperty(t)&&be(e)}),e),e.g={}}function Ye(){this.g=!0}function Qe(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return Ce(n)}catch(e){return t}}(e,n)+(r?" "+r:"")}))}He.prototype.M=function(){He.Z.M.call(this),We(this)},He.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ye.prototype.Aa=function(){this.g=!1},Ye.prototype.info=function(){};var Je={},Xe=null;function Ze(){return Xe=Xe||new ke}function et(e){se.call(this,Je.Ma,e)}function tt(e){const t=Ze();Ne(t,new et(t,e))}function nt(e,t){se.call(this,Je.STAT_EVENT,e),this.stat=t}function rt(e){const t=Ze();Ne(t,new nt(t,e))}function it(e,t){se.call(this,Je.Na,e),this.size=t}function st(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return d.setTimeout((function(){e()}),t)}Je.Ma="serverreachability",I(et,se),Je.STAT_EVENT="statevent",I(nt,se),Je.Na="timingevent",I(it,se);var ot={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},at={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function ct(){}function ut(e){return e.h||(e.h=e.i())}function lt(){}ct.prototype.h=null;var ht,dt={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function ft(){se.call(this,"d")}function pt(){se.call(this,"c")}function mt(){}function gt(e,t,n,r){this.l=e,this.j=t,this.m=n,this.X=r||1,this.V=new He(this),this.P=vt,e=$?125:void 0,this.W=new Be(e),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new yt}function yt(){this.i=null,this.g="",this.h=!1}I(ft,se),I(pt,se),I(mt,ct),mt.prototype.g=function(){return new XMLHttpRequest},mt.prototype.i=function(){return{}},ht=new mt;var vt=45e3,wt={},_t={};function bt(e,t,n){e.K=1,e.v=Gt(Ft(t)),e.s=n,e.U=!0,It(e,null)}function It(e,t){e.F=Date.now(),At(e),e.A=Ft(e.v);var n=e.A,r=e.X;Array.isArray(r)||(r=[String(r)]),rn(n.h,"t",r),e.C=0,n=e.l.H,e.h=new yt,e.g=ir(e.l,n?t:null,!e.s),0<e.O&&(e.L=new Ge(_(e.Ia,e,e.g),e.O)),Ke(e.V,e.g,"readystatechange",e.gb),t=e.H?U(e.H):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.s,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),tt(1),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),c=0;c<a.length;c++){var u=a[c].split("=");if(1<u.length){var l=u[0];u=u[1];var h=l.split("_");o=2<=h.length&&"type"==h[1]?o+(l+"=")+u+"&":o+(l+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.j,e.u,e.A,e.m,e.X,e.s)}function Et(e){return!!e.g&&("GET"==e.u&&2!=e.K&&e.l.Ba)}function Tt(e,t,n){let r,i=!0;for(;!e.I&&e.C<n.length;){if(r=St(e,n),r==_t){4==t&&(e.o=4,rt(14),i=!1),Qe(e.j,e.m,null,"[Incomplete Response]");break}if(r==wt){e.o=4,rt(15),Qe(e.j,e.m,n,"[Invalid Chunk]"),i=!1;break}Qe(e.j,e.m,r,null),Ot(e,r)}Et(e)&&r!=_t&&r!=wt&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,rt(16),i=!1),e.i=e.i&&i,i?0<n.length&&!e.aa&&(e.aa=!0,(t=e.l).g==e&&t.$&&!t.L&&(t.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Qn(t),t.L=!0,rt(11))):(Qe(e.j,e.m,n,"[Invalid Chunked Response]"),Ct(e),Rt(e))}function St(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?_t:(n=Number(t.substring(n,r)),isNaN(n)?wt:(r+=1)+n>t.length?_t:(t=t.substr(r,n),e.C=r+n,t))}function At(e){e.Y=Date.now()+e.P,kt(e,e.P)}function kt(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=st(_(e.eb,e),t)}function Nt(e){e.B&&(d.clearTimeout(e.B),e.B=null)}function Rt(e){0==e.l.G||e.I||Zn(e.l,e)}function Ct(e){Nt(e);var t=e.L;t&&"function"==typeof t.na&&t.na(),e.L=null,je(e.W),We(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.na())}function Ot(e,t){try{var n=e.l;if(0!=n.G&&(n.g==e||ln(n.i,e)))if(n.I=e.N,!e.J&&ln(n.i,e)&&3==n.G){try{var r=n.Ca.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;Xn(n),jn(n)}Yn(n),rt(18)}}else n.ta=i[1],0<n.ta-n.U&&37500>i[2]&&n.N&&0==n.A&&!n.v&&(n.v=st(_(n.ab,n),6e3));if(1>=un(n.i)&&n.ka){try{n.ka()}catch(e){}n.ka=void 0}}else tr(n,11)}else if((e.J||n.g==e)&&Xn(n),!R(t))for(i=n.Ca.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.U=u[0],u=u[1],2==n.G)if("c"==u[0]){n.J=u[1],n.la=u[2];const t=u[3];null!=t&&(n.ma=t,n.h.info("VER="+n.ma));const i=u[4];null!=i&&(n.za=i,n.h.info("SVER="+n.za));const l=u[5];null!=l&&"number"==typeof l&&0<l&&(r=1.5*l,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.i;!s.g&&(D(e,"spdy")||D(e,"quic")||D(e,"h2"))&&(s.j=s.l,s.g=new Set,s.h&&(hn(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.sa=e,zt(r.F,r.D,e))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-e.F,n.h.info("Handshake RTT: "+n.O+"ms"));var o=e;if((r=n).oa=rr(r,r.H?r.la:null,r.W),o.J){dn(r.i,o);var a=o,c=r.K;c&&a.setTimeout(c),a.B&&(Nt(a),At(a)),r.g=o}else Wn(r);0<n.l.length&&Gn(n)}else"stop"!=u[0]&&"close"!=u[0]||tr(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?tr(n,7):Bn(n):"noop"!=u[0]&&n.j&&n.j.wa(u),n.A=0)}tt(4)}catch(e){}}function Dt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(p(e)||"string"==typeof e)A(e,t,void 0);else{if(e.T&&"function"==typeof e.T)var n=e.T();else if(e.R&&"function"==typeof e.R)n=void 0;else if(p(e)||"string"==typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;r=function(e){if(e.R&&"function"==typeof e.R)return e.R();if("string"==typeof e)return e.split("");if(p(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length;for(var s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}}function Pt(e,t){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Pt)for(n=e.T(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function xt(e){if(e.i!=e.g.length){for(var t=0,n=0;t<e.g.length;){var r=e.g[t];Lt(e.h,r)&&(e.g[n++]=r),t++}e.g.length=n}if(e.i!=e.g.length){var i={};for(n=t=0;t<e.g.length;)Lt(i,r=e.g[t])||(e.g[n++]=r,i[r]=1),t++;e.g.length=n}}function Lt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(r=gt.prototype).setTimeout=function(e){this.P=e},r.gb=function(e){e=e.target;const t=this.L;t&&3==Ln(e)?t.l():this.Ia(e)},r.Ia=function(e){try{if(e==this.g)e:{const l=Ln(this.g);var t=this.g.Da();const h=this.g.ba();if(!(3>l)&&(3!=l||$||this.g&&(this.h.h||this.g.ga()||Mn(this.g)))){this.I||4!=l||7==t||tt(8==t||0>=h?3:2),Nt(this);var n=this.g.ba();this.N=n;t:if(Et(this)){var r=Mn(this.g);e="";var i=r.length,s=4==Ln(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ct(this),Rt(this);var o="";break t}this.h.i=new d.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ga();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.j,this.u,this.A,this.m,this.X,l,n),this.i){if(this.$&&!this.J){t:{if(this.g){var a,c=this.g;if((a=c.g?c.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(a)){var u=a;break t}}u=null}if(!(n=u)){this.i=!1,this.o=3,rt(12),Ct(this),Rt(this);break e}Qe(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Ot(this,n)}this.U?(Tt(this,l,o),$&&this.i&&3==l&&(Ke(this.V,this.W,"tick",this.fb),this.W.start())):(Qe(this.j,this.m,o,null),Ot(this,o)),4==l&&Ct(this),this.i&&!this.I&&(4==l?Zn(this.l,this):(this.i=!1,At(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,rt(12)):(this.o=0,rt(13)),Ct(this),Rt(this)}}}catch(e){}},r.fb=function(){if(this.g){var e=Ln(this.g),t=this.g.ga();this.C<t.length&&(Nt(this),Tt(this,e,t),this.i&&4!=e&&At(this))}},r.cancel=function(){this.I=!0,Ct(this)},r.eb=function(){this.B=null;const e=Date.now();0<=e-this.Y?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.j,this.A),2!=this.K&&(tt(3),rt(17)),Ct(this),this.o=2,Rt(this)):kt(this,this.Y-e)},(r=Pt.prototype).R=function(){xt(this);for(var e=[],t=0;t<this.g.length;t++)e.push(this.h[this.g[t]]);return e},r.T=function(){return xt(this),this.g.concat()},r.get=function(e,t){return Lt(this.h,e)?this.h[e]:t},r.set=function(e,t){Lt(this.h,e)||(this.i++,this.g.push(e)),this.h[e]=t},r.forEach=function(e,t){for(var n=this.T(),r=0;r<n.length;r++){var i=n[r],s=this.get(i);e.call(t,s,i,this)}};var Mt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ut(e,t){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,e instanceof Ut){this.g=void 0!==t?t:e.g,Vt(this,e.j),this.s=e.s,Bt(this,e.i),jt(this,e.m),this.l=e.l,t=e.h;var n=new Zt;n.i=t.i,t.g&&(n.g=new Pt(t.g),n.h=t.h),qt(this,n),this.o=e.o}else e&&(n=String(e).match(Mt))?(this.g=!!t,Vt(this,n[1]||"",!0),this.s=Ht(n[2]||""),Bt(this,n[3]||"",!0),jt(this,n[4]),this.l=Ht(n[5]||"",!0),qt(this,n[6]||"",!0),this.o=Ht(n[7]||"")):(this.g=!!t,this.h=new Zt(null,this.g))}function Ft(e){return new Ut(e)}function Vt(e,t,n){e.j=n?Ht(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function Bt(e,t,n){e.i=n?Ht(t,!0):t}function jt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function qt(e,t,n){t instanceof Zt?(e.h=t,function(e,t){t&&!e.j&&(en(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(tn(this,t),rn(this,n,e))}),e)),e.j=t}(e.h,e.g)):(n||(t=$t(t,Jt)),e.h=new Zt(t,e.g))}function zt(e,t,n){e.h.set(t,n)}function Gt(e){return zt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function Ht(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function $t(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,Kt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Kt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ut.prototype.toString=function(){var e=[],t=this.j;t&&e.push($t(t,Wt,!0),":");var n=this.i;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push($t(t,Wt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.i&&"/"!=n.charAt(0)&&e.push("/"),e.push($t(n,"/"==n.charAt(0)?Qt:Yt,!0))),(n=this.h.toString())&&e.push("?",n),(n=this.o)&&e.push("#",$t(n,Xt)),e.join("")};var Wt=/[#\/\?@]/g,Yt=/[#\?:]/g,Qt=/[#\?]/g,Jt=/[#\?@]/g,Xt=/#/g;function Zt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function en(e){e.g||(e.g=new Pt,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function tn(e,t){en(e),t=sn(e,t),Lt(e.g.h,t)&&(e.i=null,e.h-=e.g.get(t).length,Lt((e=e.g).h,t)&&(delete e.h[t],e.i--,e.g.length>2*e.i&&xt(e)))}function nn(e,t){return en(e),t=sn(e,t),Lt(e.g.h,t)}function rn(e,t,n){tn(e,t),0<n.length&&(e.i=null,e.g.set(sn(e,t),N(n)),e.h+=n.length)}function sn(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(r=Zt.prototype).add=function(e,t){en(this),this.i=null,e=sn(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},r.forEach=function(e,t){en(this),this.g.forEach((function(n,r){A(n,(function(n){e.call(t,n,r,this)}),this)}),this)},r.T=function(){en(this);for(var e=this.g.R(),t=this.g.T(),n=[],r=0;r<t.length;r++)for(var i=e[r],s=0;s<i.length;s++)n.push(t[r]);return n},r.R=function(e){en(this);var t=[];if("string"==typeof e)nn(this,e)&&(t=k(t,this.g.get(sn(this,e))));else{e=this.g.R();for(var n=0;n<e.length;n++)t=k(t,e[n])}return t},r.set=function(e,t){return en(this),this.i=null,nn(this,e=sn(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},r.get=function(e,t){return e&&0<(e=this.R(e)).length?String(e[0]):t},r.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var e=[],t=this.g.T(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var o=i;""!==r[s]&&(o+="="+encodeURIComponent(String(r[s]))),e.push(o)}}return this.i=e.join("&")};function on(e){this.l=e||an,d.PerformanceNavigationTiming?e=0<(e=d.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(d.g&&d.g.Ea&&d.g.Ea()&&d.g.Ea().Zb),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var an=10;function cn(e){return!!e.h||!!e.g&&e.g.size>=e.j}function un(e){return e.h?1:e.g?e.g.size:0}function ln(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function hn(e,t){e.g?e.g.add(t):e.h=t}function dn(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function fn(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return N(e.i)}function pn(){}function mn(){this.g=new pn}function gn(e,t,n){const r=n||"";try{Dt(e,(function(e,n){let i=e;m(e)&&(i=Ce(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}function yn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function vn(e){this.l=e.$b||null,this.j=e.ib||!1}function wn(e,t){ke.call(this),this.D=e,this.u=t,this.m=void 0,this.readyState=_n,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}on.prototype.cancel=function(){if(this.i=fn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}},pn.prototype.stringify=function(e){return d.JSON.stringify(e,void 0)},pn.prototype.parse=function(e){return d.JSON.parse(e,void 0)},I(vn,ct),vn.prototype.g=function(){return new wn(this.l,this.j)},vn.prototype.i=function(e){return function(){return e}}({}),I(wn,ke);var _n=0;function bn(e){e.j.read().then(e.Sa.bind(e)).catch(e.ha.bind(e))}function In(e){e.readyState=4,e.l=null,e.j=null,e.A=null,En(e)}function En(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(r=wn.prototype).open=function(e,t){if(this.readyState!=_n)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,En(this)},r.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||d).fetch(new Request(this.B,t)).then(this.Va.bind(this),this.ha.bind(this))},r.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,In(this)),this.readyState=_n},r.Va=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,En(this)),this.g&&(this.readyState=3,En(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==d.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;bn(this)}else e.text().then(this.Ua.bind(this),this.ha.bind(this))},r.Sa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?In(this):En(this),3==this.readyState&&bn(this)}},r.Ua=function(e){this.g&&(this.response=this.responseText=e,In(this))},r.Ta=function(e){this.g&&(this.response=e,In(this))},r.ha=function(){this.g&&In(this)},r.setRequestHeader=function(e,t){this.v.append(e,t)},r.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(wn.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var Tn=d.JSON.parse;function Sn(e){ke.call(this),this.headers=new Pt,this.u=e||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=An,this.K=this.L=!1}I(Sn,ke);var An="",kn=/^https?$/i,Nn=["POST","PUT"];function Rn(e){return"content-type"==e.toLowerCase()}function Cn(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,On(e),Pn(e)}function On(e){e.D||(e.D=!0,Ne(e,"complete"),Ne(e,"error"))}function Dn(e){if(e.h&&void 0!==h&&(!e.C[1]||4!=Ln(e)||2!=e.ba()))if(e.v&&4==Ln(e))qe(e.Fa,0,e);else if(Ne(e,"readystatechange"),4==Ln(e)){e.h=!1;try{const a=e.ba();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===a){var i=String(e.H).match(Mt)[1]||null;if(!i&&d.self&&d.self.location){var s=d.self.location.protocol;i=s.substr(0,s.length-1)}r=!kn.test(i?i.toLowerCase():"")}n=r}if(n)Ne(e,"complete"),Ne(e,"success");else{e.m=6;try{var o=2<Ln(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.ba()+"]",On(e)}}finally{Pn(e)}}}function Pn(e,t){if(e.g){xn(e);const n=e.g,r=e.C[0]?f:null;e.g=null,e.C=null,t||Ne(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function xn(e){e.g&&e.K&&(e.g.ontimeout=null),e.A&&(d.clearTimeout(e.A),e.A=null)}function Ln(e){return e.g?e.g.readyState:0}function Mn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.J){case An:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function Un(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){let t="";return M(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):zt(e,t,n))}function Fn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Vn(e){this.za=0,this.l=[],this.h=new Ye,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Fn("failFast",!1,e),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Fn("baseRetryDelayMs",5e3,e),this.$a=Fn("retryDelaySeedMs",1e4,e),this.Ya=Fn("forwardChannelMaxRetries",2,e),this.ra=Fn("forwardChannelRequestTimeoutMs",2e4,e),this.qa=e&&e.xmlHttpFactory||void 0,this.Ba=e&&e.Yb||!1,this.K=void 0,this.H=e&&e.supportsCrossDomainXhr||!1,this.J="",this.i=new on(e&&e.concurrentRequestLimit),this.Ca=new mn,this.ja=e&&e.fastHandshake||!1,this.Ra=e&&e.Wb||!1,e&&e.Aa&&this.h.Aa(),e&&e.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&e&&e.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!e||!1!==e.Xb}function Bn(e){if(qn(e),3==e.G){var t=e.V++,n=Ft(e.F);zt(n,"SID",e.J),zt(n,"RID",t),zt(n,"TYPE","terminate"),$n(e,n),(t=new gt(e,e.h,t,void 0)).K=2,t.v=Gt(Ft(n)),n=!1,d.navigator&&d.navigator.sendBeacon&&(n=d.navigator.sendBeacon(t.v.toString(),"")),!n&&d.Image&&((new Image).src=t.v,n=!0),n||(t.g=ir(t.l,null),t.g.ea(t.v)),t.F=Date.now(),At(t)}nr(e)}function jn(e){e.g&&(Qn(e),e.g.cancel(),e.g=null)}function qn(e){jn(e),e.u&&(d.clearTimeout(e.u),e.u=null),Xn(e),e.i.cancel(),e.m&&("number"==typeof e.m&&d.clearTimeout(e.m),e.m=null)}function zn(e,t){e.l.push(new class{constructor(e,t){this.h=e,this.g=t}}(e.Za++,t)),3==e.G&&Gn(e)}function Gn(e){cn(e.i)||e.m||(e.m=!0,Me(e.Ha,e),e.C=0)}function Hn(e,t){var n;n=t?t.m:e.V++;const r=Ft(e.F);zt(r,"SID",e.J),zt(r,"RID",n),zt(r,"AID",e.U),$n(e,r),e.o&&e.s&&Un(r,e.o,e.s),n=new gt(e,e.h,n,e.C+1),null===e.o&&(n.H=e.s),t&&(e.l=t.D.concat(e.l)),t=Kn(e,n,1e3),n.setTimeout(Math.round(.5*e.ra)+Math.round(.5*e.ra*Math.random())),hn(e.i,n),bt(n,r,t)}function $n(e,t){e.j&&Dt({},(function(e,n){zt(t,n,e)}))}function Kn(e,t,n){n=Math.min(e.l.length,n);var r=e.j?_(e.j.Oa,e.j,e):null;e:{var i=e.l;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].h;const a=i[o].g;if(n-=t,0>n)t=Math.max(0,i[o].h-100),s=!1;else try{gn(a,e,"req"+n+"_")}catch(e){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.l.splice(0,n),t.D=e,r}function Wn(e){e.g||e.u||(e.Y=1,Me(e.Ga,e),e.A=0)}function Yn(e){return!(e.g||e.u||3<=e.A)&&(e.Y++,e.u=st(_(e.Ga,e),er(e,e.A)),e.A++,!0)}function Qn(e){null!=e.B&&(d.clearTimeout(e.B),e.B=null)}function Jn(e){e.g=new gt(e,e.h,"rpc",e.Y),null===e.o&&(e.g.H=e.s),e.g.O=0;var t=Ft(e.oa);zt(t,"RID","rpc"),zt(t,"SID",e.J),zt(t,"CI",e.N?"0":"1"),zt(t,"AID",e.U),$n(e,t),zt(t,"TYPE","xmlhttp"),e.o&&e.s&&Un(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.la,n.K=1,n.v=Gt(Ft(t)),n.s=null,n.U=!0,It(n,e)}function Xn(e){null!=e.v&&(d.clearTimeout(e.v),e.v=null)}function Zn(e,t){var n=null;if(e.g==t){Xn(e),Qn(e),e.g=null;var r=2}else{if(!ln(e.i,t))return;n=t.D,dn(e.i,t),r=1}if(e.I=t.N,0!=e.G)if(t.i)if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.F;var i=e.C;Ne(r=Ze(),new it(r,n,t,i)),Gn(e)}else Wn(e);else if(3==(i=t.o)||0==i&&0<e.I||!(1==r&&function(e,t){return!(un(e.i)>=e.i.j-(e.m?1:0)||(e.m?(e.l=t.D.concat(e.l),0):1==e.G||2==e.G||e.C>=(e.Xa?0:e.Ya)||(e.m=st(_(e.Ha,e,t),er(e,e.C)),e.C++,0)))}(e,t)||2==r&&Yn(e)))switch(n&&0<n.length&&(t=e.i,t.i=t.i.concat(n)),i){case 1:tr(e,5);break;case 4:tr(e,10);break;case 3:tr(e,6);break;default:tr(e,2)}}function er(e,t){let n=e.Pa+Math.floor(Math.random()*e.$a);return e.j||(n*=2),n*t}function tr(e,t){if(e.h.info("Error code "+t),2==t){var n=null;e.j&&(n=null);var r=_(e.jb,e);n||(n=new Ut("//www.google.com/images/cleardot.gif"),d.location&&"http"==d.location.protocol||Vt(n,"https"),Gt(n)),function(e,t){const n=new Ye;if(d.Image){const r=new Image;r.onload=b(yn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=b(yn,n,r,"TestLoadImage: error",!1,t),r.onabort=b(yn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=b(yn,n,r,"TestLoadImage: timeout",!1,t),d.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else rt(2);e.G=0,e.j&&e.j.va(t),nr(e),qn(e)}function nr(e){e.G=0,e.I=-1,e.j&&(0==fn(e.i).length&&0==e.l.length||(e.i.i.length=0,N(e.l),e.l.length=0),e.j.ua())}function rr(e,t,n){let r=function(e){return e instanceof Ut?Ft(e):new Ut(e,void 0)}(n);if(""!=r.i)t&&Bt(r,t+"."+r.i),jt(r,r.m);else{const e=d.location;r=function(e,t,n,r){var i=new Ut(null,void 0);return e&&Vt(i,e),t&&Bt(i,t),n&&jt(i,n),r&&(i.l=r),i}(e.protocol,t?t+"."+e.hostname:e.hostname,+e.port,n)}return e.aa&&M(e.aa,(function(e,t){zt(r,t,e)})),t=e.D,n=e.sa,t&&n&&zt(r,t,n),zt(r,"VER",e.ma),$n(e,r),r}function ir(e,t,n){if(t&&!e.H)throw Error("Can't create secondary domain capable XhrIo object.");return(t=n&&e.Ba&&!e.qa?new Sn(new vn({ib:!0})):new Sn(e.qa)).L=e.H,t}function sr(){}function or(){if(G&&!(10<=Number(re)))throw Error("Environmental error: no available transport.")}function ar(e,t){ke.call(this),this.g=new Vn(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.ya&&(e?e["X-WebChannel-Client-Profile"]=t.ya:e={"X-WebChannel-Client-Profile":t.ya}),this.g.P=e,(e=t&&t.httpHeadersOverwriteParam)&&!R(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!R(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new lr(this)}function cr(e){ft.call(this);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ur(){pt.call(this),this.status=1}function lr(e){this.g=e}(r=Sn.prototype).ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+e);t=t?t.toUpperCase():"GET",this.H=e,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():ht.g(),this.C=this.u?ut(this.u):ut(ht),this.g.onreadystatechange=_(this.Fa,this);try{this.F=!0,this.g.open(t,String(e),!0),this.F=!1}catch(e){return void Cn(this,e)}e=n||"";const i=new Pt(this.headers);r&&Dt(r,(function(e,t){i.set(t,e)})),r=function(e){e:{var t=Rn;const n=e.length,r="string"==typeof e?e.split(""):e;for(let i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"==typeof e?e.charAt(t):e[t]}(i.T()),n=d.FormData&&e instanceof d.FormData,!(0<=S(Nn,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.g.setRequestHeader(t,e)}),this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{xn(this),0<this.B&&((this.K=function(e){return G&&te()&&"number"==typeof e.timeout&&void 0!==e.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=_(this.pa,this)):this.A=qe(this.pa,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){Cn(this,e)}},r.pa=function(){void 0!==h&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ne(this,"timeout"),this.abort(8))},r.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,Ne(this,"complete"),Ne(this,"abort"),Pn(this))},r.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Pn(this,!0)),Sn.Z.M.call(this)},r.Fa=function(){this.s||(this.F||this.v||this.l?Dn(this):this.cb())},r.cb=function(){Dn(this)},r.ba=function(){try{return 2<Ln(this)?this.g.status:-1}catch(e){return-1}},r.ga=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},r.Qa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),Tn(t)}},r.Da=function(){return this.m},r.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(r=Vn.prototype).ma=8,r.G=1,r.hb=function(e){try{this.h.info("Origin Trials invoked: "+e)}catch(e){}},r.Ha=function(e){if(this.m)if(this.m=null,1==this.G){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new gt(this,this.h,e,void 0);let s=this.s;if(this.P&&(s?(s=U(s),V(s,this.P)):s=this.P),null===this.o&&(i.H=s),this.ja)e:{for(var t=0,n=0;n<this.l.length;n++){var r=this.l[n];if(void 0===(r="__data__"in r.g&&"string"==typeof(r=r.g.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.l.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Kn(this,i,t),zt(n=Ft(this.F),"RID",e),zt(n,"CVER",22),this.D&&zt(n,"X-HTTP-Session-Id",this.D),$n(this,n),this.o&&s&&Un(n,this.o,s),hn(this.i,i),this.Ra&&zt(n,"TYPE","init"),this.ja?(zt(n,"$req",t),zt(n,"SID","null"),i.$=!0,bt(i,n,null)):bt(i,n,t),this.G=2}}else 3==this.G&&(e?Hn(this,e):0==this.l.length||cn(this.i)||Hn(this))},r.Ga=function(){if(this.u=null,Jn(this),this.$&&!(this.L||null==this.g||0>=this.O)){var e=2*this.O;this.h.info("BP detection timer enabled: "+e),this.B=st(_(this.bb,this),e)}},r.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,rt(10),jn(this),Jn(this))},r.ab=function(){null!=this.v&&(this.v=null,jn(this),Yn(this),rt(19))},r.jb=function(e){e?(this.h.info("Successfully pinged google.com"),rt(2)):(this.h.info("Failed to ping google.com"),rt(1))},(r=sr.prototype).xa=function(){},r.wa=function(){},r.va=function(){},r.ua=function(){},r.Oa=function(){},or.prototype.g=function(e,t){return new ar(e,t)},I(ar,ke),ar.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var e=this.g,t=this.l,n=this.h||void 0;e.Wa&&(e.h.info("Origin Trials enabled."),Me(_(e.hb,e,t))),rt(0),e.W=t,e.aa=n||{},e.N=e.X,e.F=rr(e,null,e.W),Gn(e)},ar.prototype.close=function(){Bn(this.g)},ar.prototype.u=function(e){if("string"==typeof e){var t={};t.__data__=e,zn(this.g,t)}else this.v?((t={}).__data__=Ce(e),zn(this.g,t)):zn(this.g,e)},ar.prototype.M=function(){this.g.j=null,delete this.j,Bn(this.g),delete this.g,ar.Z.M.call(this)},I(cr,ft),I(ur,pt),I(lr,sr),lr.prototype.xa=function(){Ne(this.g,"a")},lr.prototype.wa=function(e){Ne(this.g,new cr(e))},lr.prototype.va=function(e){Ne(this.g,new ur(e))},lr.prototype.ua=function(){Ne(this.g,"b")},or.prototype.createWebChannel=or.prototype.g,ar.prototype.send=ar.prototype.u,ar.prototype.open=ar.prototype.m,ar.prototype.close=ar.prototype.close,ot.NO_ERROR=0,ot.TIMEOUT=8,ot.HTTP_ERROR=6,at.COMPLETE="complete",lt.EventType=dt,dt.OPEN="a",dt.CLOSE="b",dt.ERROR="c",dt.MESSAGE="d",ke.prototype.listen=ke.prototype.N,Sn.prototype.listenOnce=Sn.prototype.O,Sn.prototype.getLastError=Sn.prototype.La,Sn.prototype.getLastErrorCode=Sn.prototype.Da,Sn.prototype.getStatus=Sn.prototype.ba,Sn.prototype.getResponseJson=Sn.prototype.Qa,Sn.prototype.getResponseText=Sn.prototype.ga,Sn.prototype.send=Sn.prototype.ea;var hr=l.createWebChannelTransport=function(){return new or},dr=l.getStatEventTarget=function(){return Ze()},fr=l.ErrorCode=ot,pr=l.EventType=at,mr=l.Event=Je,gr=l.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},yr=l.FetchXmlHttpFactory=vn,vr=l.WebChannel=lt,wr=l.XhrIo=Sn;class _r{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}_r.UNAUTHENTICATED=new _r(null),_r.GOOGLE_CREDENTIALS=new _r("google-credentials-uid"),_r.FIRST_PARTY=new _r("first-party-uid"),_r.MOCK_USER=new _r("mock-user");let br="9.1.0";const Ir=new a.Yd("@firebase/firestore");function Er(){return Ir.logLevel}function Tr(e,...t){if(Ir.logLevel<=a.in.DEBUG){const n=t.map(kr);Ir.debug(`Firestore (${br}): ${e}`,...n)}}function Sr(e,...t){if(Ir.logLevel<=a.in.ERROR){const n=t.map(kr);Ir.error(`Firestore (${br}): ${e}`,...n)}}function Ar(e,...t){if(Ir.logLevel<=a.in.WARN){const n=t.map(kr);Ir.warn(`Firestore (${br}): ${e}`,...n)}}function kr(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function Nr(e="Unexpected state"){const t=`FIRESTORE (${br}) INTERNAL ASSERTION FAILED: `+e;throw Sr(t),new Error(t)}function Rr(e,t){e||Nr()}function Cr(e,t){return e}const Or={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Dr extends Error{constructor(e,t){super(t),this.code=e,this.message=t,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Pr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class xr{constructor(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${e}`}}class Lr{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(_r.UNAUTHENTICATED)))}shutdown(){}}class Mr{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class Ur{constructor(e){this.t=e,this.currentUser=_r.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new Pr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Pr,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{Tr("FirebaseCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Tr("FirebaseCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Pr)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Tr("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(Rr("string"==typeof t.accessToken),new xr(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const e=this.auth&&this.auth.getUid();return Rr(null===e||"string"==typeof e),new _r(e)}}class Fr{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=_r.FIRST_PARTY}get authHeaders(){const e={"X-Goog-AuthUser":this.l},t=this.h.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.m&&(e["X-Goog-Iam-Authorization-Token"]=this.m),e}}class Vr{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new Fr(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable((()=>t(_r.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Br{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.g(e),this.p=e=>t.writeSequenceNumber(e))}g(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.p&&this.p(e),e}}function jr(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}Br.T=-1;class qr{static I(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length;let n="";for(;n.length<20;){const r=jr(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function zr(e,t){return e<t?-1:e>t?1:0}function Gr(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function Hr(e){return e+"\0"}class $r{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Dr(Or.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Dr(Or.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new Dr(Or.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Dr(Or.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return $r.fromMillis(Date.now())}static fromDate(e){return $r.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new $r(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?zr(this.nanoseconds,e.nanoseconds):zr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Kr{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Kr(e)}static min(){return new Kr(new $r(0,0))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function Wr(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Yr(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Qr(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Jr{constructor(e,t,n){void 0===t?t=0:t>e.length&&Nr(),void 0===n?n=e.length-t:n>e.length-t&&Nr(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Jr.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Jr?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Xr extends Jr{construct(e,t,n){return new Xr(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Dr(Or.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new Xr(t)}static emptyPath(){return new Xr([])}}const Zr=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ei extends Jr{construct(e,t,n){return new ei(e,t,n)}static isValidIdentifier(e){return Zr.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ei.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new ei(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new Dr(Or.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new Dr(Or.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new Dr(Or.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new Dr(Or.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ei(t)}static emptyPath(){return new ei([])}}class ti{constructor(e){this.fields=e,e.sort(ei.comparator)}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Gr(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class ni{constructor(e){this.binaryString=e}static fromBase64String(e){const t=atob(e);return new ni(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ni(t)}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return zr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ni.EMPTY_BYTE_STRING=new ni("");const ri=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ii(e){if(Rr(!!e),"string"==typeof e){let t=0;const n=ri.exec(e);if(Rr(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:si(e.seconds),nanos:si(e.nanos)}}function si(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function oi(e){return"string"==typeof e?ni.fromBase64String(e):ni.fromUint8Array(e)}function ai(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function ci(e){const t=e.mapValue.fields.__previous_value__;return ai(t)?ci(t):t}function ui(e){const t=ii(e.mapValue.fields.__local_write_time__.timestampValue);return new $r(t.seconds,t.nanos)}function li(e){return null==e}function hi(e){return 0===e&&1/e==-1/0}function di(e){return"number"==typeof e&&Number.isInteger(e)&&!hi(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}class fi{constructor(e){this.path=e}static fromPath(e){return new fi(Xr.fromString(e))}static fromName(e){return new fi(Xr.fromString(e).popFirst(5))}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}isEqual(e){return null!==e&&0===Xr.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Xr.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new fi(new Xr(e.slice()))}}function pi(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ai(e)?4:10:Nr()}function mi(e,t){const n=pi(e);if(n!==pi(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ui(e).isEqual(ui(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=ii(e.timestampValue),r=ii(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return oi(e.bytesValue).isEqual(oi(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return si(e.geoPointValue.latitude)===si(t.geoPointValue.latitude)&&si(e.geoPointValue.longitude)===si(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return si(e.integerValue)===si(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=si(e.doubleValue),r=si(t.doubleValue);return n===r?hi(n)===hi(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Gr(e.arrayValue.values||[],t.arrayValue.values||[],mi);case 10:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Wr(n)!==Wr(r))return!1;for(const e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!mi(n[e],r[e])))return!1;return!0}(e,t);default:return Nr()}}function gi(e,t){return void 0!==(e.values||[]).find((e=>mi(e,t)))}function yi(e,t){const n=pi(e),r=pi(t);if(n!==r)return zr(n,r);switch(n){case 0:return 0;case 1:return zr(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=si(e.integerValue||e.doubleValue),r=si(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return vi(e.timestampValue,t.timestampValue);case 4:return vi(ui(e),ui(t));case 5:return zr(e.stringValue,t.stringValue);case 6:return function(e,t){const n=oi(e),r=oi(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){const t=zr(n[e],r[e]);if(0!==t)return t}return zr(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=zr(si(e.latitude),si(t.latitude));return 0!==n?n:zr(si(e.longitude),si(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){const n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){const t=yi(n[e],r[e]);if(t)return t}return zr(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){const t=zr(r[e],s[e]);if(0!==t)return t;const o=yi(n[r[e]],i[s[e]]);if(0!==o)return o}return zr(r.length,s.length)}(e.mapValue,t.mapValue);default:throw Nr()}}function vi(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return zr(e,t);const n=ii(e),r=ii(t),i=zr(n.seconds,r.seconds);return 0!==i?i:zr(n.nanos,r.nanos)}function wi(e){return _i(e)}function _i(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=ii(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?oi(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,fi.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=_i(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${_i(e.fields[i])}`;return n+"}"}(e.mapValue):Nr();var t,n}function bi(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Ii(e){return!!e&&"integerValue"in e}function Ei(e){return!!e&&"arrayValue"in e}function Ti(e){return!!e&&"nullValue"in e}function Si(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Ai(e){return!!e&&"mapValue"in e}function ki(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Yr(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=ki(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=ki(e.arrayValue.values[n]);return t}return Object.assign({},e)}class Ni{constructor(e){this.value=e}static empty(){return new Ni({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Ai(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=ki(t)}setAll(e){let t=ei.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=ki(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Ai(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return mi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Ai(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Yr(t,((t,n)=>e[t]=n));for(const t of n)delete e[t]}clone(){return new Ni(ki(this.value))}}function Ri(e){const t=[];return Yr(e.fields,((e,n)=>{const r=new ei([e]);if(Ai(n)){const e=Ri(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new ti(t)}class Ci{constructor(e,t,n,r,i){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=i}static newInvalidDocument(e){return new Ci(e,0,Kr.min(),Ni.empty(),0)}static newFoundDocument(e,t,n){return new Ci(e,1,t,n,0)}static newNoDocument(e,t){return new Ci(e,2,t,Ni.empty(),0)}static newUnknownDocument(e,t){return new Ci(e,3,t,Ni.empty(),2)}convertToFoundDocument(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ni.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ni.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ci&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}clone(){return new Ci(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Oi{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.A=null}}function Di(e,t=null,n=[],r=[],i=null,s=null,o=null){return new Oi(e,t,n,r,i,s,o)}function Pi(e){const t=Cr(e);if(null===t.A){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>function(e){return e.field.canonicalString()+e.op.toString()+wi(e.value)}(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),li(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=$i(t.startAt)),t.endAt&&(e+="|ub:",e+=$i(t.endAt)),t.A=e}return t.A}function xi(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Wi(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let i=0;i<e.filters.length;i++)if(n=e.filters[i],r=t.filters[i],n.op!==r.op||!n.field.isEqual(r.field)||!mi(n.value,r.value))return!1;var n,r;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Qi(e.startAt,t.startAt)&&Qi(e.endAt,t.endAt)}function Li(e){return fi.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Mi extends class{}{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.R(e,t,n):new Ui(e,t,n):"array-contains"===t?new ji(e,n):"in"===t?new qi(e,n):"not-in"===t?new zi(e,n):"array-contains-any"===t?new Gi(e,n):new Mi(e,t,n)}static R(e,t,n){return"in"===t?new Fi(e,n):new Vi(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.P(yi(t,this.value)):null!==t&&pi(this.value)===pi(t)&&this.P(yi(t,this.value))}P(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Nr()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Ui extends Mi{constructor(e,t,n){super(e,t,n),this.key=fi.fromName(n.referenceValue)}matches(e){const t=fi.comparator(e.key,this.key);return this.P(t)}}class Fi extends Mi{constructor(e,t){super(e,"in",t),this.keys=Bi("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Vi extends Mi{constructor(e,t){super(e,"not-in",t),this.keys=Bi("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Bi(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>fi.fromName(e.referenceValue)))}class ji extends Mi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ei(t)&&gi(t.arrayValue,this.value)}}class qi extends Mi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&gi(this.value.arrayValue,t)}}class zi extends Mi{constructor(e,t){super(e,"not-in",t)}matches(e){if(gi(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!gi(this.value.arrayValue,t)}}class Gi extends Mi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ei(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>gi(this.value.arrayValue,e)))}}class Hi{constructor(e,t){this.position=e,this.before=t}}function $i(e){return`${e.before?"b":"a"}:${e.position.map((e=>wi(e))).join(",")}`}class Ki{constructor(e,t="asc"){this.field=e,this.dir=t}}function Wi(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Yi(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?fi.comparator(fi.fromName(o.referenceValue),n.key):yi(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function Qi(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!mi(e.position[n],t.position[n]))return!1;return!0}class Ji{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.V=null,this.S=null,this.startAt,this.endAt}}function Xi(e,t,n,r,i,s,o,a){return new Ji(e,t,n,r,i,s,o,a)}function Zi(e){return new Ji(e)}function es(e){return!li(e.limit)&&"F"===e.limitType}function ts(e){return!li(e.limit)&&"L"===e.limitType}function ns(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function rs(e){for(const t of e.filters)if(t.v())return t.field;return null}function is(e){return null!==e.collectionGroup}function ss(e){const t=Cr(e);if(null===t.V){t.V=[];const e=rs(t),n=ns(t);if(null!==e&&null===n)e.isKeyField()||t.V.push(new Ki(e)),t.V.push(new Ki(ei.keyField(),"asc"));else{let e=!1;for(const n of t.explicitOrderBy)t.V.push(n),n.field.isKeyField()&&(e=!0);if(!e){const e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.V.push(new Ki(ei.keyField(),e))}}}return t.V}function os(e){const t=Cr(e);if(!t.S)if("F"===t.limitType)t.S=Di(t.path,t.collectionGroup,ss(t),t.filters,t.limit,t.startAt,t.endAt);else{const e=[];for(const n of ss(t)){const t="desc"===n.dir?"asc":"desc";e.push(new Ki(n.field,t))}const n=t.endAt?new Hi(t.endAt.position,!t.endAt.before):null,r=t.startAt?new Hi(t.startAt.position,!t.startAt.before):null;t.S=Di(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}return t.S}function as(e,t,n){return new Ji(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function cs(e,t){return xi(os(e),os(t))&&e.limitType===t.limitType}function us(e){return`${Pi(os(e))}|lt:${e.limitType}`}function ls(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>{return`${(t=e).field.canonicalString()} ${t.op} ${wi(t.value)}`;var t})).join(", ")}]`),li(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: "+$i(e.startAt)),e.endAt&&(t+=", endAt: "+$i(e.endAt)),`Target(${t})`}(os(e))}; limitType=${e.limitType})`}function hs(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):fi.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of e.explicitOrderBy)if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!Yi(e.startAt,ss(e),t))&&(!e.endAt||!Yi(e.endAt,ss(e),t))}(e,t)}function ds(e){return(t,n)=>{let r=!1;for(const i of ss(e)){const e=fs(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function fs(e,t,n){const r=e.field.isKeyField()?fi.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?yi(r,i):Nr()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return Nr()}}function ps(e,t){if(e.D){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:hi(t)?"-0":t}}function ms(e){return{integerValue:""+e}}function gs(e,t){return di(t)?ms(t):ps(e,t)}class ys{constructor(){this._=void 0}}function vs(e,t,n){return e instanceof bs?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Is?Es(e,t):e instanceof Ts?Ss(e,t):function(e,t){const n=_s(e,t),r=ks(n)+ks(e.C);return Ii(n)&&Ii(e.C)?ms(r):ps(e.N,r)}(e,t)}function ws(e,t,n){return e instanceof Is?Es(e,t):e instanceof Ts?Ss(e,t):n}function _s(e,t){return e instanceof As?Ii(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}class bs extends ys{}class Is extends ys{constructor(e){super(),this.elements=e}}function Es(e,t){const n=Ns(t);for(const t of e.elements)n.some((e=>mi(e,t)))||n.push(t);return{arrayValue:{values:n}}}class Ts extends ys{constructor(e){super(),this.elements=e}}function Ss(e,t){let n=Ns(t);for(const t of e.elements)n=n.filter((e=>!mi(e,t)));return{arrayValue:{values:n}}}class As extends ys{constructor(e,t){super(),this.N=e,this.C=t}}function ks(e){return si(e.integerValue||e.doubleValue)}function Ns(e){return Ei(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Rs{constructor(e,t){this.field=e,this.transform=t}}class Cs{constructor(e,t){this.version=e,this.transformResults=t}}class Os{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Os}static exists(e){return new Os(void 0,e)}static updateTime(e){return new Os(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ds(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Ps{}function xs(e,t,n){e instanceof Vs?function(e,t,n){const r=e.value.clone(),i=qs(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Bs?function(e,t,n){if(!Ds(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=qs(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(js(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Ls(e,t,n){e instanceof Vs?function(e,t,n){if(!Ds(e.precondition,t))return;const r=e.value.clone(),i=zs(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(Fs(t),r).setHasLocalMutations()}(e,t,n):e instanceof Bs?function(e,t,n){if(!Ds(e.precondition,t))return;const r=zs(e.fieldTransforms,n,t),i=t.data;i.setAll(js(e)),i.setAll(r),t.convertToFoundDocument(Fs(t),i).setHasLocalMutations()}(e,t,n):function(e,t){Ds(e.precondition,t)&&t.convertToNoDocument(Kr.min())}(e,t)}function Ms(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=_s(r.transform,e||null);null!=i&&(null==n&&(n=Ni.empty()),n.set(r.field,i))}return n||null}function Us(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&Gr(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Is&&t instanceof Is||e instanceof Ts&&t instanceof Ts?Gr(e.elements,t.elements,mi):e instanceof As&&t instanceof As?mi(e.C,t.C):e instanceof bs&&t instanceof bs}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function Fs(e){return e.isFoundDocument()?e.version:Kr.min()}class Vs extends Ps{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}}class Bs extends Ps{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}}function js(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function qs(e,t,n){const r=new Map;Rr(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,ws(o,a,n[i]))}return r}function zs(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,vs(e,s,t))}return r}class Gs extends Ps{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}}class Hs extends Ps{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}}class $s{constructor(e){this.count=e}}var Ks,Ws;function Ys(e){switch(e){default:return Nr();case Or.CANCELLED:case Or.UNKNOWN:case Or.DEADLINE_EXCEEDED:case Or.RESOURCE_EXHAUSTED:case Or.INTERNAL:case Or.UNAVAILABLE:case Or.UNAUTHENTICATED:return!1;case Or.INVALID_ARGUMENT:case Or.NOT_FOUND:case Or.ALREADY_EXISTS:case Or.PERMISSION_DENIED:case Or.FAILED_PRECONDITION:case Or.ABORTED:case Or.OUT_OF_RANGE:case Or.UNIMPLEMENTED:case Or.DATA_LOSS:return!0}}function Qs(e){if(void 0===e)return Sr("GRPC error has no .code"),Or.UNKNOWN;switch(e){case Ks.OK:return Or.OK;case Ks.CANCELLED:return Or.CANCELLED;case Ks.UNKNOWN:return Or.UNKNOWN;case Ks.DEADLINE_EXCEEDED:return Or.DEADLINE_EXCEEDED;case Ks.RESOURCE_EXHAUSTED:return Or.RESOURCE_EXHAUSTED;case Ks.INTERNAL:return Or.INTERNAL;case Ks.UNAVAILABLE:return Or.UNAVAILABLE;case Ks.UNAUTHENTICATED:return Or.UNAUTHENTICATED;case Ks.INVALID_ARGUMENT:return Or.INVALID_ARGUMENT;case Ks.NOT_FOUND:return Or.NOT_FOUND;case Ks.ALREADY_EXISTS:return Or.ALREADY_EXISTS;case Ks.PERMISSION_DENIED:return Or.PERMISSION_DENIED;case Ks.FAILED_PRECONDITION:return Or.FAILED_PRECONDITION;case Ks.ABORTED:return Or.ABORTED;case Ks.OUT_OF_RANGE:return Or.OUT_OF_RANGE;case Ks.UNIMPLEMENTED:return Or.UNIMPLEMENTED;case Ks.DATA_LOSS:return Or.DATA_LOSS;default:return Nr()}}(Ws=Ks||(Ks={}))[Ws.OK=0]="OK",Ws[Ws.CANCELLED=1]="CANCELLED",Ws[Ws.UNKNOWN=2]="UNKNOWN",Ws[Ws.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ws[Ws.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ws[Ws.NOT_FOUND=5]="NOT_FOUND",Ws[Ws.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ws[Ws.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ws[Ws.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ws[Ws.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ws[Ws.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ws[Ws.ABORTED=10]="ABORTED",Ws[Ws.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ws[Ws.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ws[Ws.INTERNAL=13]="INTERNAL",Ws[Ws.UNAVAILABLE=14]="UNAVAILABLE",Ws[Ws.DATA_LOSS=15]="DATA_LOSS";class Js{constructor(e,t){this.comparator=e,this.root=t||Zs.EMPTY}insert(e,t){return new Js(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Zs.BLACK,null,null))}remove(e){return new Js(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Zs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Xs(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Xs(this.root,e,this.comparator,!1)}getReverseIterator(){return new Xs(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Xs(this.root,e,this.comparator,!0)}}class Xs{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Zs{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:Zs.RED,this.left=null!=r?r:Zs.EMPTY,this.right=null!=i?i:Zs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new Zs(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return Zs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return Zs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Zs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Zs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Nr();if(this.right.isRed())throw Nr();const e=this.left.check();if(e!==this.right.check())throw Nr();return e+(this.isRed()?0:1)}}Zs.EMPTY=null,Zs.RED=!0,Zs.BLACK=!1,Zs.EMPTY=new class{constructor(){this.size=0}get key(){throw Nr()}get value(){throw Nr()}get color(){throw Nr()}get left(){throw Nr()}get right(){throw Nr()}copy(e,t,n,r,i){return this}insert(e,t,n){return new Zs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class eo{constructor(e){this.comparator=e,this.data=new Js(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new to(this.data.getIterator())}getIteratorFrom(e){return new to(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof eo))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new eo(this.comparator);return t.data=e,t}}class to{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const no=new Js(fi.comparator);function ro(){return no}const io=new Js(fi.comparator);function so(){return io}const oo=new Js(fi.comparator);function ao(){return oo}const co=new eo(fi.comparator);function uo(...e){let t=co;for(const n of e)t=t.add(n);return t}const lo=new eo(zr);function ho(){return lo}class fo{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t){const n=new Map;return n.set(e,po.createSynthesizedTargetChangeForCurrentChange(e,t)),new fo(Kr.min(),n,ho(),ro(),uo())}}class po{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t){return new po(ni.EMPTY_BYTE_STRING,t,uo(),uo(),uo())}}class mo{constructor(e,t,n,r){this.k=e,this.removedTargetIds=t,this.key=n,this.$=r}}class go{constructor(e,t){this.targetId=e,this.O=t}}class yo{constructor(e,t,n=ni.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class vo{constructor(){this.F=0,this.M=bo(),this.L=ni.EMPTY_BYTE_STRING,this.B=!1,this.U=!0}get current(){return this.B}get resumeToken(){return this.L}get q(){return 0!==this.F}get K(){return this.U}j(e){e.approximateByteSize()>0&&(this.U=!0,this.L=e)}W(){let e=uo(),t=uo(),n=uo();return this.M.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:Nr()}})),new po(this.L,this.B,e,t,n)}G(){this.U=!1,this.M=bo()}H(e,t){this.U=!0,this.M=this.M.insert(e,t)}J(e){this.U=!0,this.M=this.M.remove(e)}Y(){this.F+=1}X(){this.F-=1}Z(){this.U=!0,this.B=!0}}class wo{constructor(e){this.tt=e,this.et=new Map,this.nt=ro(),this.st=_o(),this.it=new eo(zr)}rt(e){for(const t of e.k)e.$&&e.$.isFoundDocument()?this.ot(t,e.$):this.at(t,e.key,e.$);for(const t of e.removedTargetIds)this.at(t,e.key,e.$)}ct(e){this.forEachTarget(e,(t=>{const n=this.ut(t);switch(e.state){case 0:this.ht(t)&&n.j(e.resumeToken);break;case 1:n.X(),n.q||n.G(),n.j(e.resumeToken);break;case 2:n.X(),n.q||this.removeTarget(t);break;case 3:this.ht(t)&&(n.Z(),n.j(e.resumeToken));break;case 4:this.ht(t)&&(this.lt(t),n.j(e.resumeToken));break;default:Nr()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.et.forEach(((e,n)=>{this.ht(n)&&t(n)}))}ft(e){const t=e.targetId,n=e.O.count,r=this.dt(t);if(r){const e=r.target;if(Li(e))if(0===n){const n=new fi(e.path);this.at(t,n,Ci.newNoDocument(n,Kr.min()))}else Rr(1===n);else this.wt(t)!==n&&(this.lt(t),this.it=this.it.add(t))}}_t(e){const t=new Map;this.et.forEach(((n,r)=>{const i=this.dt(r);if(i){if(n.current&&Li(i.target)){const t=new fi(i.target.path);null!==this.nt.get(t)||this.gt(r,t)||this.at(r,t,Ci.newNoDocument(t,e))}n.K&&(t.set(r,n.W()),n.G())}}));let n=uo();this.st.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.dt(e);return!t||2===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))}));const r=new fo(e,t,this.it,this.nt,n);return this.nt=ro(),this.st=_o(),this.it=new eo(zr),r}ot(e,t){if(!this.ht(e))return;const n=this.gt(e,t.key)?2:0;this.ut(e).H(t.key,n),this.nt=this.nt.insert(t.key,t),this.st=this.st.insert(t.key,this.yt(t.key).add(e))}at(e,t,n){if(!this.ht(e))return;const r=this.ut(e);this.gt(e,t)?r.H(t,1):r.J(t),this.st=this.st.insert(t,this.yt(t).delete(e)),n&&(this.nt=this.nt.insert(t,n))}removeTarget(e){this.et.delete(e)}wt(e){const t=this.ut(e).W();return this.tt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Y(e){this.ut(e).Y()}ut(e){let t=this.et.get(e);return t||(t=new vo,this.et.set(e,t)),t}yt(e){let t=this.st.get(e);return t||(t=new eo(zr),this.st=this.st.insert(e,t)),t}ht(e){const t=null!==this.dt(e);return t||Tr("WatchChangeAggregator","Detected inactive target",e),t}dt(e){const t=this.et.get(e);return t&&t.q?null:this.tt.Et(e)}lt(e){this.et.set(e,new vo),this.tt.getRemoteKeysForTarget(e).forEach((t=>{this.at(e,t,null)}))}gt(e,t){return this.tt.getRemoteKeysForTarget(e).has(t)}}function _o(){return new Js(fi.comparator)}function bo(){return new Js(fi.comparator)}const Io={asc:"ASCENDING",desc:"DESCENDING"},Eo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class To{constructor(e,t){this.databaseId=e,this.D=t}}function So(e,t){return e.D?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ao(e,t){return e.D?t.toBase64():t.toUint8Array()}function ko(e,t){return So(e,t.toTimestamp())}function No(e){return Rr(!!e),Kr.fromTimestamp(function(e){const t=ii(e);return new $r(t.seconds,t.nanos)}(e))}function Ro(e,t){return function(e){return new Xr(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function Co(e){const t=Xr.fromString(e);return Rr(ea(t)),t}function Oo(e,t){return Ro(e.databaseId,t.path)}function Do(e,t){const n=Co(t);if(n.get(1)!==e.databaseId.projectId)throw new Dr(Or.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new Dr(Or.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new fi(Mo(n))}function Po(e,t){return Ro(e.databaseId,t)}function xo(e){const t=Co(e);return 4===t.length?Xr.emptyPath():Mo(t)}function Lo(e){return new Xr(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Mo(e){return Rr(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function Uo(e,t,n){return{name:Oo(e,t),fields:n.value.mapValue.fields}}function Fo(e,t,n){const r=Do(e,t.name),i=No(t.updateTime),s=new Ni({mapValue:{fields:t.fields}}),o=Ci.newFoundDocument(r,i,s);return n&&o.setHasCommittedMutations(),n?o.setHasCommittedMutations():o}function Vo(e,t){let n;if(t instanceof Vs)n={update:Uo(e,t.key,t.value)};else if(t instanceof Gs)n={delete:Oo(e,t.key)};else if(t instanceof Bs)n={update:Uo(e,t.key,t.data),updateMask:Zo(t.fieldMask)};else{if(!(t instanceof Hs))return Nr();n={verify:Oo(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof bs)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Is)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ts)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof As)return{fieldPath:t.field.canonicalString(),increment:n.C};throw Nr()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:ko(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:Nr()}(e,t.precondition)),n}function Bo(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?Os.updateTime(No(e.updateTime)):void 0!==e.exists?Os.exists(e.exists):Os.none()}(t.currentDocument):Os.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)Rr("REQUEST_TIME"===t.setToServerValue),n=new bs;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Is(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Ts(e)}else"increment"in t?n=new As(e,t.increment):Nr();const r=ei.fromServerFormat(t.fieldPath);return new Rs(r,n)}(e,t))):[];if(t.update){t.update.name;const i=Do(e,t.update.name),s=new Ni({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new ti(t.map((e=>ei.fromServerFormat(e))))}(t.updateMask);return new Bs(i,s,e,n,r)}return new Vs(i,s,n,r)}if(t.delete){const r=Do(e,t.delete);return new Gs(r,n)}if(t.verify){const r=Do(e,t.verify);return new Hs(r,n)}return Nr()}function jo(e,t){return{documents:[Po(e,t.path)]}}function qo(e,t){const n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=Po(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=Po(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);const i=function(e){if(0===e.length)return;const t=e.map((e=>function(e){if("=="===e.op){if(Si(e.value))return{unaryFilter:{field:Yo(e.field),op:"IS_NAN"}};if(Ti(e.value))return{unaryFilter:{field:Yo(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Si(e.value))return{unaryFilter:{field:Yo(e.field),op:"IS_NOT_NAN"}};if(Ti(e.value))return{unaryFilter:{field:Yo(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Yo(e.field),op:Wo(e.op),value:e.value}}}(e)));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(t.filters);i&&(n.structuredQuery.where=i);const s=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Yo(e.field),direction:Ko(e.dir)}}(e)))}(t.orderBy);s&&(n.structuredQuery.orderBy=s);const o=function(e,t){return e.D||li(t)?t:{value:t}}(e,t.limit);return null!==o&&(n.structuredQuery.limit=o),t.startAt&&(n.structuredQuery.startAt=Ho(t.startAt)),t.endAt&&(n.structuredQuery.endAt=Ho(t.endAt)),n}function zo(e){let t=xo(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){Rr(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=Go(n.where));let o=[];n.orderBy&&(o=n.orderBy.map((e=>function(e){return new Ki(Qo(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,li(t)?null:t}(n.limit));let c=null;n.startAt&&(c=$o(n.startAt));let u=null;return n.endAt&&(u=$o(n.endAt)),Xi(t,i,o,s,a,"F",c,u)}function Go(e){return e?void 0!==e.unaryFilter?[Xo(e)]:void 0!==e.fieldFilter?[Jo(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((e=>Go(e))).reduce(((e,t)=>e.concat(t))):Nr():[]}function Ho(e){return{before:e.before,values:e.position}}function $o(e){const t=!!e.before,n=e.values||[];return new Hi(n,t)}function Ko(e){return Io[e]}function Wo(e){return Eo[e]}function Yo(e){return{fieldPath:e.canonicalString()}}function Qo(e){return ei.fromServerFormat(e.fieldPath)}function Jo(e){return Mi.create(Qo(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Nr()}}(e.fieldFilter.op),e.fieldFilter.value)}function Xo(e){switch(e.unaryFilter.op){case"IS_NAN":const t=Qo(e.unaryFilter.field);return Mi.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=Qo(e.unaryFilter.field);return Mi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=Qo(e.unaryFilter.field);return Mi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=Qo(e.unaryFilter.field);return Mi.create(i,"!=",{nullValue:"NULL_VALUE"});default:return Nr()}}function Zo(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function ea(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function ta(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=ra(t)),t=na(e.get(n),t);return ra(t)}function na(e,t){let n=t;const r=e.length;for(let t=0;t<r;t++){const r=e.charAt(t);switch(r){case"\0":n+="";break;case"":n+="";break;default:n+=r}}return n}function ra(e){return e+""}function ia(e){const t=e.length;if(Rr(t>=2),2===t)return Rr(""===e.charAt(0)&&""===e.charAt(1)),Xr.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("",s);switch((t<0||t>n)&&Nr(),e.charAt(t+1)){case"":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"":i+=e.substring(s,t),i+="\0";break;case"":i+=e.substring(s,t+1);break;default:Nr()}s=t+2}return new Xr(r)}class sa{constructor(e,t){this.seconds=e,this.nanoseconds=t}}class oa{constructor(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n}}oa.store="owner",oa.key="owner";class aa{constructor(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n}}aa.store="mutationQueues",aa.keyPath="userId";class ca{constructor(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}}ca.store="mutations",ca.keyPath="batchId",ca.userMutationsIndex="userMutationsIndex",ca.userMutationsKeyPath=["userId","batchId"];class ua{constructor(){}static prefixForUser(e){return[e]}static prefixForPath(e,t){return[e,ta(t)]}static key(e,t,n){return[e,ta(t),n]}}ua.store="documentMutations",ua.PLACEHOLDER=new ua;class la{constructor(e,t){this.path=e,this.readTime=t}}class ha{constructor(e,t){this.path=e,this.version=t}}class da{constructor(e,t,n,r,i,s){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=s}}da.store="remoteDocuments",da.readTimeIndex="readTimeIndex",da.readTimeIndexPath="readTime",da.collectionReadTimeIndex="collectionReadTimeIndex",da.collectionReadTimeIndexPath=["parentPath","readTime"];class fa{constructor(e){this.byteSize=e}}fa.store="remoteDocumentGlobal",fa.key="remoteDocumentGlobalKey";class pa{constructor(e,t,n,r,i,s,o){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=s,this.query=o}}pa.store="targets",pa.keyPath="targetId",pa.queryTargetsIndexName="queryTargetsIndex",pa.queryTargetsKeyPath=["canonicalId","targetId"];class ma{constructor(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n}}ma.store="targetDocuments",ma.keyPath=["targetId","path"],ma.documentTargetsIndex="documentTargetsIndex",ma.documentTargetsKeyPath=["path","targetId"];class ga{constructor(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r}}ga.key="targetGlobalKey",ga.store="targetGlobal";class ya{constructor(e,t){this.collectionId=e,this.parent=t}}ya.store="collectionParents",ya.keyPath=["collectionId","parent"];class va{constructor(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r}}va.store="clientMetadata",va.keyPath="clientId";class wa{constructor(e,t,n){this.bundleId=e,this.createTime=t,this.version=n}}wa.store="bundles",wa.keyPath="bundleId";class _a{constructor(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n}}_a.store="namedQueries",_a.keyPath="name";const ba=[aa.store,ca.store,ua.store,da.store,pa.store,oa.store,ga.store,ma.store,va.store,fa.store,ya.store,wa.store,_a.store],Ia="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ea{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}class Ta{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Nr(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ta(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ta?t:Ta.resolve(t)}catch(e){return Ta.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ta.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ta.reject(t)}static resolve(e){return new Ta(((t,n)=>{t(e)}))}static reject(e){return new Ta(((t,n)=>{n(e)}))}static waitFor(e){return new Ta(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=Ta.resolve(!1);for(const n of e)t=t.next((e=>e?Ta.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}}class Sa{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.Tt=new Pr,this.transaction.oncomplete=()=>{this.Tt.resolve()},this.transaction.onabort=()=>{t.error?this.Tt.reject(new Na(e,t.error)):this.Tt.resolve()},this.transaction.onerror=t=>{const n=Pa(t.target.error);this.Tt.reject(new Na(e,n))}}static open(e,t,n,r){try{return new Sa(t,e.transaction(r,n))}catch(e){throw new Na(t,e)}}get It(){return this.Tt.promise}abort(e){e&&this.Tt.reject(e),this.aborted||(Tr("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(e){const t=this.transaction.objectStore(e);return new Ca(t)}}class Aa{constructor(e,t,n){this.name=e,this.version=t,this.At=n,12.2===Aa.Rt((0,c.z$)())&&Sr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Tr("SimpleDb","Removing database:",e),Oa(window.indexedDB.deleteDatabase(e)).toPromise()}static bt(){if(!(0,c.hl)())return!1;if(Aa.Pt())return!0;const e=(0,c.z$)(),t=Aa.Rt(e),n=0<t&&t<10,r=Aa.vt(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static Pt(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.env)||void 0===e?void 0:e.Vt)}static St(e,t){return e.store(t)}static Rt(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static vt(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async Dt(e){return this.db||(Tr("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Na(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new Dr(Or.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new Dr(Or.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Na(e,r))},r.onupgradeneeded=e=>{Tr("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.At.Ct(t,r.transaction,e.oldVersion,this.version).next((()=>{Tr("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.Nt&&(this.db.onversionchange=e=>this.Nt(e)),this.db}xt(e){this.Nt=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.Dt(e);const t=Sa.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).catch((e=>(t.abort(e),Ta.reject(e)))).toPromise();return s.catch((()=>{})),await t.It,s}catch(e){const t="FirebaseError"!==e.name&&s<3;if(Tr("SimpleDb","Transaction failed with error:",e.message,"Retrying:",t),this.close(),!t)return Promise.reject(e)}}}close(){this.db&&this.db.close(),this.db=void 0}}class ka{constructor(e){this.kt=e,this.$t=!1,this.Ot=null}get isDone(){return this.$t}get Ft(){return this.Ot}set cursor(e){this.kt=e}done(){this.$t=!0}Mt(e){this.Ot=e}delete(){return Oa(this.kt.delete())}}class Na extends Dr{constructor(e,t){super(Or.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Ra(e){return"IndexedDbTransactionError"===e.name}class Ca{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(Tr("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Tr("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Oa(n)}add(e){return Tr("SimpleDb","ADD",this.store.name,e,e),Oa(this.store.add(e))}get(e){return Oa(this.store.get(e)).next((t=>(void 0===t&&(t=null),Tr("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return Tr("SimpleDb","DELETE",this.store.name,e),Oa(this.store.delete(e))}count(){return Tr("SimpleDb","COUNT",this.store.name),Oa(this.store.count())}Lt(e,t){const n=this.cursor(this.options(e,t)),r=[];return this.Bt(n,((e,t)=>{r.push(t)})).next((()=>r))}Ut(e,t){Tr("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.qt=!1;const r=this.cursor(n);return this.Bt(r,((e,t,n)=>n.delete()))}Kt(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.Bt(r,t)}jt(e){const t=this.cursor({});return new Ta(((n,r)=>{t.onerror=e=>{const t=Pa(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}Bt(e,t){const n=[];return new Ta(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new ka(i),o=t(i.primaryKey,i.value,s);if(o instanceof Ta){const e=o.catch((e=>(s.done(),Ta.reject(e))));n.push(e)}s.isDone?r():null===s.Ft?i.continue():i.continue(s.Ft)}})).next((()=>Ta.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.qt?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Oa(e){return new Ta(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Pa(e.target.error);n(t)}}))}let Da=!1;function Pa(e){const t=Aa.Rt((0,c.z$)());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new Dr("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Da||(Da=!0,setTimeout((()=>{throw e}),0)),e}}return e}class xa extends Ea{constructor(e,t){super(),this.Qt=e,this.currentSequenceNumber=t}}function La(e,t){const n=Cr(e);return Aa.St(n.Qt,t)}class Ma{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){const r=this.mutations[t];r.key.isEqual(e.key)&&xs(r,e,n[t])}}applyToLocalView(e){for(const t of this.baseMutations)t.key.isEqual(e.key)&&Ls(t,e,this.localWriteTime);for(const t of this.mutations)t.key.isEqual(e.key)&&Ls(t,e,this.localWriteTime)}applyToLocalDocumentSet(e){this.mutations.forEach((t=>{const n=e.get(t.key),r=n;this.applyToLocalView(r),n.isValidDocument()||r.convertToNoDocument(Kr.min())}))}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),uo())}isEqual(e){return this.batchId===e.batchId&&Gr(this.mutations,e.mutations,((e,t)=>Us(e,t)))&&Gr(this.baseMutations,e.baseMutations,((e,t)=>Us(e,t)))}}class Ua{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){Rr(e.mutations.length===n.length);let r=ao();const i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new Ua(e,t,n,r)}}class Fa{constructor(e,t,n,r,i=Kr.min(),s=Kr.min(),o=ni.EMPTY_BYTE_STRING){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o}withSequenceNumber(e){return new Fa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(e,t){return new Fa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e)}withLastLimboFreeSnapshotVersion(e){return new Fa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)}}class Va{constructor(e){this.Wt=e}}function Ba(e,t){if(t.document)return Fo(e.Wt,t.document,!!t.hasCommittedMutations);if(t.noDocument){const e=fi.fromSegments(t.noDocument.path),n=Ha(t.noDocument.readTime),r=Ci.newNoDocument(e,n);return t.hasCommittedMutations?r.setHasCommittedMutations():r}if(t.unknownDocument){const e=fi.fromSegments(t.unknownDocument.path),n=Ha(t.unknownDocument.version);return Ci.newUnknownDocument(e,n)}return Nr()}function ja(e,t,n){const r=qa(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){const n=function(e,t){return{name:Oo(e,t.key),fields:t.data.value.mapValue.fields,updateTime:So(e,t.version.toTimestamp())}}(e.Wt,t),s=t.hasCommittedMutations;return new da(null,null,n,s,r,i)}if(t.isNoDocument()){const e=t.key.path.toArray(),n=Ga(t.version),s=t.hasCommittedMutations;return new da(null,new la(e,n),null,s,r,i)}if(t.isUnknownDocument()){const e=t.key.path.toArray(),n=Ga(t.version);return new da(new ha(e,n),null,null,!0,r,i)}return Nr()}function qa(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function za(e){const t=new $r(e[0],e[1]);return Kr.fromTimestamp(t)}function Ga(e){const t=e.toTimestamp();return new sa(t.seconds,t.nanoseconds)}function Ha(e){const t=new $r(e.seconds,e.nanoseconds);return Kr.fromTimestamp(t)}function $a(e,t){const n=(t.baseMutations||[]).map((t=>Bo(e.Wt,t)));for(let e=0;e<t.mutations.length-1;++e){const n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){const r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}const r=t.mutations.map((t=>Bo(e.Wt,t))),i=$r.fromMillis(t.localWriteTimeMs);return new Ma(t.batchId,i,n,r)}function Ka(e){const t=Ha(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Ha(e.lastLimboFreeSnapshotVersion):Kr.min();let r;var i;return void 0!==e.query.documents?(Rr(1===(i=e.query).documents.length),r=os(Zi(xo(i.documents[0])))):r=function(e){return os(zo(e))}(e.query),new Fa(r,e.targetId,0,e.lastListenSequenceNumber,t,n,ni.fromBase64String(e.resumeToken))}function Wa(e,t){const n=Ga(t.snapshotVersion),r=Ga(t.lastLimboFreeSnapshotVersion);let i;i=Li(t.target)?jo(e.Wt,t.target):qo(e.Wt,t.target);const s=t.resumeToken.toBase64();return new pa(t.targetId,Pi(t.target),n,s,t.sequenceNumber,r,i)}function Ya(e){const t=zo({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?as(t,t.limit,"L"):t}class Qa{getBundleMetadata(e,t){return Ja(e).get(t).next((e=>{if(e)return{id:(t=e).bundleId,createTime:Ha(t.createTime),version:t.version};var t}))}saveBundleMetadata(e,t){return Ja(e).put({bundleId:(n=t).id,createTime:Ga(No(n.createTime)),version:n.version});var n}getNamedQuery(e,t){return Xa(e).get(t).next((e=>{if(e)return{name:(t=e).name,query:Ya(t.bundledQuery),readTime:Ha(t.readTime)};var t}))}saveNamedQuery(e,t){return Xa(e).put(function(e){return{name:e.name,readTime:Ga(No(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function Ja(e){return La(e,wa.store)}function Xa(e){return La(e,_a.store)}class Za{constructor(){this.Gt=new ec}addToCollectionParentIndex(e,t){return this.Gt.add(t),Ta.resolve()}getCollectionParents(e,t){return Ta.resolve(this.Gt.getEntries(t))}}class ec{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new eo(Xr.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new eo(Xr.comparator)).toArray()}}class tc{constructor(){this.zt=new ec}addToCollectionParentIndex(e,t){if(!this.zt.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.zt.add(t)}));const i={collectionId:n,parent:ta(r)};return nc(e).put(i)}return Ta.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[Hr(t),""],!1,!0);return nc(e).Lt(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(ia(r.parent))}return n}))}}function nc(e){return La(e,ya.store)}const rc={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class ic{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new ic(e,ic.DEFAULT_COLLECTION_PERCENTILE,ic.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function sc(e,t,n){const r=e.store(ca.store),i=e.store(ua.store),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const c=r.Kt({range:o},((e,t,n)=>(a++,n.delete())));s.push(c.next((()=>{Rr(1===a)})));const u=[];for(const e of n.mutations){const r=ua.key(t,e.key.path,n.batchId);s.push(i.delete(r)),u.push(e.key)}return Ta.waitFor(s).next((()=>u))}function oc(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw Nr();t=e.noDocument}return JSON.stringify(t).length}ic.DEFAULT_COLLECTION_PERCENTILE=10,ic.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,ic.DEFAULT=new ic(41943040,ic.DEFAULT_COLLECTION_PERCENTILE,ic.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),ic.DISABLED=new ic(-1,0,0);class ac{constructor(e,t,n,r){this.userId=e,this.N=t,this.Ht=n,this.referenceDelegate=r,this.Jt={}}static Yt(e,t,n,r){Rr(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new ac(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return uc(e).Kt({index:ca.userMutationsIndex,range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=lc(e),s=uc(e);return s.add({}).next((o=>{Rr("number"==typeof o);const a=new Ma(o,t,n,r),c=function(e,t,n){const r=n.baseMutations.map((t=>Vo(e.Wt,t))),i=n.mutations.map((t=>Vo(e.Wt,t)));return new ca(t,n.batchId,n.localWriteTime.toMillis(),r,i)}(this.N,this.userId,a),u=[];let l=new eo(((e,t)=>zr(e.canonicalString(),t.canonicalString())));for(const e of r){const t=ua.key(this.userId,e.key.path,o);l=l.add(e.key.path.popLast()),u.push(s.put(c)),u.push(i.put(t,ua.PLACEHOLDER))}return l.forEach((t=>{u.push(this.Ht.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Jt[o]=a.keys()})),Ta.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return uc(e).get(t).next((e=>e?(Rr(e.userId===this.userId),$a(this.N,e)):null))}Xt(e,t){return this.Jt[t]?Ta.resolve(this.Jt[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Jt[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return uc(e).Kt({index:ca.userMutationsIndex,range:r},((e,t,r)=>{t.userId===this.userId&&(Rr(t.batchId>=n),i=$a(this.N,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return uc(e).Kt({index:ca.userMutationsIndex,range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return uc(e).Lt(ca.userMutationsIndex,t).next((e=>e.map((e=>$a(this.N,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=ua.prefixForPath(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return lc(e).Kt({range:r},((n,r,s)=>{const[o,a,c]=n,u=ia(a);if(o===this.userId&&t.path.isEqual(u))return uc(e).get(c).next((e=>{if(!e)throw Nr();Rr(e.userId===this.userId),i.push($a(this.N,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new eo(zr);const r=[];return t.forEach((t=>{const i=ua.prefixForPath(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=lc(e).Kt({range:s},((e,r,i)=>{const[s,o,a]=e,c=ia(o);s===this.userId&&t.path.isEqual(c)?n=n.add(a):i.done()}));r.push(o)})),Ta.waitFor(r).next((()=>this.Zt(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=ua.prefixForPath(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new eo(zr);return lc(e).Kt({range:s},((e,t,i)=>{const[s,a,c]=e,u=ia(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(c)):i.done()})).next((()=>this.Zt(e,o)))}Zt(e,t){const n=[],r=[];return t.forEach((t=>{r.push(uc(e).get(t).next((e=>{if(null===e)throw Nr();Rr(e.userId===this.userId),n.push($a(this.N,e))})))})),Ta.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return sc(e.Qt,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.te(t.batchId)})),Ta.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}te(e){delete this.Jt[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Ta.resolve();const n=IDBKeyRange.lowerBound(ua.prefixForUser(this.userId)),r=[];return lc(e).Kt({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=ia(e[1]);r.push(t)}else n.done()})).next((()=>{Rr(0===r.length)}))}))}containsKey(e,t){return cc(e,this.userId,t)}ee(e){return hc(e).get(this.userId).next((e=>e||new aa(this.userId,-1,"")))}}function cc(e,t,n){const r=ua.prefixForPath(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return lc(e).Kt({range:s,qt:!0},((e,n,r)=>{const[s,a,c]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function uc(e){return La(e,ca.store)}function lc(e){return La(e,ua.store)}function hc(e){return La(e,aa.store)}class dc{constructor(e){this.ne=e}next(){return this.ne+=2,this.ne}static se(){return new dc(0)}static ie(){return new dc(-1)}}class fc{constructor(e,t){this.referenceDelegate=e,this.N=t}allocateTargetId(e){return this.re(e).next((t=>{const n=new dc(t.highestTargetId);return t.highestTargetId=n.next(),this.oe(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.re(e).next((e=>Kr.fromTimestamp(new $r(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.re(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.re(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.oe(e,r))))}addTargetData(e,t){return this.ae(e,t).next((()=>this.re(e).next((n=>(n.targetCount+=1,this.ce(t,n),this.oe(e,n))))))}updateTargetData(e,t){return this.ae(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>pc(e).delete(t.targetId))).next((()=>this.re(e))).next((t=>(Rr(t.targetCount>0),t.targetCount-=1,this.oe(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return pc(e).Kt(((s,o)=>{const a=Ka(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>Ta.waitFor(i))).next((()=>r))}forEachTarget(e,t){return pc(e).Kt(((e,n)=>{const r=Ka(n);t(r)}))}re(e){return mc(e).get(ga.key).next((e=>(Rr(null!==e),e)))}oe(e,t){return mc(e).put(ga.key,t)}ae(e,t){return pc(e).put(Wa(this.N,t))}ce(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.re(e).next((e=>e.targetCount))}getTargetData(e,t){const n=Pi(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return pc(e).Kt({range:r,index:pa.queryTargetsIndexName},((e,n,r)=>{const s=Ka(n);xi(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=gc(e);return t.forEach((t=>{const s=ta(t.path);r.push(i.put(new ma(n,s))),r.push(this.referenceDelegate.addReference(e,n,t))})),Ta.waitFor(r)}removeMatchingKeys(e,t,n){const r=gc(e);return Ta.forEach(t,(t=>{const i=ta(t.path);return Ta.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=gc(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=gc(e);let i=uo();return r.Kt({range:n,qt:!0},((e,t,n)=>{const r=ia(e[1]),s=new fi(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=ta(t.path),r=IDBKeyRange.bound([n],[Hr(n)],!1,!0);let i=0;return gc(e).Kt({index:ma.documentTargetsIndex,qt:!0,range:r},(([e,t],n,r)=>{0!==e&&(i++,r.done())})).next((()=>i>0))}Et(e,t){return pc(e).get(t).next((e=>e?Ka(e):null))}}function pc(e){return La(e,pa.store)}function mc(e){return La(e,ga.store)}function gc(e){return La(e,ma.store)}async function yc(e){if(e.code!==Or.FAILED_PRECONDITION||e.message!==Ia)throw e;Tr("LocalStore","Unexpectedly lost primary lease")}function vc([e,t],[n,r]){const i=zr(e,n);return 0===i?zr(t,r):i}class wc{constructor(e){this.ue=e,this.buffer=new eo(vc),this.he=0}le(){return++this.he}fe(e){const t=[e,this.le()];if(this.buffer.size<this.ue)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();vc(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class _c{constructor(e,t){this.garbageCollector=e,this.asyncQueue=t,this.de=!1,this.we=null}start(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this._e(e)}stop(){this.we&&(this.we.cancel(),this.we=null)}get started(){return null!==this.we}_e(e){const t=this.de?3e5:6e4;Tr("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.we=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,(async()=>{this.we=null,this.de=!0;try{await e.collectGarbage(this.garbageCollector)}catch(e){Ra(e)?Tr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await yc(e)}await this._e(e)}))}}class bc{constructor(e,t){this.me=e,this.params=t}calculateTargetCount(e,t){return this.me.ge(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return Ta.resolve(Br.T);const n=new wc(t);return this.me.forEachTarget(e,(e=>n.fe(e.sequenceNumber))).next((()=>this.me.ye(e,(e=>n.fe(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.me.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.me.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Tr("LruGarbageCollector","Garbage collection skipped; disabled"),Ta.resolve(rc)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Tr("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),rc):this.pe(e,t)))}getCacheSize(e){return this.me.getCacheSize(e)}pe(e,t){let n,r,i,s,o,c,u;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(Tr("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(u=Date.now(),Er()<=a.in.DEBUG&&Tr("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-l}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(c-o)+"ms\n"+`\tRemoved ${e} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-l}ms`),Ta.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}class Ic{constructor(e,t){this.db=e,this.garbageCollector=function(e,t){return new bc(e,t)}(this,t)}ge(e){const t=this.Ee(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}Ee(e){let t=0;return this.ye(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}ye(e,t){return this.Te(e,((e,n)=>t(n)))}addReference(e,t,n){return Ec(e,n)}removeReference(e,t,n){return Ec(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Ec(e,t)}Ie(e,t){return function(e,t){let n=!1;return hc(e).jt((r=>cc(e,r,t).next((e=>(e&&(n=!0),Ta.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.Te(e,((s,o)=>{if(o<=t){const t=this.Ie(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s),gc(e).delete([0,ta(s.path)]))))}));r.push(t)}})).next((()=>Ta.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Ec(e,t)}Te(e,t){const n=gc(e);let r,i=Br.T;return n.Kt({index:ma.documentTargetsIndex},(([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==Br.T&&t(new fi(ia(r)),i),i=o,r=s):i=Br.T})).next((()=>{i!==Br.T&&t(new fi(ia(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ec(e,t){return gc(e).put(function(e,t){return new ma(0,ta(e.path),t)}(t,e.currentSequenceNumber))}class Tc{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[t,r]of n)if(this.equalsFn(t,e))return r}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1}forEach(e){Yr(this.inner,((t,n)=>{for(const[t,r]of n)e(t,r)}))}isEmpty(){return Qr(this.inner)}}class Sc{constructor(){this.changes=new Tc((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}getReadTime(e){const t=this.changes.get(e);return t?t.readTime:Kr.min()}addEntry(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})}removeEntry(e,t=null){this.assertNotApplied(),this.changes.set(e,{document:Ci.newInvalidDocument(e),readTime:t})}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Ta.resolve(n.document):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ac{constructor(e,t){this.N=e,this.Ht=t}addEntry(e,t,n){return Rc(e).put(Cc(t),n)}removeEntry(e,t){const n=Rc(e),r=Cc(t);return n.delete(r)}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.Ae(e,n))))}getEntry(e,t){return Rc(e).get(Cc(t)).next((e=>this.Re(t,e)))}be(e,t){return Rc(e).get(Cc(t)).next((e=>({document:this.Re(t,e),size:oc(e)})))}getEntries(e,t){let n=ro();return this.Pe(e,t,((e,t)=>{const r=this.Re(e,t);n=n.insert(e,r)})).next((()=>n))}ve(e,t){let n=ro(),r=new Js(fi.comparator);return this.Pe(e,t,((e,t)=>{const i=this.Re(e,t);n=n.insert(e,i),r=r.insert(e,oc(t))})).next((()=>({documents:n,Ve:r})))}Pe(e,t,n){if(t.isEmpty())return Ta.resolve();const r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator();let s=i.getNext();return Rc(e).Kt({range:r},((e,t,r)=>{const o=fi.fromSegments(e);for(;s&&fi.comparator(s,o)<0;)n(s,null),s=i.getNext();s&&s.isEqual(o)&&(n(s,t),s=i.hasNext()?i.getNext():null),s?r.Mt(s.path.toArray()):r.done()})).next((()=>{for(;s;)n(s,null),s=i.hasNext()?i.getNext():null}))}getDocumentsMatchingQuery(e,t,n){let r=ro();const i=t.path.length+1,s={};if(n.isEqual(Kr.min())){const e=t.path.toArray();s.range=IDBKeyRange.lowerBound(e)}else{const e=t.path.toArray(),r=qa(n);s.range=IDBKeyRange.lowerBound([e,r],!0),s.index=da.collectionReadTimeIndex}return Rc(e).Kt(s,((e,n,s)=>{if(e.length!==i)return;const o=Ba(this.N,n);t.path.isPrefixOf(o.key.path)?hs(t,o)&&(r=r.insert(o.key,o)):s.done()})).next((()=>r))}newChangeBuffer(e){return new kc(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return Nc(e).get(fa.key).next((e=>(Rr(!!e),e)))}Ae(e,t){return Nc(e).put(fa.key,t)}Re(e,t){if(t){const e=Ba(this.N,t);if(!e.isNoDocument()||!e.version.isEqual(Kr.min()))return e}return Ci.newInvalidDocument(e)}}class kc extends Sc{constructor(e,t){super(),this.Se=e,this.trackRemovals=t,this.De=new Tc((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new eo(((e,t)=>zr(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.De.get(i);if(s.document.isValidDocument()){const a=ja(this.Se.N,s.document,this.getReadTime(i));r=r.add(i.path.popLast());const c=oc(a);n+=c-o,t.push(this.Se.addEntry(e,i,a))}else if(n-=o,this.trackRemovals){const n=ja(this.Se.N,Ci.newNoDocument(i,Kr.min()),this.getReadTime(i));t.push(this.Se.addEntry(e,i,n))}else t.push(this.Se.removeEntry(e,i))})),r.forEach((n=>{t.push(this.Se.Ht.addToCollectionParentIndex(e,n))})),t.push(this.Se.updateMetadata(e,n)),Ta.waitFor(t)}getFromCache(e,t){return this.Se.be(e,t).next((e=>(this.De.set(t,e.size),e.document)))}getAllFromCache(e,t){return this.Se.ve(e,t).next((({documents:e,Ve:t})=>(t.forEach(((e,t)=>{this.De.set(e,t)})),e)))}}function Nc(e){return La(e,fa.store)}function Rc(e){return La(e,da.store)}function Cc(e){return e.path.toArray()}class Oc{constructor(e){this.N=e}Ct(e,t,n,r){Rr(n<r&&n>=0&&r<=11);const i=new Sa("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(oa.store)}(e),function(e){e.createObjectStore(aa.store,{keyPath:aa.keyPath}),e.createObjectStore(ca.store,{keyPath:ca.keyPath,autoIncrement:!0}).createIndex(ca.userMutationsIndex,ca.userMutationsKeyPath,{unique:!0}),e.createObjectStore(ua.store)}(e),Dc(e),function(e){e.createObjectStore(da.store)}(e));let s=Ta.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(ma.store),e.deleteObjectStore(pa.store),e.deleteObjectStore(ga.store)}(e),Dc(e)),s=s.next((()=>function(e){const t=e.store(ga.store),n=new ga(0,0,Kr.min().toTimestamp(),0);return t.put(ga.key,n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store(ca.store).Lt().next((n=>{e.deleteObjectStore(ca.store),e.createObjectStore(ca.store,{keyPath:ca.keyPath,autoIncrement:!0}).createIndex(ca.userMutationsIndex,ca.userMutationsKeyPath,{unique:!0});const r=t.store(ca.store),i=n.map((e=>r.put(e)));return Ta.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore(va.store,{keyPath:va.keyPath})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.Ce(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore(fa.store)}(e),this.Ne(i))))),n<7&&r>=7&&(s=s.next((()=>this.xe(i)))),n<8&&r>=8&&(s=s.next((()=>this.ke(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){const t=e.objectStore(da.store);t.createIndex(da.readTimeIndex,da.readTimeIndexPath,{unique:!1}),t.createIndex(da.collectionReadTimeIndex,da.collectionReadTimeIndexPath,{unique:!1})}(t)}))),n<10&&r>=10&&(s=s.next((()=>this.$e(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore(wa.store,{keyPath:wa.keyPath})}(e),function(e){e.createObjectStore(_a.store,{keyPath:_a.keyPath})}(e)}))),s}Ne(e){let t=0;return e.store(da.store).Kt(((e,n)=>{t+=oc(n)})).next((()=>{const n=new fa(t);return e.store(fa.store).put(fa.key,n)}))}Ce(e){const t=e.store(aa.store),n=e.store(ca.store);return t.Lt().next((t=>Ta.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.Lt(ca.userMutationsIndex,r).next((n=>Ta.forEach(n,(n=>{Rr(n.userId===t.userId);const r=$a(this.N,n);return sc(e,t.userId,r).next((()=>{}))}))))}))))}xe(e){const t=e.store(ma.store),n=e.store(da.store);return e.store(ga.store).get(ga.key).next((e=>{const r=[];return n.Kt(((n,i)=>{const s=new Xr(n),o=function(e){return[0,ta(e)]}(s);r.push(t.get(o).next((n=>n?Ta.resolve():(n=>t.put(new ma(0,ta(n),e.highestListenSequenceNumber)))(s))))})).next((()=>Ta.waitFor(r)))}))}ke(e,t){e.createObjectStore(ya.store,{keyPath:ya.keyPath});const n=t.store(ya.store),r=new ec,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:ta(r)})}};return t.store(da.store).Kt({qt:!0},((e,t)=>{const n=new Xr(e);return i(n.popLast())})).next((()=>t.store(ua.store).Kt({qt:!0},(([e,t,n],r)=>{const s=ia(t);return i(s.popLast())}))))}$e(e){const t=e.store(pa.store);return t.Kt(((e,n)=>{const r=Ka(n),i=Wa(this.N,r);return t.put(i)}))}}function Dc(e){e.createObjectStore(ma.store,{keyPath:ma.keyPath}).createIndex(ma.documentTargetsIndex,ma.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(pa.store,{keyPath:pa.keyPath}).createIndex(pa.queryTargetsIndexName,pa.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(ga.store)}const Pc="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class xc{constructor(e,t,n,r,i,s,o,a,c,u){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.Oe=i,this.window=s,this.document=o,this.Fe=c,this.Me=u,this.Le=null,this.Be=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ue=null,this.inForeground=!1,this.qe=null,this.Ke=null,this.je=Number.NEGATIVE_INFINITY,this.Qe=e=>Promise.resolve(),!xc.bt())throw new Dr(Or.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ic(this,r),this.We=t+"main",this.N=new Va(a),this.Ge=new Aa(this.We,11,new Oc(this.N)),this.ze=new fc(this.referenceDelegate,this.N),this.Ht=new tc,this.He=function(e,t){return new Ac(e,t)}(this.N,this.Ht),this.Je=new Qa,this.window&&this.window.localStorage?this.Ye=this.window.localStorage:(this.Ye=null,!1===u&&Sr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Xe().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Dr(Or.FAILED_PRECONDITION,Pc);return this.Ze(),this.tn(),this.en(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.ze.getHighestSequenceNumber(e)))})).then((e=>{this.Le=new Br(e,this.Fe)})).then((()=>{this.Be=!0})).catch((e=>(this.Ge&&this.Ge.close(),Promise.reject(e))))}nn(e){return this.Qe=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ge.xt((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Oe.enqueueAndForget((async()=>{this.started&&await this.Xe()})))}Xe(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Mc(e).put(new va(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next((()=>{if(this.isPrimary)return this.sn(e).next((e=>{e||(this.isPrimary=!1,this.Oe.enqueueRetryable((()=>this.Qe(!1))))}))})).next((()=>this.rn(e))).next((t=>this.isPrimary&&!t?this.on(e).next((()=>!1)):!!t&&this.an(e).next((()=>!0)))))).catch((e=>{if(Ra(e))return Tr("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Tr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Oe.enqueueRetryable((()=>this.Qe(e))),this.isPrimary=e}))}sn(e){return Lc(e).get(oa.key).next((e=>Ta.resolve(this.cn(e))))}un(e){return Mc(e).delete(this.clientId)}async hn(){if(this.isPrimary&&!this.ln(this.je,18e5)){this.je=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=La(e,va.store);return t.Lt().next((e=>{const n=this.fn(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return Ta.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.Ye)for(const t of e)this.Ye.removeItem(this.dn(t.clientId))}}en(){this.Ke=this.Oe.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Xe().then((()=>this.hn())).then((()=>this.en()))))}cn(e){return!!e&&e.ownerId===this.clientId}rn(e){return this.Me?Ta.resolve(!0):Lc(e).get(oa.key).next((t=>{if(null!==t&&this.ln(t.leaseTimestampMs,5e3)&&!this.wn(t.ownerId)){if(this.cn(t)&&this.networkEnabled)return!0;if(!this.cn(t)){if(!t.allowTabSynchronization)throw new Dr(Or.FAILED_PRECONDITION,Pc);return!1}}return!(!this.networkEnabled||!this.inForeground)||Mc(e).Lt().next((e=>void 0===this.fn(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&Tr("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.Be=!1,this._n(),this.Ke&&(this.Ke.cancel(),this.Ke=null),this.mn(),this.gn(),await this.Ge.runTransaction("shutdown","readwrite",[oa.store,va.store],(e=>{const t=new xa(e,Br.T);return this.on(t).next((()=>this.un(t)))})),this.Ge.close(),this.yn()}fn(e,t){return e.filter((e=>this.ln(e.updateTimeMs,t)&&!this.wn(e.clientId)))}pn(){return this.runTransaction("getActiveClients","readonly",(e=>Mc(e).Lt().next((e=>this.fn(e,18e5).map((e=>e.clientId))))))}get started(){return this.Be}getMutationQueue(e){return ac.Yt(e,this.N,this.Ht,this.referenceDelegate)}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getIndexManager(){return this.Ht}getBundleCache(){return this.Je}runTransaction(e,t,n){Tr("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite";let i;return this.Ge.runTransaction(e,r,ba,(r=>(i=new xa(r,this.Le?this.Le.next():Br.T),"readwrite-primary"===t?this.sn(i).next((e=>!!e||this.rn(i))).next((t=>{if(!t)throw Sr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Oe.enqueueRetryable((()=>this.Qe(!1))),new Dr(Or.FAILED_PRECONDITION,Ia);return n(i)})).next((e=>this.an(i).next((()=>e)))):this.En(i).next((()=>n(i)))))).then((e=>(i.raiseOnCommittedEvent(),e)))}En(e){return Lc(e).get(oa.key).next((e=>{if(null!==e&&this.ln(e.leaseTimestampMs,5e3)&&!this.wn(e.ownerId)&&!this.cn(e)&&!(this.Me||this.allowTabSynchronization&&e.allowTabSynchronization))throw new Dr(Or.FAILED_PRECONDITION,Pc)}))}an(e){const t=new oa(this.clientId,this.allowTabSynchronization,Date.now());return Lc(e).put(oa.key,t)}static bt(){return Aa.bt()}on(e){const t=Lc(e);return t.get(oa.key).next((e=>this.cn(e)?(Tr("IndexedDbPersistence","Releasing primary lease."),t.delete(oa.key)):Ta.resolve()))}ln(e,t){const n=Date.now();return!(e<n-t||e>n&&(Sr(`Detected an update time that is in the future: ${e} > ${n}`),1))}Ze(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.qe=()=>{this.Oe.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.Xe())))},this.document.addEventListener("visibilitychange",this.qe),this.inForeground="visible"===this.document.visibilityState)}mn(){this.qe&&(this.document.removeEventListener("visibilitychange",this.qe),this.qe=null)}tn(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Ue=()=>{this._n(),(0,c.G6)()&&navigator.appVersion.match("Version/14")&&this.Oe.enterRestrictedMode(!0),this.Oe.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Ue))}gn(){this.Ue&&(this.window.removeEventListener("pagehide",this.Ue),this.Ue=null)}wn(e){var t;try{const n=null!==(null===(t=this.Ye)||void 0===t?void 0:t.getItem(this.dn(e)));return Tr("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return Sr("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}_n(){if(this.Ye)try{this.Ye.setItem(this.dn(this.clientId),String(Date.now()))}catch(e){Sr("Failed to set zombie client id.",e)}}yn(){if(this.Ye)try{this.Ye.removeItem(this.dn(this.clientId))}catch(e){}}dn(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Lc(e){return La(e,oa.store)}function Mc(e){return La(e,va.store)}function Uc(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class Fc{constructor(e,t){this.progress=e,this.Tn=t}}class Vc{constructor(e,t,n){this.He=e,this.In=t,this.Ht=n}An(e,t){return this.In.getAllMutationBatchesAffectingDocumentKey(e,t).next((n=>this.Rn(e,t,n)))}Rn(e,t,n){return this.He.getEntry(e,t).next((e=>{for(const t of n)t.applyToLocalView(e);return e}))}bn(e,t){e.forEach(((e,n)=>{for(const e of t)e.applyToLocalView(n)}))}Pn(e,t){return this.He.getEntries(e,t).next((t=>this.vn(e,t).next((()=>t))))}vn(e,t){return this.In.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>this.bn(t,e)))}getDocumentsMatchingQuery(e,t,n){return function(e){return fi.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Vn(e,t.path):is(t)?this.Sn(e,t,n):this.Dn(e,t,n)}Vn(e,t){return this.An(e,new fi(t)).next((e=>{let t=so();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}Sn(e,t,n){const r=t.collectionGroup;let i=so();return this.Ht.getCollectionParents(e,r).next((s=>Ta.forEach(s,(s=>{const o=function(e,t){return new Ji(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,s.child(r));return this.Dn(e,o,n).next((e=>{e.forEach(((e,t)=>{i=i.insert(e,t)}))}))})).next((()=>i))))}Dn(e,t,n){let r,i;return this.He.getDocumentsMatchingQuery(e,t,n).next((n=>(r=n,this.In.getAllMutationBatchesAffectingQuery(e,t)))).next((t=>(i=t,this.Cn(e,i,r).next((e=>{r=e;for(const e of i)for(const t of e.mutations){const n=t.key;let i=r.get(n);null==i&&(i=Ci.newInvalidDocument(n),r=r.insert(n,i)),Ls(t,i,e.localWriteTime),i.isFoundDocument()||(r=r.remove(n))}}))))).next((()=>(r.forEach(((e,n)=>{hs(t,n)||(r=r.remove(e))})),r)))}Cn(e,t,n){let r=uo();for(const e of t)for(const t of e.mutations)t instanceof Bs&&null===n.get(t.key)&&(r=r.add(t.key));let i=n;return this.He.getEntries(e,r).next((e=>(e.forEach(((e,t)=>{t.isFoundDocument()&&(i=i.insert(e,t))})),i)))}}class Bc{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Nn=n,this.xn=r}static kn(e,t){let n=uo(),r=uo();for(const e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new Bc(e,t.fromCache,n,r)}}class jc{$n(e){this.On=e}getDocumentsMatchingQuery(e,t,n,r){return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(Kr.min())?this.Fn(e,t):this.On.Pn(e,r).next((i=>{const s=this.Mn(t,i);return(es(t)||ts(t))&&this.Ln(t.limitType,s,r,n)?this.Fn(e,t):(Er()<=a.in.DEBUG&&Tr("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ls(t)),this.On.getDocumentsMatchingQuery(e,t,n).next((e=>(s.forEach((t=>{e=e.insert(t.key,t)})),e))))}))}Mn(e,t){let n=new eo(ds(e));return t.forEach(((t,r)=>{hs(e,r)&&(n=n.add(r))})),n}Ln(e,t,n,r){if(n.size!==t.size)return!0;const i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Fn(e,t){return Er()<=a.in.DEBUG&&Tr("QueryEngine","Using full collection scan to execute query:",ls(t)),this.On.getDocumentsMatchingQuery(e,t,Kr.min())}}class qc{constructor(e,t,n,r){this.persistence=e,this.Bn=t,this.N=r,this.Un=new Js(zr),this.qn=new Tc((e=>Pi(e)),xi),this.Kn=Kr.min(),this.In=e.getMutationQueue(n),this.jn=e.getRemoteDocumentCache(),this.ze=e.getTargetCache(),this.Qn=new Vc(this.jn,this.In,this.persistence.getIndexManager()),this.Je=e.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Un)))}}function zc(e,t,n,r){return new qc(e,t,n,r)}async function Gc(e,t){const n=Cr(e);let r=n.In,i=n.Qn;const s=await n.persistence.runTransaction("Handle user change","readonly",(e=>{let s;return n.In.getAllMutationBatches(e).next((o=>(s=o,r=n.persistence.getMutationQueue(t),i=new Vc(n.jn,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e)))).next((t=>{const n=[],r=[];let o=uo();for(const e of s){n.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){r.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return i.Pn(e,o).next((e=>({Wn:e,removedBatchIds:n,addedBatchIds:r})))}))}));return n.In=r,n.Qn=i,n.Bn.$n(n.Qn),s}function Hc(e){const t=Cr(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.ze.getLastRemoteSnapshotVersion(e)))}function $c(e,t,n,r,i){let s=uo();return n.forEach((e=>s=s.add(e))),t.getEntries(e,s).next((e=>{let s=ro();return n.forEach(((n,o)=>{const a=e.get(n),c=(null==i?void 0:i.get(n))||r;o.isNoDocument()&&o.version.isEqual(Kr.min())?(t.removeEntry(n,c),s=s.insert(n,o)):!a.isValidDocument()||o.version.compareTo(a.version)>0||0===o.version.compareTo(a.version)&&a.hasPendingWrites?(t.addEntry(o,c),s=s.insert(n,o)):Tr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",a.version," Watch version:",o.version)})),s}))}function Kc(e,t){const n=Cr(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.In.getNextMutationBatchAfterBatchId(e,t))))}function Wc(e,t){const n=Cr(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.ze.getTargetData(e,t).next((i=>i?(r=i,Ta.resolve(r)):n.ze.allocateTargetId(e).next((i=>(r=new Fa(t,i,0,e.currentSequenceNumber),n.ze.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Un.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Un=n.Un.insert(e.targetId,e),n.qn.set(t,e.targetId)),e}))}async function Yc(e,t,n){const r=Cr(e),i=r.Un.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Ra(e))throw e;Tr("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.Un=r.Un.remove(t),r.qn.delete(i.target)}function Qc(e,t,n){const r=Cr(e);let i=Kr.min(),s=uo();return r.persistence.runTransaction("Execute query","readonly",(e=>function(e,t,n){const r=Cr(e),i=r.qn.get(n);return void 0!==i?Ta.resolve(r.Un.get(i)):r.ze.getTargetData(t,n)}(r,e,os(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.ze.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.Bn.getDocumentsMatchingQuery(e,t,n?i:Kr.min(),n?s:uo()))).next((e=>({documents:e,Gn:s})))))}function Jc(e,t){const n=Cr(e),r=Cr(n.ze),i=n.Un.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.Et(e,t).next((e=>e?e.target:null))))}function Xc(e){const t=Cr(e);return t.persistence.runTransaction("Get new document changes","readonly",(e=>function(e,t,n){const r=Cr(e);let i=ro(),s=qa(n);const o=Rc(t),a=IDBKeyRange.lowerBound(s,!0);return o.Kt({index:da.readTimeIndex,range:a},((e,t)=>{const n=Ba(r.N,t);i=i.insert(n.key,n),s=t.readTime})).next((()=>({Tn:i,readTime:za(s)})))}(t.jn,e,t.Kn))).then((({Tn:e,readTime:n})=>(t.Kn=n,e)))}async function Zc(e,t,n=uo()){const r=await Wc(e,os(Ya(t.bundledQuery))),i=Cr(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=No(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Je.saveNamedQuery(e,t);const o=r.withResumeToken(ni.EMPTY_BYTE_STRING,s);return i.Un=i.Un.insert(o.targetId,o),i.ze.updateTargetData(e,o).next((()=>i.ze.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.ze.addMatchingKeys(e,n,r.targetId))).next((()=>i.Je.saveNamedQuery(e,t)))}))}class eu{constructor(e){this.N=e,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(e,t){return Ta.resolve(this.Yn.get(t))}saveBundleMetadata(e,t){var n;return this.Yn.set(t.id,{id:(n=t).id,version:n.version,createTime:No(n.createTime)}),Ta.resolve()}getNamedQuery(e,t){return Ta.resolve(this.Xn.get(t))}saveNamedQuery(e,t){return this.Xn.set(t.name,function(e){return{name:e.name,query:Ya(e.bundledQuery),readTime:No(e.readTime)}}(t)),Ta.resolve()}}class tu{constructor(){this.Zn=new eo(nu.ts),this.es=new eo(nu.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(e,t){const n=new nu(e,t);this.Zn=this.Zn.add(n),this.es=this.es.add(n)}ss(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.rs(new nu(e,t))}os(e,t){e.forEach((e=>this.removeReference(e,t)))}cs(e){const t=new fi(new Xr([])),n=new nu(t,e),r=new nu(t,e+1),i=[];return this.es.forEachInRange([n,r],(e=>{this.rs(e),i.push(e.key)})),i}us(){this.Zn.forEach((e=>this.rs(e)))}rs(e){this.Zn=this.Zn.delete(e),this.es=this.es.delete(e)}hs(e){const t=new fi(new Xr([])),n=new nu(t,e),r=new nu(t,e+1);let i=uo();return this.es.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new nu(e,0),n=this.Zn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class nu{constructor(e,t){this.key=e,this.ls=t}static ts(e,t){return fi.comparator(e.key,t.key)||zr(e.ls,t.ls)}static ns(e,t){return zr(e.ls,t.ls)||fi.comparator(e.key,t.key)}}class ru{constructor(e,t){this.Ht=e,this.referenceDelegate=t,this.In=[],this.fs=1,this.ds=new eo(nu.ts)}checkEmpty(e){return Ta.resolve(0===this.In.length)}addMutationBatch(e,t,n,r){const i=this.fs;this.fs++,this.In.length>0&&this.In[this.In.length-1];const s=new Ma(i,t,n,r);this.In.push(s);for(const t of r)this.ds=this.ds.add(new nu(t.key,i)),this.Ht.addToCollectionParentIndex(e,t.key.path.popLast());return Ta.resolve(s)}lookupMutationBatch(e,t){return Ta.resolve(this.ws(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this._s(n),i=r<0?0:r;return Ta.resolve(this.In.length>i?this.In[i]:null)}getHighestUnacknowledgedBatchId(){return Ta.resolve(0===this.In.length?-1:this.fs-1)}getAllMutationBatches(e){return Ta.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new nu(t,0),r=new nu(t,Number.POSITIVE_INFINITY),i=[];return this.ds.forEachInRange([n,r],(e=>{const t=this.ws(e.ls);i.push(t)})),Ta.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new eo(zr);return t.forEach((e=>{const t=new nu(e,0),r=new nu(e,Number.POSITIVE_INFINITY);this.ds.forEachInRange([t,r],(e=>{n=n.add(e.ls)}))})),Ta.resolve(this.gs(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;fi.isDocumentKey(i)||(i=i.child(""));const s=new nu(new fi(i),0);let o=new eo(zr);return this.ds.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.ls)),!0)}),s),Ta.resolve(this.gs(o))}gs(e){const t=[];return e.forEach((e=>{const n=this.ws(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){Rr(0===this.ys(t.batchId,"removed")),this.In.shift();let n=this.ds;return Ta.forEach(t.mutations,(r=>{const i=new nu(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.ds=n}))}te(e){}containsKey(e,t){const n=new nu(t,0),r=this.ds.firstAfterOrEqual(n);return Ta.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.In.length,Ta.resolve()}ys(e,t){return this._s(e)}_s(e){return 0===this.In.length?0:e-this.In[0].batchId}ws(e){const t=this._s(e);return t<0||t>=this.In.length?null:this.In[t]}}class iu{constructor(e,t){this.Ht=e,this.ps=t,this.docs=new Js(fi.comparator),this.size=0}addEntry(e,t,n){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ps(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:o,readTime:n}),this.size+=o-s,this.Ht.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Ta.resolve(n?n.document.clone():Ci.newInvalidDocument(t))}getEntries(e,t){let n=ro();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.clone():Ci.newInvalidDocument(e))})),Ta.resolve(n)}getDocumentsMatchingQuery(e,t,n){let r=ro();const i=new fi(t.path.child("")),s=this.docs.getIteratorFrom(i);for(;s.hasNext();){const{key:e,value:{document:i,readTime:o}}=s.getNext();if(!t.path.isPrefixOf(e.path))break;o.compareTo(n)<=0||hs(t,i)&&(r=r.insert(i.key,i.clone()))}return Ta.resolve(r)}Es(e,t){return Ta.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new su(this)}getSize(e){return Ta.resolve(this.size)}}class su extends Sc{constructor(e){super(),this.Se=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.document.isValidDocument()?t.push(this.Se.addEntry(e,r.document,this.getReadTime(n))):this.Se.removeEntry(n)})),Ta.waitFor(t)}getFromCache(e,t){return this.Se.getEntry(e,t)}getAllFromCache(e,t){return this.Se.getEntries(e,t)}}class ou{constructor(e){this.persistence=e,this.Ts=new Tc((e=>Pi(e)),xi),this.lastRemoteSnapshotVersion=Kr.min(),this.highestTargetId=0,this.Is=0,this.As=new tu,this.targetCount=0,this.Rs=dc.se()}forEachTarget(e,t){return this.Ts.forEach(((e,n)=>t(n))),Ta.resolve()}getLastRemoteSnapshotVersion(e){return Ta.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ta.resolve(this.Is)}allocateTargetId(e){return this.highestTargetId=this.Rs.next(),Ta.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Is&&(this.Is=t),Ta.resolve()}ae(e){this.Ts.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.Rs=new dc(t),this.highestTargetId=t),e.sequenceNumber>this.Is&&(this.Is=e.sequenceNumber)}addTargetData(e,t){return this.ae(t),this.targetCount+=1,Ta.resolve()}updateTargetData(e,t){return this.ae(t),Ta.resolve()}removeTargetData(e,t){return this.Ts.delete(t.target),this.As.cs(t.targetId),this.targetCount-=1,Ta.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Ts.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Ts.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Ta.waitFor(i).next((()=>r))}getTargetCount(e){return Ta.resolve(this.targetCount)}getTargetData(e,t){const n=this.Ts.get(t)||null;return Ta.resolve(n)}addMatchingKeys(e,t,n){return this.As.ss(t,n),Ta.resolve()}removeMatchingKeys(e,t,n){this.As.os(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),Ta.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.As.cs(t),Ta.resolve()}getMatchingKeysForTargetId(e,t){const n=this.As.hs(t);return Ta.resolve(n)}containsKey(e,t){return Ta.resolve(this.As.containsKey(t))}}class au{constructor(e,t){this.bs={},this.Le=new Br(0),this.Be=!1,this.Be=!0,this.referenceDelegate=e(this),this.ze=new ou(this),this.Ht=new Za,this.He=function(e,t){return new iu(e,t)}(this.Ht,(e=>this.referenceDelegate.Ps(e))),this.N=new Va(t),this.Je=new eu(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(e){let t=this.bs[e.toKey()];return t||(t=new ru(this.Ht,this.referenceDelegate),this.bs[e.toKey()]=t),t}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(e,t,n){Tr("MemoryPersistence","Starting transaction:",e);const r=new cu(this.Le.next());return this.referenceDelegate.vs(),n(r).next((e=>this.referenceDelegate.Vs(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ss(e,t){return Ta.or(Object.values(this.bs).map((n=>()=>n.containsKey(e,t))))}}class cu extends Ea{constructor(e){super(),this.currentSequenceNumber=e}}class uu{constructor(e){this.persistence=e,this.Ds=new tu,this.Cs=null}static Ns(e){return new uu(e)}get xs(){if(this.Cs)return this.Cs;throw Nr()}addReference(e,t,n){return this.Ds.addReference(n,t),this.xs.delete(n.toString()),Ta.resolve()}removeReference(e,t,n){return this.Ds.removeReference(n,t),this.xs.add(n.toString()),Ta.resolve()}markPotentiallyOrphaned(e,t){return this.xs.add(t.toString()),Ta.resolve()}removeTarget(e,t){this.Ds.cs(t.targetId).forEach((e=>this.xs.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.xs.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}vs(){this.Cs=new Set}Vs(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ta.forEach(this.xs,(n=>{const r=fi.fromPath(n);return this.ks(e,r).next((e=>{e||t.removeEntry(r)}))})).next((()=>(this.Cs=null,t.apply(e))))}updateLimboDocument(e,t){return this.ks(e,t).next((e=>{e?this.xs.delete(t.toString()):this.xs.add(t.toString())}))}Ps(e){return 0}ks(e,t){return Ta.or([()=>Ta.resolve(this.Ds.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ss(e,t)])}}function lu(e,t){return`firestore_clients_${e}_${t}`}function hu(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function du(e,t){return`firestore_targets_${e}_${t}`}class fu{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static $s(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new Dr(r.error.code,r.error.message))),s?new fu(e,t,r.state,i):(Sr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Os(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pu{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static $s(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new Dr(n.error.code,n.error.message))),i?new pu(e,n.state,r):(Sr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Os(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class mu{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static $s(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=ho();for(let e=0;r&&e<n.activeTargetIds.length;++e)r=di(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new mu(e,i):(Sr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class gu{constructor(e,t){this.clientId=e,this.onlineState=t}static $s(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new gu(t.clientId,t.onlineState):(Sr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class yu{constructor(){this.activeTargetIds=ho()}Fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}Ms(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Os(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class vu{constructor(e,t,n,r,i){this.window=e,this.Oe=t,this.persistenceKey=n,this.Ls=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Bs=this.Us.bind(this),this.qs=new Js(zr),this.started=!1,this.Ks=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.js=lu(this.persistenceKey,this.Ls),this.Qs=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.qs=this.qs.insert(this.Ls,new yu),this.Ws=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Gs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.zs=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Hs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Js=function(e){return`firestore_bundle_loaded_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.Bs)}static bt(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.pn();for(const t of e){if(t===this.Ls)continue;const e=this.getItem(lu(this.persistenceKey,t));if(e){const n=mu.$s(t,e);n&&(this.qs=this.qs.insert(n.clientId,n))}}this.Ys();const t=this.storage.getItem(this.Hs);if(t){const e=this.Xs(t);e&&this.Zs(e)}for(const e of this.Ks)this.Us(e);this.Ks=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.Qs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ti(this.qs)}isActiveQueryTarget(e){let t=!1;return this.qs.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.ei(e,"pending")}updateMutationState(e,t,n){this.ei(e,t,n),this.ni(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){const n=this.storage.getItem(du(this.persistenceKey,e));if(n){const r=pu.$s(e,n);r&&(t=r.state)}}return this.si.Fs(e),this.Ys(),t}removeLocalQueryTarget(e){this.si.Ms(e),this.Ys()}isLocalQueryTarget(e){return this.si.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(du(this.persistenceKey,e))}updateQueryState(e,t,n){this.ii(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.ni(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.ri(e)}notifyBundleLoaded(){this.oi()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Bs),this.removeItem(this.js),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Tr("SharedClientState","READ",e,t),t}setItem(e,t){Tr("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Tr("SharedClientState","REMOVE",e),this.storage.removeItem(e)}Us(e){const t=e;if(t.storageArea===this.storage){if(Tr("SharedClientState","EVENT",t.key,t.newValue),t.key===this.js)return void Sr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Oe.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.Ws.test(t.key)){if(null==t.newValue){const e=this.ai(t.key);return this.ci(e,null)}{const e=this.ui(t.key,t.newValue);if(e)return this.ci(e.clientId,e)}}else if(this.Gs.test(t.key)){if(null!==t.newValue){const e=this.hi(t.key,t.newValue);if(e)return this.li(e)}}else if(this.zs.test(t.key)){if(null!==t.newValue){const e=this.fi(t.key,t.newValue);if(e)return this.di(e)}}else if(t.key===this.Hs){if(null!==t.newValue){const e=this.Xs(t.newValue);if(e)return this.Zs(e)}}else if(t.key===this.Qs){const e=function(e){let t=Br.T;if(null!=e)try{const n=JSON.parse(e);Rr("number"==typeof n),t=n}catch(e){Sr("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==Br.T&&this.sequenceNumberHandler(e)}else if(t.key===this.Js)return this.syncEngine.wi()}else this.Ks.push(t)}))}}get si(){return this.qs.get(this.Ls)}Ys(){this.setItem(this.js,this.si.Os())}ei(e,t,n){const r=new fu(this.currentUser,e,t,n),i=hu(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Os())}ni(e){const t=hu(this.persistenceKey,this.currentUser,e);this.removeItem(t)}ri(e){const t={clientId:this.Ls,onlineState:e};this.storage.setItem(this.Hs,JSON.stringify(t))}ii(e,t,n){const r=du(this.persistenceKey,e),i=new pu(e,t,n);this.setItem(r,i.Os())}oi(){this.setItem(this.Js,"value-not-used")}ai(e){const t=this.Ws.exec(e);return t?t[1]:null}ui(e,t){const n=this.ai(e);return mu.$s(n,t)}hi(e,t){const n=this.Gs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return fu.$s(new _r(i),r,t)}fi(e,t){const n=this.zs.exec(e),r=Number(n[1]);return pu.$s(r,t)}Xs(e){return gu.$s(e)}async li(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine._i(e.batchId,e.state,e.error);Tr("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}di(e){return this.syncEngine.mi(e.targetId,e.state,e.error)}ci(e,t){const n=t?this.qs.insert(e,t):this.qs.remove(e),r=this.ti(this.qs),i=this.ti(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.gi(s,o).then((()=>{this.qs=n}))}Zs(e){this.qs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ti(e){let t=ho();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class wu{constructor(){this.yi=new yu,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.yi.Fs(e),this.pi[e]||"not-current"}updateQueryState(e,t,n){this.pi[e]=t}removeLocalQueryTarget(e){this.yi.Ms(e)}isLocalQueryTarget(e){return this.yi.activeTargetIds.has(e)}clearQueryState(e){delete this.pi[e]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(e){return this.yi.activeTargetIds.has(e)}start(){return this.yi=new yu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(){}}class _u{Ei(e){}shutdown(){}}class bu{constructor(){this.Ti=()=>this.Ii(),this.Ai=()=>this.Ri(),this.bi=[],this.Pi()}Ei(e){this.bi.push(e)}shutdown(){window.removeEventListener("online",this.Ti),window.removeEventListener("offline",this.Ai)}Pi(){window.addEventListener("online",this.Ti),window.addEventListener("offline",this.Ai)}Ii(){Tr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.bi)e(0)}Ri(){Tr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.bi)e(1)}static bt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Iu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Eu{constructor(e){this.vi=e.vi,this.Vi=e.Vi}Si(e){this.Di=e}Ci(e){this.Ni=e}onMessage(e){this.xi=e}close(){this.Vi()}send(e){this.vi(e)}ki(){this.Di()}$i(e){this.Ni(e)}Oi(e){this.xi(e)}}class Tu extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http";this.Fi=t+"://"+e.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(e,t,n,r){const i=this.Bi(e,t);Tr("RestConnection","Sending: ",i,n);const s={};return this.Ui(s,r),this.qi(e,i,s,n).then((e=>(Tr("RestConnection","Received: ",e),e)),(t=>{throw Ar("RestConnection",`${e} failed with error: `,t,"url: ",i,"request:",n),t}))}Ki(e,t,n,r){return this.Li(e,t,n,r)}Ui(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/"+br,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t)for(const n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])}Bi(e,t){const n=Iu[e];return`${this.Fi}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}qi(e,t,n,r){return new Promise(((i,s)=>{const o=new wr;o.listenOnce(pr.COMPLETE,(()=>{try{switch(o.getLastErrorCode()){case fr.NO_ERROR:const t=o.getResponseJson();Tr("Connection","XHR received:",JSON.stringify(t)),i(t);break;case fr.TIMEOUT:Tr("Connection",'RPC "'+e+'" timed out'),s(new Dr(Or.DEADLINE_EXCEEDED,"Request time out"));break;case fr.HTTP_ERROR:const n=o.getStatus();if(Tr("Connection",'RPC "'+e+'" failed with status:',n,"response text:",o.getResponseText()),n>0){const e=o.getResponseJson().error;if(e&&e.status&&e.message){const t=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(Or).indexOf(t)>=0?t:Or.UNKNOWN}(e.status);s(new Dr(t,e.message))}else s(new Dr(Or.UNKNOWN,"Server responded with status "+o.getStatus()))}else s(new Dr(Or.UNAVAILABLE,"Connection failed."));break;default:Nr()}}finally{Tr("Connection",'RPC "'+e+'" completed.')}}));const a=JSON.stringify(r);o.send(t,"POST",a,n,15)}))}ji(e,t){const n=[this.Fi,"/","google.firestore.v1.Firestore","/",e,"/channel"],r=hr(),i=dr(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(s.xmlHttpFactory=new yr({})),this.Ui(s.initMessageHeaders,t),(0,c.uI)()||(0,c.b$)()||(0,c.d)()||(0,c.w1)()||(0,c.Mn)()||(0,c.ru)()||(s.httpHeadersOverwriteParam="$httpHeaders");const o=n.join("");Tr("Connection","Creating WebChannel: "+o,s);const a=r.createWebChannel(o,s);let u=!1,l=!1;const h=new Eu({vi:e=>{l?Tr("Connection","Not sending because WebChannel is closed:",e):(u||(Tr("Connection","Opening WebChannel transport."),a.open(),u=!0),Tr("Connection","WebChannel sending:",e),a.send(e))},Vi:()=>a.close()}),d=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return d(a,vr.EventType.OPEN,(()=>{l||Tr("Connection","WebChannel transport opened.")})),d(a,vr.EventType.CLOSE,(()=>{l||(l=!0,Tr("Connection","WebChannel transport closed"),h.$i())})),d(a,vr.EventType.ERROR,(e=>{l||(l=!0,Ar("Connection","WebChannel transport errored:",e),h.$i(new Dr(Or.UNAVAILABLE,"The operation could not be completed")))})),d(a,vr.EventType.MESSAGE,(e=>{var t;if(!l){const n=e.data[0];Rr(!!n);const r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){Tr("Connection","WebChannel received error:",i);const e=i.status;let t=function(e){const t=Ks[e];if(void 0!==t)return Qs(t)}(e),n=i.message;void 0===t&&(t=Or.INTERNAL,n="Unknown error status: "+e+" with message "+i.message),l=!0,h.$i(new Dr(t,n)),a.close()}else Tr("Connection","WebChannel received:",n),h.Oi(n)}})),d(i,mr.STAT_EVENT,(e=>{e.stat===gr.PROXY?Tr("Connection","Detected buffering proxy"):e.stat===gr.NOPROXY&&Tr("Connection","Detected no buffering proxy")})),setTimeout((()=>{h.ki()}),0),h}}function Su(){return"undefined"!=typeof window?window:null}function Au(){return"undefined"!=typeof document?document:null}function ku(e){return new To(e,!0)}class Nu{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Oe=e,this.timerId=t,this.Qi=n,this.Wi=r,this.Gi=i,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(e){this.cancel();const t=Math.floor(this.zi+this.Zi()),n=Math.max(0,Date.now()-this.Ji),r=Math.max(0,t-n);r>0&&Tr("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.zi} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,r,(()=>(this.Ji=Date.now(),e()))),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){null!==this.Hi&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){null!==this.Hi&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}}class Ru{constructor(e,t,n,r,i,s){this.Oe=e,this.er=n,this.nr=r,this.credentialsProvider=i,this.listener=s,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new Nu(e,t)}ar(){return 1===this.state||2===this.state||4===this.state}cr(){return 2===this.state}start(){3!==this.state?this.auth():this.ur()}async stop(){this.ar()&&await this.close(0)}hr(){this.state=0,this.rr.reset()}lr(){this.cr()&&null===this.ir&&(this.ir=this.Oe.enqueueAfterDelay(this.er,6e4,(()=>this.dr())))}wr(e){this._r(),this.stream.send(e)}async dr(){if(this.cr())return this.close(0)}_r(){this.ir&&(this.ir.cancel(),this.ir=null)}async close(e,t){this._r(),this.rr.cancel(),this.sr++,3!==e?this.rr.reset():t&&t.code===Or.RESOURCE_EXHAUSTED?(Sr(t.toString()),Sr("Using maximum backoff delay to prevent overloading the backend."),this.rr.Yi()):t&&t.code===Or.UNAUTHENTICATED&&this.credentialsProvider.invalidateToken(),null!==this.stream&&(this.mr(),this.stream.close(),this.stream=null),this.state=e,await this.listener.Ci(t)}mr(){}auth(){this.state=1;const e=this.gr(this.sr),t=this.sr;this.credentialsProvider.getToken().then((e=>{this.sr===t&&this.yr(e)}),(t=>{e((()=>{const e=new Dr(Or.UNKNOWN,"Fetching auth token failed: "+t.message);return this.pr(e)}))}))}yr(e){const t=this.gr(this.sr);this.stream=this.Er(e),this.stream.Si((()=>{t((()=>(this.state=2,this.listener.Si())))})),this.stream.Ci((e=>{t((()=>this.pr(e)))})),this.stream.onMessage((e=>{t((()=>this.onMessage(e)))}))}ur(){this.state=4,this.rr.Xi((async()=>{this.state=0,this.start()}))}pr(e){return Tr("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(3,e)}gr(e){return t=>{this.Oe.enqueueAndForget((()=>this.sr===e?t():(Tr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Cu extends Ru{constructor(e,t,n,r,i){super(e,"listen_stream_connection_backoff","listen_stream_idle",t,n,i),this.N=r}Er(e){return this.nr.ji("Listen",e)}onMessage(e){this.rr.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:Nr()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.D?(Rr(void 0===t||"string"==typeof t),ni.fromBase64String(t||"")):(Rr(void 0===t||t instanceof Uint8Array),ni.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?Or.UNKNOWN:Qs(e.code);return new Dr(t,e.message||"")}(o);n=new yo(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Do(e,r.document.name),s=No(r.document.updateTime),o=new Ni({mapValue:{fields:r.document.fields}}),a=Ci.newFoundDocument(i,s,o),c=r.targetIds||[],u=r.removedTargetIds||[];n=new mo(c,u,a.key,a)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Do(e,r.document),s=r.readTime?No(r.readTime):Kr.min(),o=Ci.newNoDocument(i,s),a=r.removedTargetIds||[];n=new mo([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Do(e,r.document),s=r.removedTargetIds||[];n=new mo([],s,i,null)}else{if(!("filter"in t))return Nr();{t.filter;const e=t.filter;e.targetId;const r=e.count||0,i=new $s(r),s=e.targetId;n=new go(s,i)}}return n}(this.N,e),n=function(e){if(!("targetChange"in e))return Kr.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Kr.min():t.readTime?No(t.readTime):Kr.min()}(e);return this.listener.Tr(t,n)}Ir(e){const t={};t.database=Lo(this.N),t.addTarget=function(e,t){let n;const r=t.target;return n=Li(r)?{documents:jo(e,r)}:{query:qo(e,r)},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=Ao(e,t.resumeToken):t.snapshotVersion.compareTo(Kr.min())>0&&(n.readTime=So(e,t.snapshotVersion.toTimestamp())),n}(this.N,e);const n=function(e,t){const n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Nr()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.N,e);n&&(t.labels=n),this.wr(t)}Ar(e){const t={};t.database=Lo(this.N),t.removeTarget=e,this.wr(t)}}class Ou extends Ru{constructor(e,t,n,r,i){super(e,"write_stream_connection_backoff","write_stream_idle",t,n,i),this.N=r,this.Rr=!1}get br(){return this.Rr}start(){this.Rr=!1,this.lastStreamToken=void 0,super.start()}mr(){this.Rr&&this.Pr([])}Er(e){return this.nr.ji("Write",e)}onMessage(e){if(Rr(!!e.streamToken),this.lastStreamToken=e.streamToken,this.Rr){this.rr.reset();const t=function(e,t){return e&&e.length>0?(Rr(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?No(e.updateTime):No(t);return n.isEqual(Kr.min())&&(n=No(t)),new Cs(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=No(e.commitTime);return this.listener.vr(n,t)}return Rr(!e.writeResults||0===e.writeResults.length),this.Rr=!0,this.listener.Vr()}Sr(){const e={};e.database=Lo(this.N),this.wr(e)}Pr(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Vo(this.N,e)))};this.wr(t)}}class Du extends class{}{constructor(e,t,n){super(),this.credentials=e,this.nr=t,this.N=n,this.Dr=!1}Cr(){if(this.Dr)throw new Dr(Or.FAILED_PRECONDITION,"The client has already been terminated.")}Li(e,t,n){return this.Cr(),this.credentials.getToken().then((r=>this.nr.Li(e,t,n,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Or.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new Dr(Or.UNKNOWN,e.toString())}))}Ki(e,t,n){return this.Cr(),this.credentials.getToken().then((r=>this.nr.Ki(e,t,n,r))).catch((e=>{throw"FirebaseError"===e.name?(e.code===Or.UNAUTHENTICATED&&this.credentials.invalidateToken(),e):new Dr(Or.UNKNOWN,e.toString())}))}terminate(){this.Dr=!0}}class Pu{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.Nr=0,this.kr=null,this.$r=!0}Or(){0===this.Nr&&(this.Fr("Unknown"),this.kr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.kr=null,this.Mr("Backend didn't respond within 10 seconds."),this.Fr("Offline"),Promise.resolve()))))}Lr(e){"Online"===this.state?this.Fr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.Fr("Offline")))}set(e){this.Br(),this.Nr=0,"Online"===e&&(this.$r=!1),this.Fr(e)}Fr(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}Mr(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.$r?(Sr(t),this.$r=!1):Tr("OnlineStateTracker",t)}Br(){null!==this.kr&&(this.kr.cancel(),this.kr=null)}}class xu{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ur=[],this.qr=new Map,this.Kr=new Set,this.jr=[],this.Qr=i,this.Qr.Ei((e=>{n.enqueueAndForget((async()=>{zu(this)&&(Tr("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=Cr(e);t.Kr.add(4),await Mu(t),t.Wr.set("Unknown"),t.Kr.delete(4),await Lu(t)}(this))}))})),this.Wr=new Pu(n,r)}}async function Lu(e){if(zu(e))for(const t of e.jr)await t(!0)}async function Mu(e){for(const t of e.jr)await t(!1)}function Uu(e,t){const n=Cr(e);n.qr.has(t.targetId)||(n.qr.set(t.targetId,t),qu(n)?ju(n):ol(n).cr()&&Vu(n,t))}function Fu(e,t){const n=Cr(e),r=ol(n);n.qr.delete(t),r.cr()&&Bu(n,t),0===n.qr.size&&(r.cr()?r.lr():zu(n)&&n.Wr.set("Unknown"))}function Vu(e,t){e.Gr.Y(t.targetId),ol(e).Ir(t)}function Bu(e,t){e.Gr.Y(t),ol(e).Ar(t)}function ju(e){e.Gr=new wo({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),Et:t=>e.qr.get(t)||null}),ol(e).start(),e.Wr.Or()}function qu(e){return zu(e)&&!ol(e).ar()&&e.qr.size>0}function zu(e){return 0===Cr(e).Kr.size}function Gu(e){e.Gr=void 0}async function Hu(e){e.qr.forEach(((t,n)=>{Vu(e,t)}))}async function $u(e,t){Gu(e),qu(e)?(e.Wr.Lr(t),ju(e)):e.Wr.set("Unknown")}async function Ku(e,t,n){if(e.Wr.set("Online"),t instanceof yo&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.qr.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.qr.delete(r),e.Gr.removeTarget(r))}(e,t)}catch(n){Tr("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Wu(e,n)}else if(t instanceof mo?e.Gr.rt(t):t instanceof go?e.Gr.ft(t):e.Gr.ct(t),!n.isEqual(Kr.min()))try{const t=await Hc(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Gr._t(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.qr.get(r);i&&e.qr.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((t=>{const n=e.qr.get(t);if(!n)return;e.qr.set(t,n.withResumeToken(ni.EMPTY_BYTE_STRING,n.snapshotVersion)),Bu(e,t);const r=new Fa(n.target,t,1,n.sequenceNumber);Vu(e,r)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Tr("RemoteStore","Failed to raise snapshot:",t),await Wu(e,t)}}async function Wu(e,t,n){if(!Ra(t))throw t;e.Kr.add(1),await Mu(e),e.Wr.set("Offline"),n||(n=()=>Hc(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Tr("RemoteStore","Retrying IndexedDB access"),await n(),e.Kr.delete(1),await Lu(e)}))}function Yu(e,t){return t().catch((n=>Wu(e,n,t)))}async function Qu(e){const t=Cr(e),n=al(t);let r=t.Ur.length>0?t.Ur[t.Ur.length-1].batchId:-1;for(;Ju(t);)try{const e=await Kc(t.localStore,r);if(null===e){0===t.Ur.length&&n.lr();break}r=e.batchId,Xu(t,e)}catch(e){await Wu(t,e)}Zu(t)&&el(t)}function Ju(e){return zu(e)&&e.Ur.length<10}function Xu(e,t){e.Ur.push(t);const n=al(e);n.cr()&&n.br&&n.Pr(t.mutations)}function Zu(e){return zu(e)&&!al(e).ar()&&e.Ur.length>0}function el(e){al(e).start()}async function tl(e){al(e).Sr()}async function nl(e){const t=al(e);for(const n of e.Ur)t.Pr(n.mutations)}async function rl(e,t,n){const r=e.Ur.shift(),i=Ua.from(r,t,n);await Yu(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Qu(e)}async function il(e,t){t&&al(e).br&&await async function(e,t){if(Ys(n=t.code)&&n!==Or.ABORTED){const n=e.Ur.shift();al(e).hr(),await Yu(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Qu(e)}var n}(e,t),Zu(e)&&el(e)}async function sl(e,t){const n=Cr(e);t?(n.Kr.delete(2),await Lu(n)):t||(n.Kr.add(2),await Mu(n),n.Wr.set("Unknown"))}function ol(e){return e.zr||(e.zr=function(e,t,n){const r=Cr(e);return r.Cr(),new Cu(t,r.nr,r.credentials,r.N,n)}(e.datastore,e.asyncQueue,{Si:Hu.bind(null,e),Ci:$u.bind(null,e),Tr:Ku.bind(null,e)}),e.jr.push((async t=>{t?(e.zr.hr(),qu(e)?ju(e):e.Wr.set("Unknown")):(await e.zr.stop(),Gu(e))}))),e.zr}function al(e){return e.Hr||(e.Hr=function(e,t,n){const r=Cr(e);return r.Cr(),new Ou(t,r.nr,r.credentials,r.N,n)}(e.datastore,e.asyncQueue,{Si:tl.bind(null,e),Ci:il.bind(null,e),Vr:nl.bind(null,e),vr:rl.bind(null,e)}),e.jr.push((async t=>{t?(e.Hr.hr(),await Qu(e)):(await e.Hr.stop(),e.Ur.length>0&&(Tr("RemoteStore",`Stopping write stream with ${e.Ur.length} pending writes`),e.Ur=[]))}))),e.Hr}class cl{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new Pr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new cl(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Dr(Or.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ul(e,t){if(Sr("AsyncQueue",`${t}: ${e}`),Ra(e))return new Dr(Or.UNAVAILABLE,`${t}: ${e}`);throw e}class ll{constructor(e){this.comparator=e?(t,n)=>e(t,n)||fi.comparator(t.key,n.key):(e,t)=>fi.comparator(e.key,t.key),this.keyedMap=so(),this.sortedSet=new Js(this.comparator)}static emptySet(e){return new ll(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ll))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new ll;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class hl{constructor(){this.Jr=new Js(fi.comparator)}track(e){const t=e.doc.key,n=this.Jr.get(t);n?0!==e.type&&3===n.type?this.Jr=this.Jr.insert(t,e):3===e.type&&1!==n.type?this.Jr=this.Jr.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Jr=this.Jr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Jr=this.Jr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Jr=this.Jr.remove(t):1===e.type&&2===n.type?this.Jr=this.Jr.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Jr=this.Jr.insert(t,{type:2,doc:e.doc}):Nr():this.Jr=this.Jr.insert(t,e)}Yr(){const e=[];return this.Jr.inorderTraversal(((t,n)=>{e.push(n)})),e}}class dl{constructor(e,t,n,r,i,s,o,a){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a}static fromInitialDocuments(e,t,n,r){const i=[];return t.forEach((e=>{i.push({type:0,doc:e})})),new dl(e,t,ll.emptySet(t),i,n,r,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cs(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}class fl{constructor(){this.Xr=void 0,this.listeners=[]}}class pl{constructor(){this.queries=new Tc((e=>us(e)),cs),this.onlineState="Unknown",this.Zr=new Set}}async function ml(e,t){const n=Cr(e),r=t.query;let i=!1,s=n.queries.get(r);if(s||(i=!0,s=new fl),i)try{s.Xr=await n.onListen(r)}catch(e){const n=ul(e,`Initialization of query '${ls(t.query)}' failed`);return void t.onError(n)}n.queries.set(r,s),s.listeners.push(t),t.eo(n.onlineState),s.Xr&&t.no(s.Xr)&&wl(n)}async function gl(e,t){const n=Cr(e),r=t.query;let i=!1;const s=n.queries.get(r);if(s){const e=s.listeners.indexOf(t);e>=0&&(s.listeners.splice(e,1),i=0===s.listeners.length)}if(i)return n.queries.delete(r),n.onUnlisten(r)}function yl(e,t){const n=Cr(e);let r=!1;for(const e of t){const t=e.query,i=n.queries.get(t);if(i){for(const t of i.listeners)t.no(e)&&(r=!0);i.Xr=e}}r&&wl(n)}function vl(e,t,n){const r=Cr(e),i=r.queries.get(t);if(i)for(const e of i.listeners)e.onError(n);r.queries.delete(t)}function wl(e){e.Zr.forEach((e=>{e.next()}))}class _l{constructor(e,t,n){this.query=e,this.so=t,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=n||{}}no(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new dl(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}let t=!1;return this.io?this.oo(e)&&(this.so.next(e),t=!0):this.ao(e,this.onlineState)&&(this.co(e),t=!0),this.ro=e,t}onError(e){this.so.error(e)}eo(e){this.onlineState=e;let t=!1;return this.ro&&!this.io&&this.ao(this.ro,e)&&(this.co(this.ro),t=!0),t}ao(e,t){if(!e.fromCache)return!0;const n="Offline"!==t;return!(this.options.uo&&n||e.docs.isEmpty()&&"Offline"!==t)}oo(e){if(e.docChanges.length>0)return!0;const t=this.ro&&this.ro.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}co(e){e=dl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.io=!0,this.so.next(e)}}class bl{constructor(e,t){this.payload=e,this.byteLength=t}ho(){return"metadata"in this.payload}}class Il{constructor(e){this.N=e}zn(e){return Do(this.N,e)}Hn(e){return e.metadata.exists?Fo(this.N,e.document,!1):Ci.newNoDocument(this.zn(e.metadata.name),this.Jn(e.metadata.readTime))}Jn(e){return No(e)}}class El{constructor(e,t,n){this.lo=e,this.localStore=t,this.N=n,this.queries=[],this.documents=[],this.progress=Tl(e)}fo(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}wo(e){const t=new Map,n=new Il(this.N);for(const r of e)if(r.metadata.queries){const e=n.zn(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||uo()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=Cr(e);let s=uo(),o=ro(),a=ao();for(const e of n){const n=t.zn(e.metadata.name);e.document&&(s=s.add(n)),o=o.insert(n,t.Hn(e)),a=a.insert(n,t.Jn(e.metadata.readTime))}const c=i.jn.newChangeBuffer({trackRemovals:!0}),u=await Wc(i,function(e){return os(Zi(Xr.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>$c(e,c,o,Kr.min(),a).next((t=>(c.apply(e),t))).next((t=>i.ze.removeMatchingKeysForTargetId(e,u.targetId).next((()=>i.ze.addMatchingKeys(e,s,u.targetId))).next((()=>i.Qn.vn(e,t))).next((()=>t))))))}(this.localStore,new Il(this.N),this.documents,this.lo.id),t=this.wo(this.documents);for(const e of this.queries)await Zc(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",new Fc(Object.assign({},this.progress),e)}}function Tl(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class Sl{constructor(e){this.key=e}}class Al{constructor(e){this.key=e}}class kl{constructor(e,t){this.query=e,this._o=t,this.mo=null,this.current=!1,this.yo=uo(),this.mutatedKeys=uo(),this.po=ds(e),this.Eo=new ll(this.po)}get To(){return this._o}Io(e,t){const n=t?t.Ao:new hl,r=t?t.Eo:this.Eo;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a=es(this.query)&&r.size===this.query.limit?r.last():null,c=ts(this.query)&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=hs(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.Ro(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.po(l,a)>0||c&&this.po(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),es(this.query)||ts(this.query))for(;s.size>this.query.limit;){const e=es(this.query)?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Eo:s,Ao:n,Ln:o,mutatedKeys:i}}Ro(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){const r=this.Eo;this.Eo=e.Eo,this.mutatedKeys=e.mutatedKeys;const i=e.Ao.Yr();i.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Nr()}};return n(e)-n(t)}(e.type,t.type)||this.po(e.doc,t.doc))),this.bo(n);const s=t?this.Po():[],o=0===this.yo.size&&this.current?1:0,a=o!==this.mo;return this.mo=o,0!==i.length||a?{snapshot:new dl(this.query,e.Eo,r,i,e.mutatedKeys,0===o,a,!1),vo:s}:{vo:s}}eo(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Eo:this.Eo,Ao:new hl,mutatedKeys:this.mutatedKeys,Ln:!1},!1)):{vo:[]}}Vo(e){return!this._o.has(e)&&!!this.Eo.has(e)&&!this.Eo.get(e).hasLocalMutations}bo(e){e&&(e.addedDocuments.forEach((e=>this._o=this._o.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this._o=this._o.delete(e))),this.current=e.current)}Po(){if(!this.current)return[];const e=this.yo;this.yo=uo(),this.Eo.forEach((e=>{this.Vo(e.key)&&(this.yo=this.yo.add(e.key))}));const t=[];return e.forEach((e=>{this.yo.has(e)||t.push(new Al(e))})),this.yo.forEach((n=>{e.has(n)||t.push(new Sl(n))})),t}So(e){this._o=e.Gn,this.yo=uo();const t=this.Io(e.documents);return this.applyChanges(t,!0)}Do(){return dl.fromInitialDocuments(this.query,this.Eo,this.mutatedKeys,0===this.mo)}}class Nl{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Rl{constructor(e){this.key=e,this.Co=!1}}class Cl{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.No={},this.xo=new Tc((e=>us(e)),cs),this.ko=new Map,this.$o=new Set,this.Oo=new Js(fi.comparator),this.Fo=new Map,this.Mo=new tu,this.Lo={},this.Bo=new Map,this.Uo=dc.ie(),this.onlineState="Unknown",this.qo=void 0}get isPrimaryClient(){return!0===this.qo}}async function Ol(e,t){const n=rh(e);let r,i;const s=n.xo.get(t);if(s)r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),i=s.view.Do();else{const e=await Wc(n.localStore,os(t)),s=n.sharedClientState.addLocalQueryTarget(e.targetId);r=e.targetId,i=await Dl(n,t,r,"current"===s),n.isPrimaryClient&&Uu(n.remoteStore,e)}return i}async function Dl(e,t,n,r){e.Ko=(t,n,r)=>async function(e,t,n,r){let i=t.view.Io(n);i.Ln&&(i=await Qc(e.localStore,t.query,!1).then((({documents:e})=>t.view.Io(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return zl(e,t.targetId,o.vo),o.snapshot}(e,t,n,r);const i=await Qc(e.localStore,t,!0),s=new kl(t,i.Gn),o=s.Io(i.documents),a=po.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),c=s.applyChanges(o,e.isPrimaryClient,a);zl(e,n,c.vo);const u=new Nl(t,n,s);return e.xo.set(t,u),e.ko.has(n)?e.ko.get(n).push(t):e.ko.set(n,[t]),c.snapshot}async function Pl(e,t){const n=Cr(e),r=n.xo.get(t),i=n.ko.get(r.targetId);if(i.length>1)return n.ko.set(r.targetId,i.filter((e=>!cs(e,t)))),void n.xo.delete(t);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)||await Yc(n.localStore,r.targetId,!1).then((()=>{n.sharedClientState.clearQueryState(r.targetId),Fu(n.remoteStore,r.targetId),jl(n,r.targetId)})).catch(yc)):(jl(n,r.targetId),await Yc(n.localStore,r.targetId,!0))}async function xl(e,t){const n=Cr(e);try{const e=await function(e,t){const n=Cr(e),r=t.snapshotVersion;let i=n.Un;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.jn.newChangeBuffer({trackRemovals:!0});i=n.Un;const o=[];t.targetChanges.forEach(((t,s)=>{const a=i.get(s);if(!a)return;o.push(n.ze.removeMatchingKeys(e,t.removedDocuments,s).next((()=>n.ze.addMatchingKeys(e,t.addedDocuments,s))));const c=t.resumeToken;if(c.approximateByteSize()>0){const u=a.withResumeToken(c,r).withSequenceNumber(e.currentSequenceNumber);i=i.insert(s,u),function(e,t,n){return Rr(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(a,u,t)&&o.push(n.ze.updateTargetData(e,u))}}));let a=ro();if(t.documentUpdates.forEach(((r,i)=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push($c(e,s,t.documentUpdates,r,void 0).next((e=>{a=e}))),!r.isEqual(Kr.min())){const t=n.ze.getLastRemoteSnapshotVersion(e).next((t=>n.ze.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return Ta.waitFor(o).next((()=>s.apply(e))).next((()=>n.Qn.vn(e,a))).next((()=>a))})).then((e=>(n.Un=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Fo.get(t);r&&(Rr(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.Co=!0:e.modifiedDocuments.size>0?Rr(r.Co):e.removedDocuments.size>0&&(Rr(r.Co),r.Co=!1))})),await $l(n,e,t)}catch(e){await yc(e)}}function Ll(e,t,n){const r=Cr(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.xo.forEach(((n,r)=>{const i=r.view.eo(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=Cr(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const e of n.listeners)e.eo(t)&&(r=!0)})),r&&wl(n)}(r.eventManager,t),e.length&&r.No.Tr(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Ml(e,t,n){const r=Cr(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Fo.get(t),s=i&&i.key;if(s){let e=new Js(fi.comparator);e=e.insert(s,Ci.newNoDocument(s,Kr.min()));const n=uo().add(s),i=new fo(Kr.min(),new Map,new eo(zr),e,n);await xl(r,i),r.Oo=r.Oo.remove(s),r.Fo.delete(t),Hl(r)}else await Yc(r.localStore,t,!1).then((()=>jl(r,t,n))).catch(yc)}async function Ul(e,t){const n=Cr(e),r=t.batch.batchId;try{const e=await function(e,t){const n=Cr(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.jn.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Ta.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);Rr(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))}))})),o.next((()=>e.In.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.In.performConsistencyCheck(e))).next((()=>n.Qn.Pn(e,r)))}))}(n.localStore,t);Bl(n,r,null),Vl(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await $l(n,e)}catch(e){await yc(e)}}async function Fl(e,t,n){const r=Cr(e);try{const e=await function(e,t){const n=Cr(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.In.lookupMutationBatch(e,t).next((t=>(Rr(null!==t),r=t.keys(),n.In.removeMutationBatch(e,t)))).next((()=>n.In.performConsistencyCheck(e))).next((()=>n.Qn.Pn(e,r)))}))}(r.localStore,t);Bl(r,t,n),Vl(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await $l(r,e)}catch(n){await yc(n)}}function Vl(e,t){(e.Bo.get(t)||[]).forEach((e=>{e.resolve()})),e.Bo.delete(t)}function Bl(e,t,n){const r=Cr(e);let i=r.Lo[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Lo[r.currentUser.toKey()]=i}}function jl(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.ko.get(t))e.xo.delete(r),n&&e.No.jo(r,n);e.ko.delete(t),e.isPrimaryClient&&e.Mo.cs(t).forEach((t=>{e.Mo.containsKey(t)||ql(e,t)}))}function ql(e,t){e.$o.delete(t.path.canonicalString());const n=e.Oo.get(t);null!==n&&(Fu(e.remoteStore,n),e.Oo=e.Oo.remove(t),e.Fo.delete(n),Hl(e))}function zl(e,t,n){for(const r of n)r instanceof Sl?(e.Mo.addReference(r.key,t),Gl(e,r)):r instanceof Al?(Tr("SyncEngine","Document no longer in limbo: "+r.key),e.Mo.removeReference(r.key,t),e.Mo.containsKey(r.key)||ql(e,r.key)):Nr()}function Gl(e,t){const n=t.key,r=n.path.canonicalString();e.Oo.get(n)||e.$o.has(r)||(Tr("SyncEngine","New document in limbo: "+n),e.$o.add(r),Hl(e))}function Hl(e){for(;e.$o.size>0&&e.Oo.size<e.maxConcurrentLimboResolutions;){const t=e.$o.values().next().value;e.$o.delete(t);const n=new fi(Xr.fromString(t)),r=e.Uo.next();e.Fo.set(r,new Rl(n)),e.Oo=e.Oo.insert(n,r),Uu(e.remoteStore,new Fa(os(Zi(n.path)),r,2,Br.T))}}async function $l(e,t,n){const r=Cr(e),i=[],s=[],o=[];r.xo.isEmpty()||(r.xo.forEach(((e,a)=>{o.push(r.Ko(a,t,n).then((e=>{if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);const t=Bc.kn(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.No.Tr(i),await async function(e,t){const n=Cr(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Ta.forEach(t,(t=>Ta.forEach(t.Nn,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Ta.forEach(t.xn,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Ra(e))throw e;Tr("LocalStore","Failed to update sequence numbers: "+e)}for(const e of t){const t=e.targetId;if(!e.fromCache){const e=n.Un.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Un=n.Un.insert(t,i)}}}(r.localStore,s))}async function Kl(e,t){const n=Cr(e);if(!n.currentUser.isEqual(t)){Tr("SyncEngine","User change. New user:",t.toKey());const e=await Gc(n.localStore,t);n.currentUser=t,function(e,t){e.Bo.forEach((e=>{e.forEach((e=>{e.reject(new Dr(Or.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Bo.clear()}(n),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await $l(n,e.Wn)}}function Wl(e,t){const n=Cr(e),r=n.Fo.get(t);if(r&&r.Co)return uo().add(r.key);{let e=uo();const r=n.ko.get(t);if(!r)return e;for(const t of r){const r=n.xo.get(t);e=e.unionWith(r.view.To)}return e}}async function Yl(e,t){const n=Cr(e),r=await Qc(n.localStore,t.query,!0),i=t.view.So(r);return n.isPrimaryClient&&zl(n,t.targetId,i.vo),i}async function Ql(e){const t=Cr(e);return Xc(t.localStore).then((e=>$l(t,e)))}async function Jl(e,t,n,r){const i=Cr(e),s=await function(e,t){const n=Cr(e),r=Cr(n.In);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.Xt(e,t).next((t=>t?n.Qn.Pn(e,t):Ta.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await Qu(i.remoteStore):"acknowledged"===n||"rejected"===n?(Bl(i,t,r||null),Vl(i,t),function(e,t){Cr(Cr(e).In).te(t)}(i.localStore,t)):Nr(),await $l(i,s)):Tr("SyncEngine","Cannot apply mutation batch with id: "+t)}async function Xl(e,t,n){const r=Cr(e),i=[],s=[];for(const e of t){let t;const n=r.ko.get(e);if(n&&0!==n.length){t=await Wc(r.localStore,os(n[0]));for(const e of n){const t=r.xo.get(e),n=await Yl(r,t);n.snapshot&&s.push(n.snapshot)}}else{const n=await Jc(r.localStore,e);t=await Wc(r.localStore,n),await Dl(r,Zl(n),e,!1)}i.push(t)}return r.No.Tr(s),i}function Zl(e){return Xi(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function eh(e){const t=Cr(e);return Cr(Cr(t.localStore).persistence).pn()}async function th(e,t,n,r){const i=Cr(e);if(i.qo)Tr("SyncEngine","Ignoring unexpected query state notification.");else if(i.ko.has(t))switch(n){case"current":case"not-current":{const e=await Xc(i.localStore),r=fo.createSynthesizedRemoteEventForCurrentChange(t,"current"===n);await $l(i,e,r);break}case"rejected":await Yc(i.localStore,t,!0),jl(i,t,r);break;default:Nr()}}async function nh(e,t,n){const r=rh(e);if(r.qo){for(const e of t){if(r.ko.has(e)){Tr("SyncEngine","Adding an already active target "+e);continue}const t=await Jc(r.localStore,e),n=await Wc(r.localStore,t);await Dl(r,Zl(t),n.targetId,!1),Uu(r.remoteStore,n)}for(const e of n)r.ko.has(e)&&await Yc(r.localStore,e,!1).then((()=>{Fu(r.remoteStore,e),jl(r,e)})).catch(yc)}}function rh(e){const t=Cr(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=xl.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Wl.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ml.bind(null,t),t.No.Tr=yl.bind(null,t.eventManager),t.No.jo=vl.bind(null,t.eventManager),t}function ih(e){const t=Cr(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Ul.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Fl.bind(null,t),t}class sh{constructor(){this.synchronizeTabs=!1}async initialize(e){this.N=ku(e.databaseInfo.databaseId),this.sharedClientState=this.Wo(e),this.persistence=this.Go(e),await this.persistence.start(),this.gcScheduler=this.zo(e),this.localStore=this.Ho(e)}zo(e){return null}Ho(e){return zc(this.persistence,new jc,e.initialUser,this.N)}Go(e){return new au(uu.Ns,this.N)}Wo(e){return new wu}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class oh extends sh{constructor(e,t,n){super(),this.Jo=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await async function(e){const t=Cr(e);return t.persistence.runTransaction("Synchronize last document change read time","readonly",(e=>function(e){const t=Rc(e);let n=Kr.min();return t.Kt({index:da.readTimeIndex,reverse:!0},((e,t,r)=>{t.readTime&&(n=za(t.readTime)),r.done()})).next((()=>n))}(e))).then((e=>{t.Kn=e}))}(this.localStore),await this.Jo.initialize(this,e),await ih(this.Jo.syncEngine),await Qu(this.Jo.remoteStore),await this.persistence.nn((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(this.localStore),Promise.resolve())))}Ho(e){return zc(this.persistence,new jc,e.initialUser,this.N)}zo(e){const t=this.persistence.referenceDelegate.garbageCollector;return new _c(t,e.asyncQueue)}Go(e){const t=Uc(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?ic.withCacheSize(this.cacheSizeBytes):ic.DEFAULT;return new xc(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Su(),Au(),this.N,this.sharedClientState,!!this.forceOwnership)}Wo(e){return new wu}}class ah extends oh{constructor(e,t){super(e,t,!1),this.Jo=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Jo.syncEngine;this.sharedClientState instanceof vu&&(this.sharedClientState.syncEngine={_i:Jl.bind(null,t),mi:th.bind(null,t),gi:nh.bind(null,t),pn:eh.bind(null,t),wi:Ql.bind(null,t)},await this.sharedClientState.start()),await this.persistence.nn((async e=>{await async function(e,t){const n=Cr(e);if(rh(n),ih(n),!0===t&&!0!==n.qo){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await Xl(n,e.toArray());n.qo=!0,await sl(n.remoteStore,!0);for(const e of t)Uu(n.remoteStore,e)}else if(!1===t&&!1!==n.qo){const e=[];let t=Promise.resolve();n.ko.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(jl(n,i),Yc(n.localStore,i,!0)))),Fu(n.remoteStore,i)})),await t,await Xl(n,e),function(e){const t=Cr(e);t.Fo.forEach(((e,n)=>{Fu(t.remoteStore,n)})),t.Mo.us(),t.Fo=new Map,t.Oo=new Js(fi.comparator)}(n),n.qo=!1,await sl(n.remoteStore,!1)}}(this.Jo.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop())}))}Wo(e){const t=Su();if(!vu.bt(t))throw new Dr(Or.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=Uc(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new vu(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class ch{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Ll(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Kl.bind(null,this.syncEngine),await sl(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new pl}createDatastore(e){const t=ku(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new Tu(r));var r;return function(e,t,n){return new Du(e,t,n)}(e.credentials,n,t)}createRemoteStore(e){return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>Ll(this.syncEngine,e,0),s=bu.bt()?new bu:new _u,new xu(t,n,r,i,s);var t,n,r,i,s}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Cl(e,t,n,r,i,s);return o&&(a.qo=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){const t=Cr(e);Tr("RemoteStore","RemoteStore shutting down."),t.Kr.add(5),await Mu(t),t.Qr.shutdown(),t.Wr.set("Unknown")}(this.remoteStore)}}function uh(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.reject("unimplemented")}}class lh{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Yo(this.observer.next,e)}error(e){this.observer.error?this.Yo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)}Xo(){this.muted=!0}Yo(e,t){this.muted||setTimeout((()=>{this.muted||e(t)}),0)}}class hh{constructor(e,t){this.Zo=e,this.N=t,this.metadata=new Pr,this.buffer=new Uint8Array,this.ta=new TextDecoder("utf-8"),this.ea().then((e=>{e&&e.ho()?this.metadata.resolve(e.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.payload)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Zo.cancel()}async getMetadata(){return this.metadata.promise}async Qo(){return await this.getMetadata(),this.ea()}async ea(){const e=await this.na();if(null===e)return null;const t=this.ta.decode(e),n=Number(t);isNaN(n)&&this.sa(`length string (${t}) is not valid number`);const r=await this.ia(n);return new bl(JSON.parse(r),e.length+n)}ra(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async na(){for(;this.ra()<0&&!await this.oa(););if(0===this.buffer.length)return null;const e=this.ra();e<0&&this.sa("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async ia(e){for(;this.buffer.length<e;)await this.oa()&&this.sa("Reached the end of bundle when more is expected.");const t=this.ta.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}sa(e){throw this.Zo.cancel(),new Error(`Invalid bundle format: ${e}`)}async oa(){const e=await this.Zo.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class dh{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new Dr(Or.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const t=await async function(e,t){const n=Cr(e),r=Lo(n.N)+"/documents",i={documents:t.map((e=>Oo(n.N,e)))},s=await n.Ki("BatchGetDocuments",r,i),o=new Map;s.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){Rr(!!t.found),t.found.name,t.found.updateTime;const n=Do(e,t.found.name),r=No(t.found.updateTime),i=new Ni({mapValue:{fields:t.found.fields}});return Ci.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){Rr(!!t.missing),Rr(!!t.readTime);const n=Do(e,t.missing),r=No(t.readTime);return Ci.newNoDocument(n,r)}(e,t):Nr()}(n.N,e);o.set(t.key.toString(),t)}));const a=[];return t.forEach((e=>{const t=o.get(e.toString());Rr(!!t),a.push(t)})),a}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new Gs(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=fi.fromPath(t);this.mutations.push(new Hs(n,this.precondition(n)))})),await async function(e,t){const n=Cr(e),r=Lo(n.N)+"/documents",i={writes:t.map((e=>Vo(n.N,e)))};await n.Li("Commit",r,i)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Nr();t=Kr.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Dr(Or.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?Os.updateTime(t):Os.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(Kr.min()))throw new Dr(Or.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Os.updateTime(t)}return Os.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class fh{constructor(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.aa=5,this.rr=new Nu(this.asyncQueue,"transaction_retry")}run(){this.aa-=1,this.ca()}ca(){this.rr.Xi((async()=>{const e=new dh(this.datastore),t=this.ua(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.ha(e)}))))})).catch((e=>{this.ha(e)}))}))}ua(e){try{const t=this.updateFunction(e);return!li(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ha(e){this.aa>0&&this.la(e)?(this.aa-=1,this.asyncQueue.enqueueAndForget((()=>(this.ca(),Promise.resolve())))):this.deferred.reject(e)}la(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||!Ys(t)}return!1}}class ph{constructor(e,t,n){this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=_r.UNAUTHENTICATED,this.clientId=qr.I(),this.credentialListener=()=>Promise.resolve(),this.credentials.start(t,(async e=>{Tr("FirestoreClient","Received user=",e.uid),await this.credentialListener(e),this.user=e}))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.credentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Dr(Or.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Pr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.credentials.shutdown(),e.resolve()}catch(t){const n=ul(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function mh(e,t){e.asyncQueue.verifyOperationInProgress(),Tr("FirestoreClient","Initializing OfflineComponentProvider");const n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await Gc(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e.offlineComponents=t}async function gh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await yh(e);Tr("FirestoreClient","Initializing OnlineComponentProvider");const r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener((e=>async function(e,t){const n=Cr(e);n.asyncQueue.verifyOperationInProgress(),Tr("RemoteStore","RemoteStore received new credentials");const r=zu(n);n.Kr.add(3),await Mu(n),r&&n.Wr.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Kr.delete(3),await Lu(n)}(t.remoteStore,e))),e.onlineComponents=t}async function yh(e){return e.offlineComponents||(Tr("FirestoreClient","Using default OfflineComponentProvider"),await mh(e,new sh)),e.offlineComponents}async function vh(e){return e.onlineComponents||(Tr("FirestoreClient","Using default OnlineComponentProvider"),await gh(e,new ch)),e.onlineComponents}function wh(e){return yh(e).then((e=>e.persistence))}function _h(e){return yh(e).then((e=>e.localStore))}function bh(e){return vh(e).then((e=>e.remoteStore))}function Ih(e){return vh(e).then((e=>e.syncEngine))}async function Eh(e){const t=await vh(e),n=t.eventManager;return n.onListen=Ol.bind(null,t.syncEngine),n.onUnlisten=Pl.bind(null,t.syncEngine),n}function Th(e,t,n={}){const r=new Pr;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new lh({next:s=>{t.enqueueAndForget((()=>gl(e,o)));const a=s.docs.has(n);!a&&s.fromCache?i.reject(new Dr(Or.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new Dr(Or.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new _l(Zi(n.path),s,{includeMetadataChanges:!0,uo:!0});return ml(e,o)}(await Eh(e),e.asyncQueue,t,n,r))),r.promise}function Sh(e,t,n={}){const r=new Pr;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new lh({next:n=>{t.enqueueAndForget((()=>gl(e,o))),n.fromCache&&"server"===r.source?i.reject(new Dr(Or.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new _l(n,s,{includeMetadataChanges:!0,uo:!0});return ml(e,o)}(await Eh(e),e.asyncQueue,t,n,r))),r.promise}function Ah(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?(new TextEncoder).encode(e):e,function(e,t){return new hh(e,t)}(function(e,t){if(e instanceof Uint8Array)return uh(e,t);if(e instanceof ArrayBuffer)return uh(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,ku(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=Cr(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=Cr(e),r=No(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.Je.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),void n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r));n._updateProgress(Tl(r));const i=new El(r,e.localStore,t.N);let s=await t.Qo();for(;s;){const e=await i.fo(s);e&&n._updateProgress(e),s=await t.Qo()}const o=await i.complete();await $l(e,o.Tn,void 0),await function(e,t){const n=Cr(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.Je.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress)}catch(e){Ar("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e)}})(r,t,n).then((()=>{r.sharedClientState.notifyBundleLoaded()}))}(await Ih(e),i,r)}))}class kh{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class Nh{constructor(e,t){this.projectId=e,this.database=t||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Nh&&e.projectId===this.projectId&&e.database===this.database}}const Rh=new Map;function Ch(e,t,n){if(!n)throw new Dr(Or.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Oh(e,t,n,r){if(!0===t&&!0===r)throw new Dr(Or.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function Dh(e){if(!fi.isDocumentKey(e))throw new Dr(Or.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Ph(e){if(fi.isDocumentKey(e))throw new Dr(Or.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function xh(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":Nr()}function Lh(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new Dr(Or.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=xh(e);throw new Dr(Or.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Mh(e,t){if(t<=0)throw new Dr(Or.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class Uh{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new Dr(Or.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new Dr(Or.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,Oh("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Fh{constructor(e,t){this._credentials=t,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Uh({}),this._settingsFrozen=!1,e instanceof Nh?this._databaseId=e:(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new Dr(Or.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Nh(e.options.projectId)}(e))}get app(){if(!this._app)throw new Dr(Or.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new Dr(Or.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Uh(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new Lr;switch(e.type){case"gapi":const t=e.client;return Rr(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new Vr(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new Dr(Or.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Rh.get(e);t&&(Tr("ComponentProvider","Removing Datastore"),Rh.delete(e),t.terminate())}(this),Promise.resolve()}}class Vh{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new jh(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vh(this.firestore,e,this._key)}}class Bh{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Bh(this.firestore,e,this._query)}}class jh extends Bh{constructor(e,t,n){super(e,t,Zi(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vh(this.firestore,null,new fi(e))}withConverter(e){return new jh(this.firestore,e,this._path)}}function qh(e,t,...n){if(e=(0,c.m9)(e),Ch("collection","path",t),e instanceof Fh){const r=Xr.fromString(t,...n);return Ph(r),new jh(e,null,r)}{if(!(e instanceof Vh||e instanceof jh))throw new Dr(Or.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Xr.fromString(t,...n));return Ph(r),new jh(e.firestore,null,r)}}function zh(e,t,...n){if(e=(0,c.m9)(e),1===arguments.length&&(t=qr.I()),Ch("doc","path",t),e instanceof Fh){const r=Xr.fromString(t,...n);return Dh(r),new Vh(e,null,new fi(r))}{if(!(e instanceof Vh||e instanceof jh))throw new Dr(Or.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Xr.fromString(t,...n));return Dh(r),new Vh(e.firestore,e instanceof jh?e.converter:null,new fi(r))}}function Gh(e,t){return e=(0,c.m9)(e),t=(0,c.m9)(t),(e instanceof Vh||e instanceof jh)&&(t instanceof Vh||t instanceof jh)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Hh(e,t){return e=(0,c.m9)(e),t=(0,c.m9)(t),e instanceof Bh&&t instanceof Bh&&e.firestore===t.firestore&&cs(e._query,t._query)&&e.converter===t.converter}class $h{constructor(){this.fa=Promise.resolve(),this.da=[],this.wa=!1,this._a=[],this.ma=null,this.ga=!1,this.ya=!1,this.pa=[],this.rr=new Nu(this,"async_queue_retry"),this.Ea=()=>{const e=Au();e&&Tr("AsyncQueue","Visibility state changed to "+e.visibilityState),this.rr.tr()};const e=Au();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Ea)}get isShuttingDown(){return this.wa}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Ta(),this.Ia(e)}enterRestrictedMode(e){if(!this.wa){this.wa=!0,this.ya=e||!1;const t=Au();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Ea)}}enqueue(e){if(this.Ta(),this.wa)return new Promise((()=>{}));const t=new Pr;return this.Ia((()=>this.wa&&this.ya?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.da.push(e),this.Aa())))}async Aa(){if(0!==this.da.length){try{await this.da[0](),this.da.shift(),this.rr.reset()}catch(e){if(!Ra(e))throw e;Tr("AsyncQueue","Operation failed with retryable error: "+e)}this.da.length>0&&this.rr.Xi((()=>this.Aa()))}}Ia(e){const t=this.fa.then((()=>(this.ga=!0,e().catch((e=>{throw this.ma=e,this.ga=!1,Sr("INTERNAL UNHANDLED ERROR: ",function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e})).then((e=>(this.ga=!1,e))))));return this.fa=t,t}enqueueAfterDelay(e,t,n){this.Ta(),this.pa.indexOf(e)>-1&&(t=0);const r=cl.createAndSchedule(this,e,t,n,(e=>this.Ra(e)));return this._a.push(r),r}Ta(){this.ma&&Nr()}verifyOperationInProgress(){}async ba(){let e;do{e=this.fa,await e}while(e!==this.fa)}Pa(e){for(const t of this._a)if(t.timerId===e)return!0;return!1}va(e){return this.ba().then((()=>{this._a.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this._a)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.ba()}))}Va(e){this.pa.push(e)}Ra(e){const t=this._a.indexOf(e);this._a.splice(t,1)}}function Kh(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of["next","error","complete"])if(e in n&&"function"==typeof n[e])return!0;return!1}(e)}class Wh{constructor(){this._progressObserver={},this._taskCompletionResolver=new Pr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class Yh extends Fh{constructor(e,t){super(e,t),this.type="firestore",this._queue=new $h,this._persistenceKey="name"in e?e.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||Jh(this),this._firestoreClient.terminate()}}function Qh(e){return e._firestoreClient||Jh(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Jh(e){var t;const n=e._freezeSettings(),r=function(e,t,n,r){return new kh(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new ph(e._credentials,e._queue,r)}function Xh(e,t,n){const r=new Pr;return e.asyncQueue.enqueue((async()=>{try{await mh(e,n),await gh(e,t),r.resolve()}catch(e){if(!function(e){return"FirebaseError"===e.name?e.code===Or.FAILED_PRECONDITION||e.code===Or.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||(22===e.code||20===e.code||11===e.code)}(e))throw e;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+e),r.reject(e)}})).then((()=>r.promise))}function Zh(e){return function(e){const t=new Pr;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=Cr(e);zu(n.remoteStore)||Tr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=Cr(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.In.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.Bo.get(e)||[];r.push(t),n.Bo.set(e,r)}catch(e){const n=ul(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await Ih(e),t))),t.promise}(Qh(e=Lh(e,Yh)))}function ed(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await wh(e),n=await bh(e);return t.setNetworkEnabled(!0),function(e){const t=Cr(e);return t.Kr.delete(0),Lu(t)}(n)}))}(Qh(e=Lh(e,Yh)))}function td(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await wh(e),n=await bh(e);return t.setNetworkEnabled(!1),async function(e){const t=Cr(e);t.Kr.add(0),await Mu(t),t.Wr.set("Offline")}(n)}))}(Qh(e=Lh(e,Yh)))}function nd(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=Cr(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.Je.getNamedQuery(e,t)))}(await _h(e),t)))}(Qh(e=Lh(e,Yh)),t).then((t=>t?new Bh(e,null,t.query):null))}function rd(e){if(e._initialized||e._terminated)throw new Dr(Or.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class id{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new Dr(Or.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ei(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class sd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sd(ni.fromBase64String(e))}catch(e){throw new Dr(Or.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new sd(ni.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class od{constructor(e){this._methodName=e}}class ad{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Dr(Or.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Dr(Or.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return zr(this._lat,e._lat)||zr(this._long,e._long)}}const cd=/^__.*__$/;class ud{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Bs(e,this.data,this.fieldMask,t,this.fieldTransforms):new Vs(e,this.data,t,this.fieldTransforms)}}class ld{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Bs(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function hd(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Nr()}}class dd{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.N=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Sa(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Da(){return this.settings.Da}Ca(e){return new dd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Na(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Ca({path:n,xa:!1});return r.ka(e),r}$a(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Ca({path:n,xa:!1});return r.Sa(),r}Oa(e){return this.Ca({path:void 0,xa:!0})}Fa(e){return Dd(e,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.La)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Sa(){if(this.path)for(let e=0;e<this.path.length;e++)this.ka(this.path.get(e))}ka(e){if(0===e.length)throw this.Fa("Document fields must not be empty");if(hd(this.Da)&&cd.test(e))throw this.Fa('Document fields cannot begin and end with "__"')}}class fd{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.N=n||ku(e)}Ba(e,t,n,r=!1){return new dd({Da:e,methodName:t,La:n,path:ei.emptyPath(),xa:!1,Ma:r},this.databaseId,this.N,this.ignoreUndefinedProperties)}}function pd(e){const t=e._freezeSettings(),n=ku(e._databaseId);return new fd(e._databaseId,!!t.ignoreUndefinedProperties,n)}function md(e,t,n,r,i,s={}){const o=e.Ba(s.merge||s.mergeFields?2:0,t,n,i);Nd("Data must be an object, but it was:",o,r);const a=Ad(r,o);let c,u;if(s.merge)c=new ti(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Rd(t,r,n);if(!o.contains(i))throw new Dr(Or.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Pd(e,i)||e.push(i)}c=new ti(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new ud(new Ni(a),c,u)}class gd extends od{_toFieldTransform(e){if(2!==e.Da)throw 1===e.Da?e.Fa(`${this._methodName}() can only appear at the top level of your update data`):e.Fa(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof gd}}function yd(e,t,n){return new dd({Da:3,La:t.settings.La,methodName:e._methodName,xa:n},t.databaseId,t.N,t.ignoreUndefinedProperties)}class vd extends od{_toFieldTransform(e){return new Rs(e.path,new bs)}isEqual(e){return e instanceof vd}}class wd extends od{constructor(e,t){super(e),this.Ua=t}_toFieldTransform(e){const t=yd(this,e,!0),n=this.Ua.map((e=>Sd(e,t))),r=new Is(n);return new Rs(e.path,r)}isEqual(e){return this===e}}class _d extends od{constructor(e,t){super(e),this.Ua=t}_toFieldTransform(e){const t=yd(this,e,!0),n=this.Ua.map((e=>Sd(e,t))),r=new Ts(n);return new Rs(e.path,r)}isEqual(e){return this===e}}class bd extends od{constructor(e,t){super(e),this.qa=t}_toFieldTransform(e){const t=new As(e.N,gs(e.N,this.qa));return new Rs(e.path,t)}isEqual(e){return this===e}}function Id(e,t,n,r){const i=e.Ba(1,t,n);Nd("Data must be an object, but it was:",i,r);const s=[],o=Ni.empty();Yr(r,((e,r)=>{const a=Od(t,e,n);r=(0,c.m9)(r);const u=i.$a(a);if(r instanceof gd)s.push(a);else{const e=Sd(r,u);null!=e&&(s.push(a),o.set(a,e))}}));const a=new ti(s);return new ld(o,a,i.fieldTransforms)}function Ed(e,t,n,r,i,s){const o=e.Ba(1,t,n),a=[Rd(t,r,n)],u=[i];if(s.length%2!=0)throw new Dr(Or.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)a.push(Rd(t,s[e])),u.push(s[e+1]);const l=[],h=Ni.empty();for(let e=a.length-1;e>=0;--e)if(!Pd(l,a[e])){const t=a[e];let n=u[e];n=(0,c.m9)(n);const r=o.$a(t);if(n instanceof gd)l.push(t);else{const e=Sd(n,r);null!=e&&(l.push(t),h.set(t,e))}}const d=new ti(l);return new ld(h,d,o.fieldTransforms)}function Td(e,t,n,r=!1){return Sd(n,e.Ba(r?4:3,t))}function Sd(e,t){if(kd(e=(0,c.m9)(e)))return Nd("Unsupported field value:",t,e),Ad(e,t);if(e instanceof od)return function(e,t){if(!hd(t.Da))throw t.Fa(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Fa(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xa&&4!==t.Da)throw t.Fa("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Sd(i,t.Oa(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,c.m9)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return gs(t.N,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=$r.fromDate(e);return{timestampValue:So(t.N,n)}}if(e instanceof $r){const n=new $r(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:So(t.N,n)}}if(e instanceof ad)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof sd)return{bytesValue:Ao(t.N,e._byteString)};if(e instanceof Vh){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Fa(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ro(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.Fa(`Unsupported field value: ${xh(e)}`)}(e,t)}function Ad(e,t){const n={};return Qr(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Yr(e,((e,r)=>{const i=Sd(r,t.Na(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function kd(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof $r||e instanceof ad||e instanceof sd||e instanceof Vh||e instanceof od)}function Nd(e,t,n){if(!kd(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=xh(n);throw"an object"===r?t.Fa(e+" a custom object"):t.Fa(e+" "+r)}}function Rd(e,t,n){if((t=(0,c.m9)(t))instanceof id)return t._internalPath;if("string"==typeof t)return Od(e,t);throw Dd("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}const Cd=new RegExp("[~\\*/\\[\\]]");function Od(e,t,n){if(t.search(Cd)>=0)throw Dd(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new id(...t.split("."))._internalPath}catch(r){throw Dd(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Dd(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new Dr(Or.INVALID_ARGUMENT,a+e+c)}function Pd(e,t){return e.some((e=>e.isEqual(t)))}class xd{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Vh(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Ld(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Md("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Ld extends xd{data(){return super.data()}}function Md(e,t){return"string"==typeof t?Od(e,t):t instanceof id?t._internalPath:t._delegate._internalPath}class Ud{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Fd extends xd{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Vd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Md("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Vd extends Fd{data(e={}){return super.data(e)}}class Bd{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ud(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Vd(this._firestore,this._userDataWriter,n.key,n,new Ud(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Dr(Or.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>({type:"added",doc:new Vd(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Ud(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter),oldIndex:-1,newIndex:t++})))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Vd(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ud(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:jd(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function jd(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Nr()}}function qd(e,t){return e instanceof Fd&&t instanceof Fd?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Bd&&t instanceof Bd&&e._firestore===t._firestore&&Hh(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function zd(e){if(ts(e)&&0===e.explicitOrderBy.length)throw new Dr(Or.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Gd{}function Hd(e,...t){for(const n of t)e=n._apply(e);return e}class $d extends Gd{constructor(e,t,n){super(),this.Ka=e,this.ja=t,this.Qa=n,this.type="where"}_apply(e){const t=pd(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new Dr(Or.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on FieldPath.documentId().`);if("in"===s||"not-in"===s){Zd(o,s);const t=[];for(const n of o)t.push(Xd(r,e,n));a={arrayValue:{values:t}}}else a=Xd(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Zd(o,s),a=Td(n,"where",o,"in"===s||"not-in"===s);const c=Mi.create(i,s,a);return function(e,t){if(t.v()){const n=rs(e);if(null!==n&&!n.isEqual(t.field))throw new Dr(Or.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${t.field.toString()}'`);const r=ns(e);null!==r&&ef(e,t.field,r)}const n=function(e,t){for(const n of e.filters)if(t.indexOf(n.op)>=0)return n.op;return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new Dr(Or.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new Dr(Or.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}(e,c),c}(e._query,0,t,e.firestore._databaseId,this.Ka,this.ja,this.Qa);return new Bh(e.firestore,e.converter,function(e,t){const n=e.filters.concat([t]);return new Ji(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))}}class Kd extends Gd{constructor(e,t){super(),this.Ka=e,this.Wa=t,this.type="orderBy"}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new Dr(Or.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new Dr(Or.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const r=new Ki(t,n);return function(e,t){if(null===ns(e)){const n=rs(e);null!==n&&ef(e,n,t.field)}}(e,r),r}(e._query,this.Ka,this.Wa);return new Bh(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Ji(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class Wd extends Gd{constructor(e,t,n){super(),this.type=e,this.Ga=t,this.za=n}_apply(e){return new Bh(e.firestore,e.converter,as(e._query,this.Ga,this.za))}}class Yd extends Gd{constructor(e,t,n){super(),this.type=e,this.Ha=t,this.Ja=n}_apply(e){const t=Jd(e,this.type,this.Ha,this.Ja);return new Bh(e.firestore,e.converter,function(e,t){return new Ji(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class Qd extends Gd{constructor(e,t,n){super(),this.type=e,this.Ha=t,this.Ja=n}_apply(e){const t=Jd(e,this.type,this.Ha,this.Ja);return new Bh(e.firestore,e.converter,function(e,t){return new Ji(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function Jd(e,t,n,r){if(n[0]=(0,c.m9)(n[0]),n[0]instanceof xd)return function(e,t,n,r,i){if(!r)throw new Dr(Or.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const n of ss(e))if(n.field.isKeyField())s.push(bi(t,r.key));else{const e=r.data.field(n.field);if(ai(e))throw new Dr(Or.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=n.field.canonicalString();throw new Dr(Or.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new Hi(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=pd(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new Dr(Or.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let s=0;s<i.length;s++){const c=i[s];if(o[s].field.isKeyField()){if("string"!=typeof c)throw new Dr(Or.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof c}`);if(!is(e)&&-1!==c.indexOf("/"))throw new Dr(Or.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${r}() must be a plain document ID, but '${c}' contains a slash.`);const n=e.path.child(Xr.fromString(c));if(!fi.isDocumentKey(n))throw new Dr(Or.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new fi(n);a.push(bi(t,i))}else{const e=Td(n,r,c);a.push(e)}}return new Hi(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Xd(e,t,n){if("string"==typeof(n=(0,c.m9)(n))){if(""===n)throw new Dr(Or.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!is(t)&&-1!==n.indexOf("/"))throw new Dr(Or.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Xr.fromString(n));if(!fi.isDocumentKey(r))throw new Dr(Or.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return bi(e,new fi(r))}if(n instanceof Vh)return bi(e,n._key);throw new Dr(Or.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${xh(n)}.`)}function Zd(e,t){if(!Array.isArray(e)||0===e.length)throw new Dr(Or.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`);if(e.length>10)throw new Dr(Or.INVALID_ARGUMENT,`Invalid Query. '${t.toString()}' filters support a maximum of 10 elements in the value array.`)}function ef(e,t,n){if(!n.isEqual(t))throw new Dr(Or.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class tf{convertValue(e,t="none"){switch(pi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return si(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(oi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw Nr()}}convertObject(e,t){const n={};return Yr(e.fields,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertGeoPoint(e){return new ad(si(e.latitude),si(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=ci(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ui(e));default:return null}}convertTimestamp(e){const t=ii(e);return new $r(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Xr.fromString(e);Rr(ea(n));const r=new Nh(n.get(1),n.get(3)),i=new fi(n.popFirst(5));return r.isEqual(t)||Sr(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function nf(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class rf extends tf{constructor(e){super(),this.firestore=e}convertBytes(e){return new sd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vh(this.firestore,null,t)}}class sf{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=pd(e)}set(e,t,n){this._verifyNotCommitted();const r=of(e,this._firestore),i=nf(r.converter,t,n),s=md(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Os.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=of(e,this._firestore);let s;return s="string"==typeof(t=(0,c.m9)(t))||t instanceof id?Ed(this._dataReader,"WriteBatch.update",i._key,t,n,r):Id(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,Os.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=of(e,this._firestore);return this._mutations=this._mutations.concat(new Gs(t._key,Os.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Dr(Or.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function of(e,t){if((e=(0,c.m9)(e)).firestore!==t)throw new Dr(Or.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class af extends tf{constructor(e){super(),this.firestore=e}convertBytes(e){return new sd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Vh(this.firestore,null,t)}}function cf(e){e=Lh(e,Vh);const t=Lh(e.firestore,Yh),n=Qh(t),r=new af(t);return function(e,t){const n=new Pr;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=Cr(e);return n.persistence.runTransaction("read document","readonly",(e=>n.Qn.An(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new Dr(Or.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=ul(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await _h(e),t,n))),n.promise}(n,e._key).then((n=>new Fd(t,r,e._key,n,new Ud(null!==n&&n.hasLocalMutations,!0),e.converter)))}function uf(e){e=Lh(e,Bh);const t=Lh(e.firestore,Yh),n=Qh(t),r=new af(t);return function(e,t){const n=new Pr;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await Qc(e,t,!0),i=new kl(t,r.Gn),s=i.Io(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=ul(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await _h(e),t,n))),n.promise}(n,e._query).then((n=>new Bd(t,r,e,n)))}function lf(e,t,n){e=Lh(e,Vh);const r=Lh(e.firestore,Yh),i=nf(e.converter,t,n);return pf(r,[md(pd(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Os.none())])}function hf(e,t,n,...r){e=Lh(e,Vh);const i=Lh(e.firestore,Yh),s=pd(i);let o;return o="string"==typeof(t=(0,c.m9)(t))||t instanceof id?Ed(s,"updateDoc",e._key,t,n,r):Id(s,"updateDoc",e._key,t),pf(i,[o.toMutation(e._key,Os.exists(!0))])}function df(e,...t){var n,r,i;e=(0,c.m9)(e);let s={includeMetadataChanges:!1},o=0;"object"!=typeof t[o]||Kh(t[o])||(s=t[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges};if(Kh(t[o])){const e=t[o];t[o]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[o+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[o+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}let u,l,h;if(e instanceof Vh)l=Lh(e.firestore,Yh),h=Zi(e._key.path),u={next:n=>{t[o]&&t[o](mf(l,e,n))},error:t[o+1],complete:t[o+2]};else{const n=Lh(e,Bh);l=Lh(n.firestore,Yh),h=n._query;const r=new af(l);u={next:e=>{t[o]&&t[o](new Bd(l,r,n,e))},error:t[o+1],complete:t[o+2]},zd(e._query)}return function(e,t,n,r){const i=new lh(r),s=new _l(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>ml(await Eh(e),s))),()=>{i.Xo(),e.asyncQueue.enqueueAndForget((async()=>gl(await Eh(e),s)))}}(Qh(l),h,a,u)}function ff(e,t){return function(e,t){const n=new lh(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){Cr(e).Zr.add(t),t.next()}(await Eh(e),n))),()=>{n.Xo(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){Cr(e).Zr.delete(t)}(await Eh(e),n)))}}(Qh(e=Lh(e,Yh)),Kh(t)?t:{next:t})}function pf(e,t){return function(e,t){const n=new Pr;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=ih(e);try{const e=await function(e,t){const n=Cr(e),r=$r.now(),i=t.reduce(((e,t)=>e.add(t.key)),uo());let s;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>n.Qn.Pn(e,i).next((i=>{s=i;const o=[];for(const e of t){const t=Ms(e,s.get(e.key));null!=t&&o.push(new Bs(e.key,t,Ri(t.value.mapValue),Os.exists(!0)))}return n.In.addMutationBatch(e,r,o,t)})))).then((e=>(e.applyToLocalDocumentSet(s),{batchId:e.batchId,changes:s})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Lo[e.currentUser.toKey()];r||(r=new Js(zr)),r=r.insert(t,n),e.Lo[e.currentUser.toKey()]=r}(r,e.batchId,n),await $l(r,e.changes),await Qu(r.remoteStore)}catch(e){const t=ul(e,"Failed to persist write");n.reject(t)}}(await Ih(e),t,n))),n.promise}(Qh(e),t)}function mf(e,t,n){const r=n.docs.get(t._key),i=new af(e);return new Fd(e,i,t._key,r,new Ud(n.hasPendingWrites,n.fromCache),t.converter)}class gf extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=pd(e)}get(e){const t=of(e,this._firestore),n=new rf(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return Nr();const r=e[0];if(r.isFoundDocument())return new xd(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new xd(this._firestore,n,t._key,null,t.converter);throw Nr()}))}set(e,t,n){const r=of(e,this._firestore),i=nf(r.converter,t,n),s=md(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){const i=of(e,this._firestore);let s;return s="string"==typeof(t=(0,c.m9)(t))||t instanceof id?Ed(this._dataReader,"Transaction.update",i._key,t,n,r):Id(this._dataReader,"Transaction.update",i._key,t),this._transaction.update(i._key,s),this}delete(e){const t=of(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=of(e,this._firestore),n=new af(this._firestore);return super.get(e).then((e=>new Fd(this._firestore,n,t._key,e._document,new Ud(!1,!1),t.converter)))}}function yf(e,t){return function(e,t){const n=new Pr;return e.asyncQueue.enqueueAndForget((async()=>{const r=await function(e){return vh(e).then((e=>e.datastore))}(e);new fh(e.asyncQueue,r,t,n).run()})),n.promise}(Qh(e),(n=>t(new gf(e,n))))}!function(e){br=e}(s.SDK_VERSION),(0,s._registerComponent)(new o.wA("firestore",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=new Yh(n,new Ur(e.getProvider("auth-internal")));return t=Object.assign({useFetchStreams:!0},t),r._setSettings(t),r}),"PUBLIC")),(0,s.registerVersion)("@firebase/firestore","3.1.0",undefined);function vf(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new Dr("invalid-argument",`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}function wf(){if("undefined"==typeof Uint8Array)throw new Dr("unimplemented","Uint8Arrays are not available in this environment.")}function _f(){if("undefined"==typeof atob)throw new Dr("unimplemented","Blobs are unavailable in Firestore in this environment.")}class bf{constructor(e){this._delegate=e}static fromBase64String(e){return _f(),new bf(sd.fromBase64String(e))}static fromUint8Array(e){return wf(),new bf(sd.fromUint8Array(e))}toBase64(){return _f(),this._delegate.toBase64()}toUint8Array(){return wf(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function If(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const e of t)if(e in n&&"function"==typeof n[e])return!0;return!1}(e,["next","error","complete"])}class Ef{enableIndexedDbPersistence(e,t){return function(e,t){rd(e=Lh(e,Yh));const n=Qh(e),r=e._freezeSettings(),i=new ch;return Xh(n,i,new oh(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function(e){rd(e=Lh(e,Yh));const t=Qh(e),n=e._freezeSettings(),r=new ch;return Xh(t,r,new ah(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function(e){if(e._initialized&&!e._terminated)throw new Dr(Or.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new Pr;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!Aa.bt())return Promise.resolve();const t=e+"main";await Aa.delete(t)}(Uc(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}(e._delegate)}}class Tf{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof Nh||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||Ar("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,n={}){!function(e,t,n,r={}){var i;const s=(e=Lh(e,Fh))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==t&&Ar("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},s),{host:`${t}:${n}`,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=_r.MOCK_USER;else{t=(0,c.Sg)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new Dr(Or.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new _r(s)}e._credentials=new Mr(new xr(t,n))}}(this._delegate,e,t,n)}enableNetwork(){return ed(this._delegate)}disableNetwork(){return td(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,Oh("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Zh(this._delegate)}onSnapshotsInSync(e){return ff(this._delegate,e)}get app(){if(!this._appCompat)throw new Dr("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Ff(this,qh(this._delegate,e))}catch(e){throw Cf(e,"collection()","Firestore.collection()")}}doc(e){try{return new Rf(this,zh(this._delegate,e))}catch(e){throw Cf(e,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Lf(this,function(e,t){if(e=Lh(e,Fh),Ch("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new Dr(Or.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Bh(e,null,function(e){return new Ji(Xr.emptyPath(),e)}(t))}(this._delegate,e))}catch(e){throw Cf(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return yf(this._delegate,(t=>e(new Af(this,t))))}batch(){return Qh(this._delegate),new kf(new sf(this._delegate,(e=>pf(this._delegate,e))))}loadBundle(e){return function(e,t){const n=Qh(e=Lh(e,Yh)),r=new Wh;return Ah(n,e._databaseId,t,r),r}(this._delegate,e)}namedQuery(e){return nd(this._delegate,e).then((e=>e?new Lf(this,e):null))}}class Sf extends tf{constructor(e){super(),this.firestore=e}convertBytes(e){return new bf(new sd(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Rf.forKey(t,this.firestore,null)}}class Af{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new Sf(e)}get(e){const t=Vf(e);return this._delegate.get(t).then((e=>new Pf(this._firestore,new Fd(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter))))}set(e,t,n){const r=Vf(e);return n?(vf("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=Vf(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=Vf(e);return this._delegate.delete(t),this}}class kf{constructor(e){this._delegate=e}set(e,t,n){const r=Vf(e);return n?(vf("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){const i=Vf(e);return 2===arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){const t=Vf(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Nf{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new Vd(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new xf(this._firestore,n),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=Nf.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new Nf(e,new Sf(e),t),r.set(t,i)),i}}Nf.INSTANCES=new WeakMap;class Rf{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Sf(e)}static forPath(e,t,n){if(e.length%2!=0)throw new Dr("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Rf(t,new Vh(t._delegate,n,new fi(e)))}static forKey(e,t,n){return new Rf(t,new Vh(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new Ff(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Ff(this.firestore,qh(this._delegate,e))}catch(e){throw Cf(e,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,c.m9)(e))instanceof Vh&&Gh(this._delegate,e)}set(e,t){t=vf("DocumentReference.set",t);try{return t?lf(this._delegate,e,t):lf(this._delegate,e)}catch(e){throw Cf(e,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{return 1===arguments.length?hf(this._delegate,e):hf(this._delegate,e,t,...n)}catch(e){throw Cf(e,"updateDoc()","DocumentReference.update()")}}delete(){return function(e){return pf(Lh(e.firestore,Yh),[new Gs(e._key,Os.none())])}(this._delegate)}onSnapshot(...e){const t=Of(e),n=Df(e,(e=>new Pf(this.firestore,new Fd(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))));return df(this._delegate,t,n)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?cf(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=Lh(e,Vh);const t=Lh(e.firestore,Yh);return Th(Qh(t),e._key,{source:"server"}).then((n=>mf(t,e,n)))}(this._delegate):function(e){e=Lh(e,Vh);const t=Lh(e.firestore,Yh);return Th(Qh(t),e._key).then((n=>mf(t,e,n)))}(this._delegate),t.then((e=>new Pf(this.firestore,new Fd(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))))}withConverter(e){return new Rf(this.firestore,e?this._delegate.withConverter(Nf.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Cf(e,t,n){return e.message=e.message.replace(t,n),e}function Of(e){for(const t of e)if("object"==typeof t&&!If(t))return t;return{}}function Df(e,t){var n,r;let i;return i=If(e[0])?e[0]:If(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class Pf{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Rf(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return qd(this._delegate,e._delegate)}}class xf extends Pf{data(e){const t=this._delegate.data(e);return function(e,t){e||Nr()}(void 0!==t),t}}class Lf{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new Sf(e)}where(e,t,n){try{return new Lf(this.firestore,Hd(this._delegate,function(e,t,n){const r=t,i=Md("where",e);return new $d(i,r,n)}(e,t,n)))}catch(e){throw Cf(e,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Lf(this.firestore,Hd(this._delegate,function(e,t="asc"){const n=t,r=Md("orderBy",e);return new Kd(r,n)}(e,t)))}catch(e){throw Cf(e,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Lf(this.firestore,Hd(this._delegate,function(e){return Mh("limit",e),new Wd("limit",e,"F")}(e)))}catch(e){throw Cf(e,"limit()","Query.limit()")}}limitToLast(e){try{return new Lf(this.firestore,Hd(this._delegate,function(e){return Mh("limitToLast",e),new Wd("limitToLast",e,"L")}(e)))}catch(e){throw Cf(e,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Lf(this.firestore,Hd(this._delegate,function(...e){return new Yd("startAt",e,!0)}(...e)))}catch(e){throw Cf(e,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Lf(this.firestore,Hd(this._delegate,function(...e){return new Yd("startAfter",e,!1)}(...e)))}catch(e){throw Cf(e,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Lf(this.firestore,Hd(this._delegate,function(...e){return new Qd("endBefore",e,!0)}(...e)))}catch(e){throw Cf(e,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Lf(this.firestore,Hd(this._delegate,function(...e){return new Qd("endAt",e,!1)}(...e)))}catch(e){throw Cf(e,"endAt()","Query.endAt()")}}isEqual(e){return Hh(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null==e?void 0:e.source)?uf(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=Lh(e,Bh);const t=Lh(e.firestore,Yh),n=Qh(t),r=new af(t);return Sh(n,e._query,{source:"server"}).then((n=>new Bd(t,r,e,n)))}(this._delegate):function(e){e=Lh(e,Bh);const t=Lh(e.firestore,Yh),n=Qh(t),r=new af(t);return zd(e._query),Sh(n,e._query).then((n=>new Bd(t,r,e,n)))}(this._delegate),t.then((e=>new Uf(this.firestore,new Bd(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))))}onSnapshot(...e){const t=Of(e),n=Df(e,(e=>new Uf(this.firestore,new Bd(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))));return df(this._delegate,t,n)}withConverter(e){return new Lf(this.firestore,e?this._delegate.withConverter(Nf.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Mf{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new xf(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Uf{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Lf(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map((e=>new xf(this._firestore,e)))}docChanges(e){return this._delegate.docChanges(e).map((e=>new Mf(this._firestore,e)))}forEach(e,t){this._delegate.forEach((n=>{e.call(t,new xf(this._firestore,n))}))}isEqual(e){return qd(this._delegate,e._delegate)}}class Ff extends Lf{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Rf(this.firestore,e):null}doc(e){try{return new Rf(this.firestore,void 0===e?zh(this._delegate):zh(this._delegate,e))}catch(e){throw Cf(e,"doc()","CollectionReference.doc()")}}add(e){return function(e,t){const n=Lh(e.firestore,Yh),r=zh(e),i=nf(e.converter,t);return pf(n,[md(pd(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Os.exists(!1))]).then((()=>r))}(this._delegate,e).then((e=>new Rf(this.firestore,e)))}isEqual(e){return Gh(this._delegate,e._delegate)}withConverter(e){return new Ff(this.firestore,e?this._delegate.withConverter(Nf.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Vf(e){return Lh(e,Vh)}class Bf{constructor(...e){this._delegate=new id(...e)}static documentId(){return new Bf(ei.keyField().canonicalString())}isEqual(e){return(e=(0,c.m9)(e))instanceof id&&this._delegate._internalPath.isEqual(e._internalPath)}}class jf{constructor(e){this._delegate=e}static serverTimestamp(){const e=new vd("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new jf(e)}static delete(){const e=new gd("deleteField");return e._methodName="FieldValue.delete",new jf(e)}static arrayUnion(...e){const t=function(...e){return new wd("arrayUnion",e)}(...e);return t._methodName="FieldValue.arrayUnion",new jf(t)}static arrayRemove(...e){const t=function(...e){return new _d("arrayRemove",e)}(...e);return t._methodName="FieldValue.arrayRemove",new jf(t)}static increment(e){const t=function(e){return new bd("increment",e)}(e);return t._methodName="FieldValue.increment",new jf(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const qf={Firestore:Tf,GeoPoint:ad,Timestamp:$r,Blob:bf,Transaction:Af,WriteBatch:kf,DocumentReference:Rf,DocumentSnapshot:Pf,Query:Lf,QueryDocumentSnapshot:xf,QuerySnapshot:Uf,CollectionReference:Ff,FieldPath:Bf,FieldValue:jf,setLogLevel:function(e){!function(e){Ir.setLogLevel(e)}(e)},CACHE_SIZE_UNLIMITED:-1};var zf,Gf;zf=i.Z,Gf=(e,t)=>new Tf(e,t,new Ef),zf.INTERNAL.registerComponent(new o.wA("firestore-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("firestore").getImmediate();return Gf(t,n)}),"PUBLIC").setServiceProps(Object.assign({},qf))),zf.registerVersion("@firebase/firestore-compat","0.1.3")},7741:(e,t,n)=>{"use strict";n.r(t);var r=n(7238),i=n(774),s=n(909);class o{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}class a{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new o(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then((t=>{if(e)return e(new o(t,this,this._ref))}),t)}on(e,t,n,r){let i;return t&&(i="function"==typeof t?e=>t(new o(e,this,this._ref)):{next:t.next?e=>t.next(new o(e,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,n||void 0,r||void 0)}}class c{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map((e=>new u(e,this._service)))}get items(){return this._delegate.items.map((e=>new u(e,this._service)))}get nextPageToken(){return this._delegate.nextPageToken||null}}class u{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){const t=(0,i.g6)(this._delegate,e);return new u(t,this.storage)}get root(){return new u(this._delegate.root,this.storage)}get parent(){const e=this._delegate.parent;return null==e?null:new u(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new a((0,i.B0)(this._delegate,e,t),this)}putString(e,t=i.bm.RAW,n){this._throwIfRoot("putString");const r=(0,i.qm)(t,e),s=Object.assign({},n);return null==s.contentType&&null!=r.contentType&&(s.contentType=r.contentType),new a(new i.IX(this._delegate,new i.UJ(r.data,!0),s),this)}listAll(){return(0,i.aF)(this._delegate).then((e=>new c(e,this.storage)))}list(e){return(0,i.pb)(this._delegate,e||void 0).then((e=>new c(e,this.storage)))}getMetadata(){return(0,i.sd)(this._delegate)}updateMetadata(e){return(0,i.Ym)(this._delegate,e)}getDownloadURL(){return(0,i.Jt)(this._delegate)}delete(){return this._throwIfRoot("delete"),(0,i.oq)(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw(0,i.y4)(e)}}class l{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(h(e))throw(0,i.gH)("ref() expected a child path but got a URL, use refFromURL instead.");return new u((0,i.iH)(this._delegate,e),this)}refFromURL(e){if(!h(e))throw(0,i.gH)("refFromURL() expected a full URL but got a child path, use ref() instead.");try{i.gE.makeFromUrl(e,this._delegate.host)}catch(e){throw(0,i.gH)("refFromUrl() expected a valid full URL but got an invalid one.")}return new u((0,i.iH)(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,n={}){(0,i.a1)(this._delegate,e,t,n)}}function h(e){return/^[A-Za-z]+:\/\//.test(e)}function d(e,{instanceIdentifier:t}){const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("storage").getImmediate({identifier:t});return new l(n,r)}!function(e){const t={TaskState:i.$Y,TaskEvent:i.FN,StringFormat:i.bm,Storage:l,Reference:u};e.INTERNAL.registerComponent(new s.wA("storage-compat",d,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.1.3")}(r.Z)},3404:(e,t,n)=>{"use strict";n.r(t),n.d(t,{StringFormat:()=>r.bm,_FbsBlob:()=>r.UJ,_Location:()=>r.gE,_TaskEvent:()=>r.FN,_TaskState:()=>r.$Y,_UploadTask:()=>r.IX,_dataFromString:()=>r.qm,_getChild:()=>r.g6,_invalidArgument:()=>r.gH,_invalidRootOperation:()=>r.y4,connectStorageEmulator:()=>r.a1,deleteObject:()=>r.oq,getDownloadURL:()=>r.Jt,getMetadata:()=>r.sd,getStorage:()=>r.cF,list:()=>r.pb,listAll:()=>r.aF,ref:()=>r.iH,updateMetadata:()=>r.Ym,uploadBytes:()=>r.KV,uploadBytesResumable:()=>r.B0,uploadString:()=>r.sf});var r=n(774)},8676:function(e,t){!function(e){"use strict";function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function r(e,t,r){var i,s=new Promise((function(s,o){n(i=e[t].apply(e,r)).then(s,o)}));return s.request=i,s}function i(e,t,n){var i=r(e,t,n);return i.then((function(e){if(e)return new l(e,i.request)}))}function s(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function o(e,t,n,i){i.forEach((function(i){i in n.prototype&&(e.prototype[i]=function(){return r(this[t],i,arguments)})}))}function a(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function c(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return i(this[t],r,arguments)})}))}function u(e){this._index=e}function l(e,t){this._cursor=e,this._request=t}function h(e){this._store=e}function d(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function f(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new d(n)}function p(e){this._db=e}function m(e,t,n){var i=r(indexedDB,"open",[e,t]),s=i.request;return s&&(s.onupgradeneeded=function(e){n&&n(new f(s.result,e.oldVersion,s.transaction))}),i.then((function(e){return new p(e)}))}function g(e){return r(indexedDB,"deleteDatabase",[e])}s(u,"_index",["name","keyPath","multiEntry","unique"]),o(u,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),c(u,"_index",IDBIndex,["openCursor","openKeyCursor"]),s(l,"_cursor",["direction","key","primaryKey","value"]),o(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(l.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,r),n(t._request).then((function(e){if(e)return new l(e,t._request)}))}))})})),h.prototype.createIndex=function(){return new u(this._store.createIndex.apply(this._store,arguments))},h.prototype.index=function(){return new u(this._store.index.apply(this._store,arguments))},s(h,"_store",["name","keyPath","indexNames","autoIncrement"]),o(h,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),c(h,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),a(h,"_store",IDBObjectStore,["deleteIndex"]),d.prototype.objectStore=function(){return new h(this._tx.objectStore.apply(this._tx,arguments))},s(d,"_tx",["objectStoreNames","mode"]),a(d,"_tx",IDBTransaction,["abort"]),f.prototype.createObjectStore=function(){return new h(this._db.createObjectStore.apply(this._db,arguments))},s(f,"_db",["name","version","objectStoreNames"]),a(f,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new d(this._db.transaction.apply(this._db,arguments))},s(p,"_db",["name","version","objectStoreNames"]),a(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[h,u].forEach((function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),r=n[n.length-1],i=this._store||this._index,s=i[e].apply(i,n.slice(0,-1));s.onsuccess=function(){r(s.result)}})}))})),[u,h].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(i){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)}))}))})})),e.openDb=m,e.deleteDb=g,Object.defineProperty(e,"__esModule",{value:!0})}(t)},8931:(e,t,n)=>{"use strict";n.r(t)},3808:(e,t,n)=>{"use strict";n.r(t)},8018:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"header_home-wrapper":"_mB3P3x9Lz87Dv7Mldt5"}},7331:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"login-form-wrapper":"DF8lZYmESA_ifN1NzOG9","login-form_btn":"IlBqhYLNUzu2ZdxfENQf"}},6462:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"signup-form-wrapper":"D9y8v6TleNABX7NjK3iu","login-form-wrapper":"_Y5CMl_4DNbo61Yzp_dx","signup-form_btn":"ssvo692OZWMfuPBHhBBL"}},5914:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"social-auth-wrapper":"nftW93bzlmMXY_SOCXSU"}},2269:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"social-button-wrapper":"ZDbwBApJBKxEY7_NCHH6","social-button":"ZgejbGT48w3VS8VY0BVQ"}},9572:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"mode-controller-wrapper":"dJCGfprsFmMxsfHlGrcb","mode-controller_signup":"Zpywnk1nUjczIM1QrDj_","mode-controller_login":"TmY6lQ_bPA2gkwsh3CYn"}},7292:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"members-bar-wrapper":"auYLO0w42uXPWYl_9bVr","member-btn":"aLaSDw8FzBo8Djfjm7FC"}},2296:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"search-bar-wrapper":"_FqKy7xUjsFgSxwyxsd_",search_input:"ZtZhqaJ5lxidTNPXUGN7"}},6411:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"search-result-item-wrapper":"kdzsXMVNSZAHy9xPMFdh",title:"Xh2kZ_4urZ9qRpaovohF"}},1281:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"search-results-wrapper":"yqYMLEsJBSMyD7qtZqbY"}},3092:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"theme-switch-container":"_ZF_04w_kRPSzoy3Aj23","theme-switch-wrapper":"_Dfqufqo1qbNGu598CuP","theme-switch-element":"AGHA5q1bddr29h8W1PRY",span:"ONOIcOCB9QFxrwoVOlTA"}},9917:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"default-list-wrapper":"Yc6D_GRR4qhUxfgXNtkf",container:"_98rDmbboXO_PUcyInHU",title:"rsTqWe7_CqgKho1Tku02"}},735:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"default-list-item-wrapper":"uxyLlV8DLZYi3HM2r2O5"}},4890:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"nav-button-back":"_ojoLmgCBpTYu_d014bu","nav-button-forth":"_0VN_WlMln6Nr5iQY729"}},236:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>r});const r={"movies-default-wrapper":"IxxOqOSIXknmobHGAa4s",title:"ZJuvPoPmvJxRFkdtv02s"}},5088:e=>{e.exports=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";var r={MOBILE:"mobile",TABLET:"tablet",SMART_TV:"smarttv",CONSOLE:"console",WEARABLE:"wearable",BROWSER:void 0};e.exports={BROWSER_TYPES:{CHROME:"Chrome",FIREFOX:"Firefox",OPERA:"Opera",YANDEX:"Yandex",SAFARI:"Safari",INTERNET_EXPLORER:"Internet Explorer",EDGE:"Edge",CHROMIUM:"Chromium",IE:"IE",MOBILE_SAFARI:"Mobile Safari",EDGE_CHROMIUM:"Edge Chromium"},DEVICE_TYPES:r,OS_TYPES:{IOS:"iOS",ANDROID:"Android",WINDOWS_PHONE:"Windows Phone",WINDOWS:"Windows",MAC_OS:"Mac OS"},defaultData:{isMobile:!1,isTablet:!1,isBrowser:!1,isSmartTV:!1,isConsole:!1,isWearable:!1}}},function(e,t,n){"use strict";var r,i=n(2),s=n(0),o=s.BROWSER_TYPES,a=s.OS_TYPES,c=s.DEVICE_TYPES,u=n(4),l=u.checkType,h=u.broPayload,d=u.mobilePayload,f=u.wearPayload,p=u.consolePayload,m=u.stvPayload,g=u.getNavigatorInstance,y=u.isIOS13Check,v=new i,w=v.getBrowser(),_=v.getDevice(),b=v.getEngine(),I=v.getOS(),E=v.getUA(),T=o.CHROME,S=o.CHROMIUM,A=o.IE,k=o.INTERNET_EXPLORER,N=o.OPERA,R=o.FIREFOX,C=o.SAFARI,O=o.EDGE,D=o.YANDEX,P=o.MOBILE_SAFARI,x=c.MOBILE,L=c.TABLET,M=c.SMART_TV,U=c.BROWSER,F=c.WEARABLE,V=c.CONSOLE,B=a.ANDROID,j=a.WINDOWS_PHONE,q=a.IOS,z=a.WINDOWS,G=a.MAC_OS,H=function(){return I.name===a.WINDOWS&&"10"===I.version&&("string"==typeof E&&-1!==E.indexOf("Edg/"))},$=function(){return w.name===O},K=function(){return y("iPad")},W=_.type===M,Y=_.type===V,Q=_.type===F,J=w.name===P||K(),X=w.name===S,Z=function(){switch(_.type){case x:case L:return!0;default:return!1}}()||K(),ee=_.type===x,te=_.type===L||K(),ne=_.type===U,re=I.name===B,ie=I.name===j,se=I.name===q||K(),oe=w.name===T,ae=w.name===R,ce=w.name===C||w.name===P,ue=w.name===N,le=w.name===k||w.name===A,he=I.version?I.version:"none",de=I.name?I.name:"none",fe=w.major,pe=w.version,me=w.name,ge=_.vendor?_.vendor:"none",ye=_.model?_.model:"none",ve=b.name,we=b.version,_e=E,be=$()||H(),Ie=w.name===D,Ee=_.type,Te=(r=g())&&(/iPad|iPhone|iPod/.test(r.platform)||"MacIntel"===r.platform&&r.maxTouchPoints>1)&&!window.MSStream,Se=K(),Ae=y("iPhone"),ke=y("iPod"),Ne=function(){var e=g(),t=e&&e.userAgent.toLowerCase();return"string"==typeof t&&/electron/.test(t)}(),Re=H(),Ce=$(),Oe=I.name===z,De=I.name===G,Pe=l(_.type);e.exports={deviceDetect:function(){var e=Pe.isBrowser,t=Pe.isMobile,n=Pe.isTablet,r=Pe.isSmartTV,i=Pe.isConsole,s=Pe.isWearable;return e?h(e,w,b,I,E):r?m(r,b,I,E):i?p(i,b,I,E):t||n?d(Pe,_,I,E):s?f(s,b,I,E):void 0},isSmartTV:W,isConsole:Y,isWearable:Q,isMobileSafari:J,isChromium:X,isMobile:Z,isMobileOnly:ee,isTablet:te,isBrowser:ne,isAndroid:re,isWinPhone:ie,isIOS:se,isChrome:oe,isFirefox:ae,isSafari:ce,isOpera:ue,isIE:le,osVersion:he,osName:de,fullBrowserVersion:fe,browserVersion:pe,browserName:me,mobileVendor:ge,mobileModel:ye,engineName:ve,engineVersion:we,getUA:_e,isEdge:be,isYandex:Ie,deviceType:Ee,isIOS13:Te,isIPad13:Se,isIPhone13:Ae,isIPod13:ke,isElectron:Ne,isEdgeChromium:Re,isLegacyEdge:Ce,isWindows:Oe,isMacOs:De}},function(e,t,n){var r;!function(i,s){"use strict";var o="function",a="undefined",c="object",u="model",l="name",h="type",d="vendor",f="version",p="architecture",m="console",g="mobile",y="tablet",v="smarttv",w="wearable",_={extend:function(e,t){var n={};for(var r in e)t[r]&&t[r].length%2==0?n[r]=t[r].concat(e[r]):n[r]=e[r];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:s},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},b={rgx:function(e,t){for(var n,r,i,a,u,l,h=0;h<t.length&&!u;){var d=t[h],f=t[h+1];for(n=r=0;n<d.length&&!u;)if(u=d[n++].exec(e))for(i=0;i<f.length;i++)l=u[++r],typeof(a=f[i])===c&&a.length>0?2==a.length?typeof a[1]==o?this[a[0]]=a[1].call(this,l):this[a[0]]=a[1]:3==a.length?typeof a[1]!==o||a[1].exec&&a[1].test?this[a[0]]=l?l.replace(a[1],a[2]):s:this[a[0]]=l?a[1].call(this,l,a[2]):s:4==a.length&&(this[a[0]]=l?a[3].call(this,l.replace(a[1],a[2])):s):this[a]=l||s;h+=2}},str:function(e,t){for(var n in t)if(typeof t[n]===c&&t[n].length>0){for(var r=0;r<t[n].length;r++)if(_.has(t[n][r],e))return"?"===n?s:n}else if(_.has(t[n],e))return"?"===n?s:n;return e}},I={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},E={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[l,f],[/(opios)[\/\s]+([\w\.]+)/i],[[l,"Opera Mini"],f],[/\s(opr)\/([\w\.]+)/i],[[l,"Opera"],f],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark)\/([\w\.-]+)/i],[l,f],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[l,"IE"],f],[/(edge|edgios|edgea)\/((\d+)?[\w\.]+)/i],[[l,"Edge"],f],[/(yabrowser)\/([\w\.]+)/i],[[l,"Yandex"],f],[/(puffin)\/([\w\.]+)/i],[[l,"Puffin"],f],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[l,"UCBrowser"],f],[/(comodo_dragon)\/([\w\.]+)/i],[[l,/_/g," "],f],[/(micromessenger)\/([\w\.]+)/i],[[l,"WeChat"],f],[/(qqbrowserlite)\/([\w\.]+)/i],[l,f],[/(QQ)\/([\d\.]+)/i],[l,f],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[l,f],[/(BIDUBrowser)[\/\s]?([\w\.]+)/i],[l,f],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[l,f],[/(MetaSr)[\/\s]?([\w\.]+)/i],[l],[/(LBBROWSER)/i],[l],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[f,[l,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[f,[l,"Facebook"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[f,[l,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[l,/(.+)/,"$1 WebView"],f],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[l,/(.+(?:g|us))(.+)/,"$1 $2"],f],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[f,[l,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[l,f],[/(dolfin)\/([\w\.]+)/i],[[l,"Dolphin"],f],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[l,"Chrome"],f],[/(coast)\/([\w\.]+)/i],[[l,"Opera Coast"],f],[/fxios\/([\w\.-]+)/i],[f,[l,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[f,[l,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[f,l],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[l,"GSA"],f],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[l,[f,b.str,I.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[l,f],[/(navigator|netscape)\/([\w\.-]+)/i],[[l,"Netscape"],f],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[l,f]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[p,"amd64"]],[/(ia32(?=;))/i],[[p,_.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[p,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[p,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[p,/ower/,"",_.lowerize]],[/(sun4\w)[;\)]/i],[[p,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+;))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[p,_.lowerize]]],device:[[/\((ipad|playbook);[\w\s\);-]+(rim|apple)/i],[u,d,[h,y]],[/applecoremedia\/[\w\.]+ \((ipad)/],[u,[d,"Apple"],[h,y]],[/(apple\s{0,1}tv)/i],[[u,"Apple TV"],[d,"Apple"]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[d,u,[h,y]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[u,[d,"Amazon"],[h,y]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[u,b.str,I.device.amazon.model],[d,"Amazon"],[h,g]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[u,d,[h,g]],[/\((ip[honed|\s\w*]+);/i],[u,[d,"Apple"],[h,g]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[d,u,[h,g]],[/\(bb10;\s(\w+)/i],[u,[d,"BlackBerry"],[h,g]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone)/i],[u,[d,"Asus"],[h,y]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[d,"Sony"],[u,"Xperia Tablet"],[h,y]],[/android.+\s([c-g]\d{4}|so[-l]\w+)\sbuild\//i],[u,[d,"Sony"],[h,g]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[d,u,[h,m]],[/android.+;\s(shield)\sbuild/i],[u,[d,"Nvidia"],[h,m]],[/(playstation\s[34portablevi]+)/i],[u,[d,"Sony"],[h,m]],[/(sprint\s(\w+))/i],[[d,b.str,I.device.sprint.vendor],[u,b.str,I.device.sprint.model],[h,g]],[/(lenovo)\s?(S(?:5000|6000)+(?:[-][\w+]))/i],[d,u,[h,y]],[/(htc)[;_\s-]+([\w\s]+(?=\))|\w+)*/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|lenovo|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[d,[u,/_/g," "],[h,g]],[/(nexus\s9)/i],[u,[d,"HTC"],[h,y]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p)/i],[u,[d,"Huawei"],[h,g]],[/(microsoft);\s(lumia[\s\w]+)/i],[d,u,[h,g]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[u,[d,"Microsoft"],[h,m]],[/(kin\.[onetw]{3})/i],[[u,/\./g," "],[d,"Microsoft"],[h,g]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[u,[d,"Motorola"],[h,g]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[u,[d,"Motorola"],[h,y]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[d,_.trim],[u,_.trim],[h,v]],[/hbbtv.+maple;(\d+)/i],[[u,/^/,"SmartTV"],[d,"Samsung"],[h,v]],[/\(dtv[\);].+(aquos)/i],[u,[d,"Sharp"],[h,v]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[d,"Samsung"],u,[h,y]],[/smart-tv.+(samsung)/i],[d,[h,v],u],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[d,"Samsung"],u,[h,g]],[/sie-(\w*)/i],[u,[d,"Siemens"],[h,g]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[d,"Nokia"],u,[h,g]],[/android\s3\.[\s\w;-]{10}(a\d{3})/i],[u,[d,"Acer"],[h,y]],[/android.+([vl]k\-?\d{3})\s+build/i],[u,[d,"LG"],[h,y]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[d,"LG"],u,[h,y]],[/(lg) netcast\.tv/i],[d,u,[h,v]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[u,[d,"LG"],[h,g]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[u,[d,"Lenovo"],[h,y]],[/linux;.+((jolla));/i],[d,u,[h,g]],[/((pebble))app\/[\d\.]+\s/i],[d,u,[h,w]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[d,u,[h,g]],[/crkey/i],[[u,"Chromecast"],[d,"Google"]],[/android.+;\s(glass)\s\d/i],[u,[d,"Google"],[h,w]],[/android.+;\s(pixel c)\s/i],[u,[d,"Google"],[h,y]],[/android.+;\s(pixel xl|pixel)\s/i],[u,[d,"Google"],[h,g]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[u,/_/g," "],[d,"Xiaomi"],[h,g]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[u,/_/g," "],[d,"Xiaomi"],[h,y]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[u,[d,"Meizu"],[h,y]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})\s+build/i],[u,[d,"OnePlus"],[h,g]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[u,[d,"RCA"],[h,y]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[u,[d,"Dell"],[h,y]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[u,[d,"Verizon"],[h,y]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[d,"Barnes & Noble"],u,[h,y]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[u,[d,"NuVision"],[h,y]],[/android.+;\s(k88)\sbuild/i],[u,[d,"ZTE"],[h,y]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[u,[d,"Swiss"],[h,g]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[u,[d,"Swiss"],[h,y]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[u,[d,"Zeki"],[h,y]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[d,"Dragon Touch"],u,[h,y]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[u,[d,"Insignia"],[h,y]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[u,[d,"NextBook"],[h,y]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[d,"Voice"],u,[h,g]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[d,"LvTel"],u,[h,g]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[u,[d,"Envizen"],[h,y]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[d,u,[h,y]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[u,[d,"MachSpeed"],[h,y]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[d,u,[h,y]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[u,[d,"Rotor"],[h,y]],[/android.+(KS(.+))\s+build/i],[u,[d,"Amazon"],[h,y]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[d,u,[h,y]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[h,_.lowerize],d,u],[/(android[\w\.\s\-]{0,9});.+build/i],[u,[d,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[f,[l,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[l,f],[/rv\:([\w\.]{1,9}).+(gecko)/i],[f,l]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[l,f],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[l,[f,b.str,I.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[l,"Windows"],[f,b.str,I.os.windows.version]],[/\((bb)(10);/i],[[l,"BlackBerry"],f],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]*)/i,/linux;.+(sailfish);/i],[l,f],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[l,"Symbian"],f],[/\((series40);/i],[l],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[l,"Firefox OS"],f],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[l,f],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[l,"Chromium OS"],f],[/(sunos)\s?([\w\.\d]*)/i],[[l,"Solaris"],f],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[l,f],[/(haiku)\s(\w+)/i],[l,f],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[f,/_/g,"."],[l,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[l,"Mac OS"],[f,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]*)/i],[l,f]]},T=function(e,t){if("object"==typeof e&&(t=e,e=s),!(this instanceof T))return new T(e,t).getResult();var n=e||(i&&i.navigator&&i.navigator.userAgent?i.navigator.userAgent:""),r=t?_.extend(E,t):E;return this.getBrowser=function(){var e={name:s,version:s};return b.rgx.call(e,n,r.browser),e.major=_.major(e.version),e},this.getCPU=function(){var e={architecture:s};return b.rgx.call(e,n,r.cpu),e},this.getDevice=function(){var e={vendor:s,model:s,type:s};return b.rgx.call(e,n,r.device),e},this.getEngine=function(){var e={name:s,version:s};return b.rgx.call(e,n,r.engine),e},this.getOS=function(){var e={name:s,version:s};return b.rgx.call(e,n,r.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this};T.VERSION="0.7.18",T.BROWSER={NAME:l,MAJOR:"major",VERSION:f},T.CPU={ARCHITECTURE:p},T.DEVICE={MODEL:u,VENDOR:d,TYPE:h,CONSOLE:m,MOBILE:g,SMARTTV:v,TABLET:y,WEARABLE:w,EMBEDDED:"embedded"},T.ENGINE={NAME:l,VERSION:f},T.OS={NAME:l,VERSION:f},typeof t!==a?(typeof e!==a&&e.exports&&(t=e.exports=T),t.UAParser=T):n(3)?(r=function(){return T}.call(t,n,t,e))===s||(e.exports=r):i&&(i.UAParser=T);var S=i&&(i.jQuery||i.Zepto);if(typeof S!==a){var A=new T;S.ua=A.getResult(),S.ua.get=function(){return A.getUA()},S.ua.set=function(e){A.setUA(e);var t=A.getResult();for(var n in t)S.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t){(function(t){e.exports=t}).call(t,{})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=n(0),s=i.DEVICE_TYPES,o=i.defaultData,a=t.getNavigatorInstance=function(){return!("undefined"==typeof window||!window.navigator&&!navigator)&&(window.navigator||navigator)},c=t.isIOS13Check=function(e){var t=a();return t&&t.platform&&(-1!==t.platform.indexOf(e)||"MacIntel"===t.platform&&t.maxTouchPoints>1&&!window.MSStream)};e.exports={checkType:function(e){switch(e){case s.MOBILE:return{isMobile:!0};case s.TABLET:return{isTablet:!0};case s.SMART_TV:return{isSmartTV:!0};case s.CONSOLE:return{isConsole:!0};case s.WEARABLE:return{isWearable:!0};case s.BROWSER:return{isBrowser:!0};default:return o}},broPayload:function(e,t,n,r,i){return{isBrowser:e,browserMajorVersion:t.major,browserFullVersion:t.version,browserName:t.name,engineName:n.name||!1,engineVersion:n.version,osName:r.name,osVersion:r.version,userAgent:i}},mobilePayload:function(e,t,n,i){return r({},e,{vendor:t.vendor,model:t.model,os:n.name,osVersion:n.version,ua:i})},stvPayload:function(e,t,n,r){return{isSmartTV:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},consolePayload:function(e,t,n,r){return{isConsole:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},wearPayload:function(e,t,n,r){return{isWearable:e,engineName:t.name,engineVersion:t.version,osName:n.name,osVersion:n.version,userAgent:r}},getNavigatorInstance:a,isIOS13Check:c}}])},5857:(e,t,n)=>{"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e){return"Minified Redux error #"+e+"; visit https://redux.js.org/Errors?code="+e+" for the full message or use the non-minified dev environment for full errors. "}n.r(t),n.d(t,{__DO_NOT_USE__ActionTypes:()=>u,applyMiddleware:()=>g,bindActionCreators:()=>p,combineReducers:()=>d,compose:()=>m,createStore:()=>h});var a="function"==typeof Symbol&&Symbol.observable||"@@observable",c=function(){return Math.random().toString(36).substring(7).split("").join(".")},u={INIT:"@@redux/INIT"+c(),REPLACE:"@@redux/REPLACE"+c(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+c()}};function l(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function h(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error(o(0));if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error(o(1));return n(h)(e,t)}if("function"!=typeof e)throw new Error(o(2));var i=e,s=t,c=[],d=c,f=!1;function p(){d===c&&(d=c.slice())}function m(){if(f)throw new Error(o(3));return s}function g(e){if("function"!=typeof e)throw new Error(o(4));if(f)throw new Error(o(5));var t=!0;return p(),d.push(e),function(){if(t){if(f)throw new Error(o(6));t=!1,p();var n=d.indexOf(e);d.splice(n,1),c=null}}}function y(e){if(!l(e))throw new Error(o(7));if(void 0===e.type)throw new Error(o(8));if(f)throw new Error(o(9));try{f=!0,s=i(s,e)}finally{f=!1}for(var t=c=d,n=0;n<t.length;n++){(0,t[n])()}return e}function v(e){if("function"!=typeof e)throw new Error(o(10));i=e,y({type:u.REPLACE})}function w(){var e,t=g;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new Error(o(11));function n(){e.next&&e.next(m())}return n(),{unsubscribe:t(n)}}})[a]=function(){return this},e}return y({type:u.INIT}),(r={dispatch:y,subscribe:g,getState:m,replaceReducer:v})[a]=w,r}function d(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];0,"function"==typeof e[i]&&(n[i]=e[i])}var s,a=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if(void 0===n(void 0,{type:u.INIT}))throw new Error(o(12));if(void 0===n(void 0,{type:u.PROBE_UNKNOWN_ACTION()}))throw new Error(o(13))}))}(n)}catch(e){s=e}return function(e,t){if(void 0===e&&(e={}),s)throw s;for(var r=!1,i={},c=0;c<a.length;c++){var u=a[c],l=n[u],h=e[u],d=l(h,t);if(void 0===d){t&&t.type;throw new Error(o(14))}i[u]=d,r=r||d!==h}return(r=r||a.length!==Object.keys(e).length)?i:e}}function f(e,t){return function(){return t(e.apply(this,arguments))}}function p(e,t){if("function"==typeof e)return f(e,t);if("object"!=typeof e||null===e)throw new Error(o(16));var n={};for(var r in e){var i=e[r];"function"==typeof i&&(n[r]=f(i,t))}return n}function m(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function g(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error(o(15))},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},a=t.map((function(e){return e(i)}));return r=m.apply(void 0,a)(n.dispatch),s(s({},n),{},{dispatch:r})}}}},6042:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.searchMovies=t.createElement=void 0;const s=i(n(9669)),o=n(2740);t.createElement=function(e,t){const n=document.createElement(e);return n.className=t,n},t.searchMovies=function(e,t){return r(this,void 0,void 0,(function*(){return(yield(0,s.default)(o.BASE_URL+"/exp/"+e+"/"+(t||""))).data}))}},4756:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.facebookSignIn=t.googleSignIn=t.signInEmailPassword=t.registerEmailPassword=t.getFirestoreData=t.getStorageItem=void 0;const r=n(3404),i=n(7103),s=n(1369);t.getStorageItem=function(e){const t=(0,r.ref)(i.storage,e);return(0,r.getDownloadURL)(t)},t.getFirestoreData=function(e){const t=i.db.collection(e);return new Promise((e=>{t.onSnapshot((t=>{const n=[];t.forEach((e=>{const t=e.data();n.push(t)})),e(n)}))}))},t.registerEmailPassword=function(e,t){return(0,s.createUserWithEmailAndPassword)(i.auth,e,t).then((e=>e.user))},t.signInEmailPassword=function(e,t){return(0,s.signInWithEmailAndPassword)(i.auth,e,t).then((e=>e.user))},t.googleSignIn=function(){return(0,s.signInWithPopup)(i.auth,i.GoogleProvider)},t.facebookSignIn=function(){return(0,s.signInWithPopup)(i.auth,i.FacebookProvider)}},7103:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.db=t.FacebookProvider=t.GoogleProvider=t.auth=t.storage=void 0;const i=r(n(1902));n(7741),n(3887),n(4507),n(9477);const s=i.default.initializeApp({apiKey:"AIzaSyDh02xdVEfBeqmH33tJb400jZILLmmHL0g",authDomain:"prototype-ae9eb.firebaseapp.com",databaseURL:"https://prototype-ae9eb-default-rtdb.europe-west1.firebasedatabase.app",projectId:"prototype-ae9eb",storageBucket:"prototype-ae9eb.appspot.com",messagingSenderId:"122319683458",appId:"1:122319683458:web:3095d5e0f2f7051075d99b",measurementId:"G-RE1ETFTFQE"});t.storage=i.default.storage(s),t.auth=i.default.auth(),t.GoogleProvider=new i.default.auth.GoogleAuthProvider,t.FacebookProvider=new i.default.auth.FacebookAuthProvider,t.db=i.default.firestore()},413:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(7102)),s=r(n(5422)),o=r(n(8018)),a=r(n(1742)),c=n(6042),u=n(4090),l=r(n(1372));t.default=class{constructor(e,t){this.root=e,this.tag=t,this.render()}renderMembersBar(e){new s.default(e)}renderLogo(e){new i.default(e)}renderThemeSwitch(e){new a.default(e)}renderSearch(e){this.tag===u.GLOBAL&&new l.default(e)}render(){const e=(0,c.createElement)("div",o.default["header_home-wrapper"]);this.renderLogo(e),this.renderSearch(e),this.renderMembersBar(e),this.renderThemeSwitch(e),this.root.append(e)}}},4090:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GLOBAL=t.HOME=void 0,t.HOME="home",t.GLOBAL="global"},2585:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(7529),s=n(6042),o=r(n(6119));t.default=class{constructor(e){this.root=e,this.render()}renderLoginForm(e){new o.default(e)}render(){const e=(0,s.createElement)("div","login-page-wrapper");this.renderLoginForm(e),(0,i.stylePage)(e),e.style.zIndex="5",e.style.display="flex",e.style.alignItems="center",e.style.justifyContent="center",this.root.append(e)}}},7529:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setThisMemberStatus=t.closeLoginPage=t.stylePage=void 0;const r=n(8739),i=n(625);t.stylePage=function(e){e.style.width="100vw",e.style.height="100vh",e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.backgroundColor="white"},t.closeLoginPage=function(){document.querySelector(".login-page-wrapper").remove()},t.setThisMemberStatus=function(e,t){r.store.dispatch((0,i.setMemberStatus)({loggedIn:e,email:t}))}},775:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6042),s=n(4756),o=n(7529),a=r(n(7331)),c=n(5942);t.default=class{constructor(e){this.root=e,this.render()}renderInputs(e){return c.Login_Form_Inputs.map((t=>{const n=(0,i.createElement)("input","login-form_input");n.type=t.type,n.name=t.name,n.placeholder=t.placeholder,e.append(n)}))}renderButton(){const e=(0,i.createElement)("button",a.default["login-form_btn"]);return e.textContent="Log In",e.type="button",e}handleSubmit(e,t){e.addEventListener("click",(()=>{const e=new FormData(t),n=e.get("email"),r=e.get("password");(0,s.signInEmailPassword)(n,r).then((e=>{console.log(e),(0,o.closeLoginPage)()})).catch((e=>console.log(e)))}))}render(){const e=(0,i.createElement)("form",a.default["login-form-wrapper"]),t=this.renderButton();this.renderInputs(e),this.handleSubmit(t,e),e.append(t),this.root.append(e)}}},5942:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Login_Form_Inputs=void 0,t.Login_Form_Inputs=[{type:"email",name:"email",placeholder:"Email"},{type:"password",name:"password",placeholder:"Password"}]},6119:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(1910)),s=r(n(1561));t.default=class{constructor(e){this.root=e,this.render()}renderModeController(e){new i.default(e)}renderSocialAuth(e){new s.default(e)}render(){const e=document.createElement("div");e.className="login-from-wrapper",this.renderModeController(e),this.renderSocialAuth(e),this.root.append(e)}}},2994:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6042),s=n(4756),o=n(7529),a=r(n(6462)),c=n(8994);t.default=class{constructor(e){this.root=e,this.render()}renderInputs(e){return c.Signup_Form_Inputs.map((t=>{const n=(0,i.createElement)("input","signup-form_input");n.type=t.type,n.name=t.name,n.placeholder=t.placeholder,e.append(n)}))}renderButton(){const e=(0,i.createElement)("button",a.default["signup-form_btn"]);return e.textContent="Sign Up",e.type="button",e}handleSubmit(e,t){e.addEventListener("click",(()=>{const e=new FormData(t),n=e.get("email"),r=e.get("password");(0,s.registerEmailPassword)(n,r).then((e=>{(0,o.closeLoginPage)()})).catch((e=>console.log(e)))}))}render(){const e=(0,i.createElement)("form",a.default["signup-form-wrapper"]),t=this.renderButton();this.handleSubmit(t,e),this.renderInputs(e),e.append(t),this.root.append(e)}}},8994:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Signup_Form_Inputs=void 0,t.Signup_Form_Inputs=[{type:"email",name:"email",placeholder:"Email"},{type:"password",name:"password",placeholder:"Password"}]},1561:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6042),s=r(n(3643)),o=n(4382),a=r(n(5914));t.default=class{constructor(e){this.root=e,this.render()}renderGooleButton(e){o.Social_Buttons_List.forEach((t=>{new s.default(e,t)}))}render(){const e=(0,i.createElement)("div",a.default["social-auth-wrapper"]);this.renderGooleButton(e),this.root.append(e)}}},3643:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6042),s=n(7529),o=r(n(2269));t.default=class{constructor(e,t){this.root=e,this.data=t,this.render()}renderButton(e){const t=(0,i.createElement)("button",o.default["social-button"]);t.type="button",t.textContent=this.data.textContent,t.style.backgroundColor=this.data.backgroundColor,t.style.color=this.data.color,t.addEventListener("click",(()=>{this.data.callback().then((e=>{(0,s.closeLoginPage)(),(0,s.setThisMemberStatus)(!0,e.user.email)}))})),e.append(t)}render(){const e=(0,i.createElement)("div",o.default["social-button-wrapper"]);this.renderButton(e),this.root.append(e)}}},4382:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Social_Buttons_List=void 0;const r=n(4756);t.Social_Buttons_List=[{id:"googleButton",className:"google-button",textContent:"Join with Google",color:"white",backgroundColor:"orange",callback:r.googleSignIn},{id:"fbButton",className:"facebook-button",textContent:"Join with Facebook",color:"white",backgroundColor:"blue",callback:r.facebookSignIn}]},1910:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6042),s=r(n(775)),o=r(n(2994)),a=r(n(9572));let c="signup";t.default=class{constructor(e){this.root=e,this.render()}setContext(e){const t=(0,i.createElement)("h3",""),n=(0,i.createElement)("div","controller-forms");this.handleModes(t,e,n),e.append(t,n)}renderLoginMode(e,t,n){e.textContent="Click here to Sign Up",e.className=a.default["mode-controller_login"],e.addEventListener("click",(()=>{c="signup",this.handleModes(e,t,n),this.renderForms}))}renderSignUpMode(e,t,n){e.textContent="Click here to Log In",e.className=a.default["mode-controller_signup"],e.addEventListener("click",(()=>{c="login",this.handleModes(e,t,n)}))}handleModes(e,t,n){"login"===c?this.renderLoginMode(e,t,n):this.renderSignUpMode(e,t,n),this.renderForms(n)}renderForms(e){"login"===c?(e.innerHTML="",new s.default(e)):(e.innerHTML="",new o.default(e))}render(){const e=(0,i.createElement)("div",a.default["mode-controller-wrapper"]);this.setContext(e),this.root.append(e)}}},7102:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const i=n(4756);n(8931);const s=n(8739),o=n(625),a=n(5088);t.default=class{constructor(e){this.root=e,this.render()}getLogo(){let e="";return e=a.isMobile?"ATFImages/netflix-short.png":"ATFImages/netflix.png",(0,i.getStorageItem)(e)}renderLogo(){return r(this,void 0,void 0,(function*(){const e=yield this.getLogo();s.store.dispatch((0,o.setLogoType)(e))}))}manageLogo(e){s.store.subscribe((()=>{e.src=s.store.getState().logo}))}render(){const e=document.createElement("img");e.className="header_logo",this.manageLogo(e),this.renderLogo(),this.root.append(e)}}},9944:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MEMBERS_BAR_BUTTONS=void 0,t.MEMBERS_BAR_BUTTONS=[{defaultLabel:"Sign Up",toggleLabel:"Log Out",class:"member-btn sign-up-btn",id:"login"},{defaultLabel:"Subscribe",toggleLabel:"",class:"member-btn subscribe-btn",id:"subscribe"}]},5422:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(8739),s=n(9944),o=r(n(7292)),a=n(2867);t.default=class{constructor(e){this.root=e,this.render()}renderButtons(e){s.MEMBERS_BAR_BUTTONS.forEach((t=>{const n=document.createElement("button");n.className=o.default["member-btn"],n.textContent=t.defaultLabel;const r=i.store.getState().theme;(0,a.changeButtonsStyle)(r,n,t.id),this.manageButtonStyle(n,t.id),n.addEventListener("click",(()=>{console.log("click!",t.id),(0,a.manageBtnClick)(t.id,document.querySelector("main"))})),e.append(n)}))}manageButtonStyle(e,t){i.store.subscribe((()=>{const n=i.store.getState().theme;(0,a.changeButtonsStyle)(n,e,t);const r=i.store.getState().member;(0,a.changeButtonsLabels)(e,r.loggedIn,r.email,t)}))}render(){const e=document.createElement("div");e.className=o.default["members-bar-wrapper"],this.renderButtons(e),this.root.append(e)}}},2867:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.manageBtnClick=t.changeButtonsLabels=t.changeButtonsStyle=void 0;const i=r(n(2585)),s={login:{dark:{color:"red",bgColor:"white"},light:{color:"white",bgColor:"red"}},subscribe:{dark:{color:"white",bgColor:"red"},light:{color:"red",bgColor:"white"}}};t.changeButtonsStyle=function(e,t,n){"dark"!=e&&"light"!=e||"login"!=n&&"subscribe"!=n||(t.style.color=s[n][e].color,t.style.backgroundColor=s[n][e].bgColor)},t.changeButtonsLabels=function(e,t,n,r){"login"==r&&(e.textContent=t?"Welcome, "+n.split("@")[0]:"Sign Up")},t.manageBtnClick=function(e,t){switch(e){case"login":new i.default(t);break;case"subscribe":console.log("subscribe!")}}},1372:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=i(n(2296)),o=n(6042),a=n(6042),c=i(n(1222)),u=n(8739),l=n(625);t.default=class{constructor(e){this.root=e,this.render()}setValue(e,t){e.addEventListener("input",(n=>{const r=e.value;r?this.renderMoviesList(t,r):u.store.dispatch((0,l.setSearchData)([]))}))}renderMoviesList(e,t){return r(this,void 0,void 0,(function*(){const e=yield(0,a.searchMovies)("search/"+t,null);u.store.dispatch((0,l.setSearchData)(e.results))}))}render(){const e=(0,o.createElement)("div",s.default["search-bar-wrapper"]),t=(0,o.createElement)("input",s.default.search_input);new c.default(e),this.setValue(t,e),e.append(t),this.root.append(e)}}},4604:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(6411)),s=n(6042),o=n(2740);t.default=class{constructor(e,t){this.root=e,this.data=t,this.render()}renderData(){const e=(0,s.createElement)("div",i.default["search-result-item-wrapper"]);this.data.poster_path&&(e.style.background=`url(${o.POSTER_BASE+this.data.poster_path})`),e.style.backgroundSize="cover",e.style.backgroundPositionY="25%";const t=(0,s.createElement)("h3",i.default.title);return t.textContent=this.data.title.slice(0,15)+"...",e.append(t),e}render(){const e=this.renderData();this.root.append(e)}}},1222:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(1281)),s=n(6042),o=r(n(4604)),a=n(8739);t.default=class{constructor(e){this.root=e,this.render()}renderData(e){a.store.subscribe((()=>{const t=a.store.getState().search;for(;e.lastChild;)e.lastChild.remove();t.length>0&&t.forEach((t=>new o.default(e,t)))}))}render(){const e=(0,s.createElement)("div",i.default["search-results-wrapper"]);this.renderData(e),this.root.append(e)}}},1742:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(3092)),s=n(8739),o=n(625),a=n(9068),c=document.querySelector("body");t.default=class{constructor(e){this.root=e,this.render()}renderSwitch(e){const t=document.createElement("div");t.className=i.default["theme-switch-element"];const n=document.createElement("span");n.className=i.default.span,this.renderTheme(n),t.addEventListener("click",(()=>{this.changeTheme()})),t.append(n),e.append(t)}renderTheme(e){s.store.subscribe((()=>{const t=s.store.getState().theme;(0,a.changeStyle)(t,c,e)}))}changeTheme(){const e="dark"===s.store.getState().theme?"light":"dark";s.store.dispatch((0,o.setTheme)(e))}render(){const e=document.createElement("div");e.className=i.default["theme-switch-container"];const t=document.createElement("div");t.className=i.default["theme-switch-wrapper"],this.renderSwitch(t),e.append(t),this.root.append(e),this.changeTheme()}}},9068:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changeStyle=void 0;const n={color:"black",backgroundColor:"#e6e2dc",spanColor:"#41354d",right:"2px",left:"auto"},r={color:"white",backgroundColor:"black",spanColor:"white",right:"auto",left:"2px"};t.changeStyle=function(e,t,i){let s=n;switch(e){case"dark":s=r;break;case"light":s=n}t.style.backgroundColor=s.backgroundColor,t.style.color=s.color,i.style.right=s.right,i.style.left=s.left,i.style.backgroundColor=s.spanColor}},5101:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(9917)),s=n(6042),o=r(n(640)),a=r(n(6544)),c=n(6245);t.default=class{constructor(e,t,n){this.root=e,this.data=t,this.title=n,this.render()}renderNavigation(e,t){new a.default(e,this.title,t)}renderContent(){const e=(0,s.createElement)("div",i.default.container);return this.data.forEach((t=>new o.default(e,t))),(0,c.transformList)(e,this.title),e}render(){const e=(0,s.createElement)("div",i.default["default-list-wrapper"]),t=(0,s.createElement)("h3",i.default.title);t.textContent=this.title.replace(/[_-]/," ").toUpperCase();const n=this.renderContent();this.renderNavigation(e,n),e.append(t,n),this.root.append(e)}}},6245:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformList=void 0;const r=n(8739);t.transformList=function(e,t){r.store.subscribe((()=>{const n=r.store.getState().listTransform;n.title==t&&function(e,t){e.style.transform=`translateX(${t}px)`}(e,n.value)}))}},640:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=r(n(735)),s=n(6042),o=n(2740);t.default=class{constructor(e,t){this.root=e,this.data=t,this.render()}renderContent(e){(0,s.createElement)("h3",i.default.title)}render(){const e=(0,s.createElement)("div",i.default["default-list-item-wrapper"]);e.style.background=`url(${o.POSTER_BASE+this.data.poster_path})`,e.style.backgroundSize="cover",e.style.backgroundPositionY="15%",this.renderContent(e),this.root.append(e)}}},6544:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6042),s=r(n(4890)),o=n(7895);t.default=class{constructor(e,t,n){this.root=e,this.title=t,this.list=n,this.render()}renderContent(e){[{name:"back",code:"&lang;",operator:"add"},{name:"forth",code:"&rang;",operator:"remove"}].forEach((t=>{const n=(0,i.createElement)("button",s.default["nav-button-"+t.name]);n.innerHTML=t.code,n.addEventListener("click",(()=>(0,o.handleClick)(t.operator,this.title))),e.append(n),(0,o.handleButtonRender)(this.title,n,this.list)}))}render(){this.renderContent(this.root)}}},7895:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.handleButtonRender=t.handleClick=t.limit=void 0;const i=n(625),s=n(8739),o=r(n(4890));t.limit=200,t.handleClick=function(e,n){if(e){const r=s.store.getState().listTransform;switch(e){case"add":s.store.dispatch((0,i.setListTranslateValue)({title:n,value:r.value+t.limit}));break;case"remove":s.store.dispatch((0,i.setListTranslateValue)({title:n,value:r.value-t.limit}))}}},t.handleButtonRender=function(e,t,n){s.store.subscribe((()=>{const r=s.store.getState().listTransform,i=n.lastElementChild.getBoundingClientRect(),a=n.offsetWidth;console.log(r.title,e),r.title===e?0==r.value?t.classList.contains(o.default["nav-button-back"])&&(t.style.display="none"):i.right<a&&t.classList.contains(o.default["nav-button-forth"])&&(t.style.display="none"):r.title===e&&(t.style.display="block")}))}},5711:function(e,t,n){"use strict";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const s=n(6042),o=n(8739),a=n(6042),c=i(n(236)),u=i(n(5101));t.default=class{constructor(e){this.root=e,this.render()}renderLists(e){["upcoming","top-rated"].forEach((t=>r(this,void 0,void 0,(function*(){const n=(yield(0,a.searchMovies)(t,1)).results;new u.default(e,n,t)}))))}renderContent(e){const t=(0,s.createElement)("h2",c.default.title);t.textContent="NETFLIX choice",e.append(t),this.renderLists(e)}render(){const e=(0,s.createElement)("div",c.default["movies-default-wrapper"]);this.renderContent(e),o.store.subscribe((()=>{"default"===o.store.getState().moviesPage?this.root.append(e):e.remove()}))}}},9434:function(e,t,n){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});const i=n(6042),s=r(n(413)),o=n(4090);n(3808);const a=r(n(5711));class c{constructor(e){this.root=e,this.render()}renderHeader(e){new s.default(e,o.GLOBAL)}renderContent(e){new a.default(e)}render(){const e=(0,i.createElement)("div","movies-page-wrapper");this.renderHeader(e),this.renderContent(e),this.root.append(e)}}t.default=c;new c(document.getElementById("root"))},625:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setListTranslateValue=t.setMoviesPageState=t.setSearchData=t.setMemberStatus=t.setTheme=t.setLogoType=void 0;const r=n(5728);t.setLogoType=function(e){return{type:r.RENDER_LOGO,value:e}},t.setTheme=function(e){return{type:r.RENDER_THEME,value:e}},t.setMemberStatus=function(e){return{type:r.SET_MEMBER_STATUS,value:e}},t.setSearchData=function(e){return{type:r.SET_SEARCH_DATA,value:e}},t.setMoviesPageState=function(e){return{type:r.SET_MOVIES_PAGE_CONTENT,value:e}},t.setListTranslateValue=function(e){return{type:r.SET_LIST_TRANSFORM,value:e}}},8739:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.store=t.RootReducer=void 0;const r=n(5857),i=n(1799);t.RootReducer=(0,r.combineReducers)({logo:i.LogoReducer,theme:i.ThemeReducer,member:i.MemberReducer,search:i.SearchDataReducer,moviesPage:i.MoviesPageDataReducer,listTransform:i.ListTranslateReducer}),t.store=(0,r.createStore)(t.RootReducer)},1799:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ListTranslateReducer=t.MoviesPageDataReducer=t.SearchDataReducer=t.MemberReducer=t.ThemeReducer=t.LogoReducer=void 0;const r=n(5728);t.LogoReducer=function(e="",t){return t.type===r.RENDER_LOGO?e=t.value:e},t.ThemeReducer=function(e="light",t){return t.type===r.RENDER_THEME?e=t.value:e},t.MemberReducer=function(e={loggedIn:!1,email:null},t){return t.type===r.SET_MEMBER_STATUS?e=t.value:e},t.SearchDataReducer=function(e=[],t){return t.type===r.SET_SEARCH_DATA?e=t.value:e},t.MoviesPageDataReducer=function(e="default",t){return t.type===r.SET_MOVIES_PAGE_CONTENT?e=t.value:e},t.ListTranslateReducer=function(e={title:"",value:0},t){return t.type===r.SET_LIST_TRANSFORM?e=t.value:e}},5728:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SET_LIST_TRANSFORM=t.SET_MOVIES_PAGE_CONTENT=t.SET_SEARCH_DATA=t.SET_MEMBER_STATUS=t.RENDER_THEME=t.RENDER_LOGO=void 0,t.RENDER_LOGO="RENDER_LOGO",t.RENDER_THEME="RENDER_THEME",t.SET_MEMBER_STATUS="SET_MEMBER_STATUS",t.SET_SEARCH_DATA="SET_SEARCH_DATA",t.SET_MOVIES_PAGE_CONTENT="SET_MOVIES_PAGE_CONTENT",t.SET_LIST_TRANSFORM="SET_LIST_TRANSFORM"},2740:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HOME_PAGE_URL=t.MOVIES_PAGE_URL=t.POSTER_BASE=t.BASE_URL=t.API_KEY=void 0,t.API_KEY="29ab4f75bb2db1deeb32771398e6c025",t.BASE_URL="http://localhost:3000",t.POSTER_BASE="https://image.tmdb.org/t/p/original/",t.MOVIES_PAGE_URL="/movies",t.HOME_PAGE_URL="/"},655:(e,t,n)=>{"use strict";n.d(t,{_T:()=>r,mG:()=>i,Jh:()=>s,XA:()=>o,CR:()=>a,ev:()=>c});function r(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}function i(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{c(r.next(e))}catch(e){s(e)}}function a(e){try{c(r.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=o.trys,(i=i.length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(e){s=[6,e],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}Object.create;function o(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function a(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,s=n.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(r=s.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=s.return)&&n.call(s)}finally{if(i)throw i.error}}return o}function c(e,t,n){if(n||2===arguments.length)for(var r,i=0,s=t.length;i<s;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};n(9434)})();